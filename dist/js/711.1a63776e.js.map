{"version":3,"file":"js/711.1a63776e.js","mappings":"s8CAiGE,MAAMA,GAAQC,EAAAA,EAAAA,MACRC,EAAKF,EAAMG,MAAMC,GAEjBA,GAAKC,EAAAA,EAAAA,IAAeH,GACpBI,GAASC,EAAAA,EAAAA,MACTC,GAAQC,EAAAA,EAAAA,IAAI,IACZC,GAASD,EAAAA,EAAAA,IAAI,CAAC,GACdE,GAASF,EAAAA,EAAAA,IAAI,IAEbG,GAAaH,EAAAA,EAAAA,IAAI,CACrBI,KAAM,GACNC,QAAQ,EACRC,gBAAgB,EAChBC,SAAU,KAINC,GAAeR,EAAAA,EAAAA,IAAI,CACvBK,QAAQ,EACRI,IAAK,GACLF,SAAU,GACVG,KAAM,KAIFC,GAAgBC,EAAAA,EAAAA,KAAS,IACtBb,EAAMc,MAAMC,QAAQC,IACzB,GAAIA,EAAEC,SAAW,EAAK,OAAOD,EAAEX,KAAKa,cAAcC,SAAShB,EAAOW,MAAMI,cAAgB,MAKtFE,EAAaC,IACjBZ,EAAaK,MAAM,QAAU,QAAQO,EAAK,eAAeA,EAAK,kBAAkBA,EAAK,SACjFA,EAAKb,SAASc,OAAS,GACzBb,EAAaK,MAAM,WAAY,EAC/BL,EAAaK,MAAM,OAASO,EAAKX,IACjCd,EAAG2B,KAAK,sBAAuB,CAAEC,OAAQH,EAAKX,IAAKF,SAAUC,EAAaK,MAAMN,YAEhFV,EAAO2B,KAAKhB,EAAaK,MAAMH,KAAO,aACxC,EAGFf,EAAG8B,GAAG,yBAAyB,KAC7B5B,EAAO2B,KAAKhB,EAAaK,MAAMH,KAAO,aAAaF,EAAaK,MAAMN,WAAW,IAGnFZ,EAAG8B,GAAG,2BAA2B,EAAGF,aAClCG,QAAQC,IAAI,oDAAqDJ,EAAO,IAG1E,MAAMK,EAAqBA,KAEzB3B,EAAOY,MAAQ,CAAC,EAChB,MAAMT,EAAOD,EAAWU,MAAM,QAAQgB,OACjCzB,GAASA,EAAKiB,QAERjB,EAAKiB,OAAS,GAAKjB,EAAKiB,OAAS,MAC1CpB,EAAOY,MAAM,QAAU,8DAFvBZ,EAAOY,MAAM,QAAU,yCAIzB,MAAMN,EAAWJ,EAAWU,MAAM,YAAYgB,OAC1C1B,EAAWU,MAAM,oBACdN,GAAaA,EAASc,QAEhBd,EAASc,OAAS,GAAKd,EAASc,OAAS,MAClDpB,EAAOY,MAAM,YAAc,4DAF3BZ,EAAOY,MAAM,YAAc,wCAK3BiB,OAAOC,KAAK9B,EAAOY,OAAOQ,OAAS,GAGvCxB,EAAO2B,KAAK,CACVQ,KAAM,eACNC,MAAO,CAAE7B,KAAMA,EAAMG,SAAUA,IAC/B,EAIE2B,EAAWA,EAAGnC,MAAOoC,MACzBT,QAAQC,IAAI,aAAcQ,GAC1B,IAAK,MAAMf,KAAQe,EACjBpC,EAAMc,MAAMW,KAAKW,EAAUf,GAC7B,EAIIgB,EAAcA,EAAG3B,MAAKL,OAAMY,WAAUT,eAC1CR,EAAMc,MAAMW,KAAK,CAAEf,MAAKL,OAAMY,WAAUT,YAAW,EAG/C8B,GAAaA,EAAG5B,MAAKL,OAAMY,eAC/BU,QAAQC,IAAI,WAAYlB,EAAKL,EAAMY,GACnC,MAAMsB,EAAOvC,EAAMc,MAAM0B,MAAMxB,GAAMA,EAAEN,MAAQA,IAC3C6B,IACFA,EAAK,YAActB,EACfsB,EAAKtB,UAAY,IACnBjB,EAAMc,MAAQd,EAAMc,MAAMC,QAAQM,GAASA,EAAKX,MAAQ6B,EAAK7B,OAEjE,E,OAGFd,EAAG8B,GAAG,WAAYS,GAClBvC,EAAG8B,GAAG,cAAeW,GACrBzC,EAAG8B,GAAG,aAAcY,I,+/FCnMtB,MAAMG,EAAc,EAEpB,O","sources":["webpack://vue-chat-v2/./src/views/HomeView.vue","webpack://vue-chat-v2/./src/views/HomeView.vue?1da1"],"sourcesContent":["<template>\r\n<!-- <a href=\"#\" @click=\"goToRouteCreateRoom\" style=\"display: block;\">da</a> -->\r\n  <div class=\"home\"> \r\n    <div class=\"container\">\r\n\r\n      <div class=\"home__buttons\">\r\n          <button class=\"btn\" v-if=\"createRoom['active']\" @click.prevent=\"createRoom['active'] = false\">Все комнаты</button>\r\n          <button class=\"btn\" v-else @click=\"createRoom['active'] = true\">Создать комнату</button>\r\n      </div>\r\n      \r\n      <div class=\"home__inner\">\r\n\r\n        <!-- <Teleport to=\".header__teleport\"> -->\r\n        <!-- </Teleport> -->\r\n        \r\n        <div class=\"home__create-room\" v-if=\"createRoom['active']\">\r\n          <div class=\"home__create-room__inner\">\r\n            <h1 class=\"title home__title\"><span class=\"span--green\">Создание</span> комнаты</h1>\r\n\r\n            <div class=\"box\">\r\n              <label class=\"label\" for=\"name\">Название комнаты *</label>\r\n              <input type=\"text\" @keyup.enter=\"goToRouteCreateRoom\" id=\"name\" v-model=\"createRoom['name']\" class=\"input--text\" placeholder=\"Введите название комнаты\">\r\n            </div>\r\n            <label for=\"name\" class=\"error\" v-if=\"errors['name']\">{{ errors['name'] }}</label>\r\n            \r\n            <div>\r\n              <button v-if=\"!createRoom['passwordActive']\" class=\"btn\" @click=\"createRoom['passwordActive'] = true\">Поставить пароль</button>\r\n              <button v-else class=\"btn\" @click=\"createRoom['passwordActive'] = false\">Без пароля</button>\r\n            </div>\r\n            \r\n            <template v-if=\"createRoom['passwordActive']\">\r\n              <div class=\"box\">\r\n                <label class=\"label\" for=\"password\">Введите пароль*</label>\r\n                <input id=\"password\" type=\"text\" v-model=\"createRoom['password']\" class=\"input--text\" placeholder=\"Введите пароль\">\r\n              </div>\r\n              <label for=\"password\" class=\"error\" v-if=\"errors['password']\">{{ errors['password'] }}</label>\r\n            </template>\r\n\r\n            <button class=\"btn\" @click.prevent=\"goToRouteCreateRoom\">Создать комнату</button>\r\n          </div>\r\n\r\n        </div>\r\n        \r\n        <div class=\"home__info\" v-else>\r\n          <h1 class=\"title home__title\" v-if=\"!rooms.length\"><span class=\"span--green\">Все</span> комнаты пусты</h1>\r\n          <h1 class=\"title home__title\" v-else><span class=\"span--green\">Все</span> комнаты</h1>\r\n          <div class=\"box\" v-if=\"rooms.length\">\r\n            <label class=\"label\" for=\"search\">Поиск: </label>\r\n            <input type=\"text\" id=\"search\" class=\"input--text home__search\" placeholder=\"Поиск...\" v-model=\"search\">\r\n          </div>\r\n          <ul class=\"home__list\">\r\n            <li class=\"home__list-item\" v-for=\"room in roomsComputed\" :key=\"room.key\">\r\n              \r\n              <!-- Пароль -->\r\n              <div class=\"home__list-item--box\" v-if=\"passwordForm['active'] && passwordForm['key'] === room['key']\">\r\n                <h3>Вход в комнату</h3>\r\n                <input id=\"enter__password\" type=\"text\" class=\"input--text\" placeholder=\"Введите пароль\" v-model=\"passwordForm['password']\">\r\n                <div class=\"home__list-item--box--btn\">\r\n                  <button class=\"btn\" @click=\"enterRoom(room)\">Войти</button>\r\n                  <button class=\"btn\" @click.prevent=\"passwordForm['active'] = false, passwordForm['key'] = null\">Отмена</button>\r\n                </div>\r\n              </div>\r\n\r\n              <!-- Без пароля -->\r\n              <div v-else class=\"home__list-item--box\">\r\n                <div class=\"home__list-item--btns\">\r\n                  <div class=\"home__list-item--icon\">\r\n                    <font-awesome-icon icon=\"lock\" v-if=\"room.password && room.password.length > 0\"/>\r\n                  </div>\r\n                  <div class=\"home__list-item--icon\">\r\n                    <font-awesome-icon icon=\"eye\" />\r\n                    {{ room.sizeUser }}\r\n                  </div>\r\n                </div>\r\n\r\n                <div class=\"home__list-item__info\">\r\n                  <div class=\"home__list-item--name\">{{ room[\"name\"] }}</div>\r\n                  <button class=\"home__list-item--btn btn\" @click=\"enterRoom(room)\">Войти</button>\r\n                </div>\r\n              </div>\r\n                  \r\n                \r\n              </li>\r\n          </ul>\r\n          </div>\r\n        </div>        \r\n\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n  import { ref, computed, } from \"vue\"\r\n  import { useRouter } from \"vue-router\"\r\n  import socketIOClient from \"socket.io-client\"\r\n  import { useStore } from \"vuex\"\r\n\r\n  const store = useStore()\r\n  const WS = store.state.ws\r\n\r\n  const ws = socketIOClient(WS)\r\n  const router = useRouter()\r\n  const rooms = ref([])\r\n  const errors = ref({})\r\n  const search = ref(\"\")\r\n  // Форма создания комнаты\r\n  const createRoom = ref({\r\n    name: \"\",\r\n    active: false,\r\n    passwordActive: false,\r\n    password: \"\",\r\n  })\r\n  // Форма для ввода пароля\r\n  \r\n  const passwordForm = ref({\r\n    active: false,\r\n    key: \"\",\r\n    password: \"\",\r\n    next: \"\", // Url для перехода на другую страницу\r\n  })\r\n \r\n  // Поиск\r\n  const roomsComputed = computed(() => {\r\n    return rooms.value.filter((e) => {\r\n      if (e.sizeUser > 0) { return e.name.toLowerCase().includes(search.value.toLowerCase()); }\r\n    })\r\n  })\r\n\r\n  // Войти в комнату\r\n  const enterRoom = (room) => {\r\n    passwordForm.value[\"next\"] = `room/${room['key']}?name=${room['name']}&roomID=${room['key']}`\r\n    if (room.password.length > 0) {\r\n      passwordForm.value['active'] = true\r\n      passwordForm.value[\"key\"] = room.key\r\n      ws.emit(\"room-check-password\", { roomID: room.key, password: passwordForm.value.password })\r\n    } else {\r\n      router.push(passwordForm.value.next + `&password=`)\r\n    }\r\n  }\r\n\r\n  ws.on(\"room-password-correct\", () => {\r\n    router.push(passwordForm.value.next + `&password=${passwordForm.value.password}`)\r\n  });\r\n\r\n  ws.on(\"room-password-incorrect\", ({ roomID }) => {\r\n    console.log(\"Пароль не подошел, можно присоединяться к комнате\", roomID)\r\n  })\r\n\r\n  const goToRouteCreateRoom= () => {\r\n    // visibleCreateRoom.value = true\r\n    errors.value = {}\r\n    const name = createRoom.value[\"name\"].trim()\r\n    if (!name || !name.length) {\r\n      errors.value[\"name\"] = \"Ошибка. Название не должно быть пустым\"\r\n    } else if (name.length < 3 || name.length > 50) {\r\n      errors.value[\"name\"] = \"Ошибка. Название должно быть больше 3 символов и меньше 50\"\r\n    }\r\n    const password = createRoom.value[\"password\"].trim()\r\n    if (createRoom.value[\"passwordActive\"]) {\r\n      if (!password || !password.length) {\r\n        errors.value[\"password\"] = \"Ошибка. Пароль не должно быть пустым\"\r\n      } else if (password.length < 3 || password.length > 50) {\r\n        errors.value[\"password\"] = \"Ошибка. Пароль должно быть больше 3 символов и меньше 50\"\r\n      }\r\n    }\r\n    if (Object.keys(errors.value).length > 0) {\r\n      return\r\n    }\r\n    router.push({\r\n      path: \"/create-room\", \r\n      query: { name: name, password: password},\r\n    })\r\n  }\r\n\r\n  // Функция получения всех комнат\r\n  const getRooms = ({ rooms: roomsData }) => {\r\n    console.log(\"HomeView: \", roomsData)\r\n    for (const room in roomsData) {\r\n      rooms.value.push(roomsData[room])\r\n    }\r\n  }\r\n\r\n  // Получение новой комнаты\r\n  const getRoomsNew = ({ key, name, sizeUser, password }) => {\r\n    rooms.value.push({ key, name, sizeUser, password })\r\n  }\r\n\r\n  const updateRoom = ({ key, name, sizeUser }) => {\r\n    console.log(\"update, \", key, name, sizeUser)\r\n    const item = rooms.value.find((e) => e.key === key)\r\n    if (item) {\r\n      item[\"sizeUser\"] = sizeUser\r\n      if (item.sizeUser <= 0) {\r\n        rooms.value = rooms.value.filter((room) => room.key !== item.key)\r\n      }\r\n    }\r\n  }\r\n\r\n  ws.on(\"getRooms\", getRooms) // Получение комнат\r\n  ws.on(\"getRoomsNew\", getRoomsNew) // Только что созданная комната\r\n  ws.on(\"updateRoom\", updateRoom) // Обновление 1 комнаты\r\n  \r\n</script>\r\n\r\n<style lang=\"scss\">\r\n  .header__teleport {\r\n    font-size: 0.875rem;\r\n  }\r\n  .home {\r\n    &__create-room {\r\n      width: 100%;\r\n    }\r\n    &__create-room__inner {\r\n      display: flex;\r\n      gap: 15px;\r\n      flex-direction: column;\r\n      border-radius: var(--border-radius-default);\r\n      background: var(--clr-tertiary);\r\n      align-items: center;\r\n      padding: 10px 0;\r\n    }\r\n    &__search {\r\n      width: 100%;\r\n      border-radius: 0%;\r\n      border-top-right-radius: var(--border-radius-default);\r\n    }\r\n    &__inner {\r\n      display: flex;\r\n    }\r\n    &__info {\r\n      width: 100%;\r\n      position: relative;\r\n    }\r\n    &__video {\r\n      width: 100%;\r\n      height: 100%;\r\n      border-radius: 4px;\r\n    }\r\n    &__content {\r\n      cursor: pointer;\r\n      position: absolute;\r\n      top: 0;\r\n      width: 100%;\r\n      color: var(--clr-tertiary);\r\n      height: 100%;\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      justify-content: center;\r\n      background-color: rgba(0, 0, 0, 0.1);\r\n    }\r\n    &__title {\r\n      &-icon {\r\n        width: 40px;\r\n        height: 40px;\r\n        background-color: var(--clr-tertiary);\r\n        padding: 5px;\r\n        border-radius: 4px;\r\n      }\r\n    }\r\n    // List\r\n    &__list {\r\n      padding: 10px 0;\r\n      width: 100%;\r\n      display: grid;\r\n      grid-template-columns: repeat(3, 1fr);\r\n      gap: 5px;\r\n      &-title {\r\n        margin-bottom: 15px;\r\n      } \r\n      &-main, &-item {\r\n        width: 100%;\r\n      }\r\n      &-item {\r\n        width: 100%;\r\n        border: 2px solid var(--clr-secondary);\r\n        border-radius: var(--border-radius-default);\r\n        background-color: white;\r\n        min-height: 115px;\r\n      }\r\n      &-item--box {\r\n        display: flex;\r\n        flex-direction: column;\r\n        width: 100%;\r\n        padding: 10px;\r\n        height: 100%;\r\n        justify-content: space-evenly;\r\n        & input {\r\n          border-radius: var(--border-radius-default);\r\n        }\r\n      }\r\n      &-item--btns {\r\n        border-bottom: 2px solid var(--clr-secondary);\r\n        margin: 0 0 5px;\r\n        padding: 0 0 5px;\r\n      }\r\n      &-item--box--btn {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        gap: 5px;\r\n        & .btn { width: 100%; }\r\n      }\r\n      &-item--input {\r\n        width: 100%;\r\n      }\r\n      &-item--box--form {\r\n        display: flex;\r\n        align-items: center;\r\n        width: 80%;\r\n        gap: 5px;\r\n      }\r\n      &-item--name {\r\n        font-weight: 600;\r\n        margin: 0 0 5px;\r\n      }\r\n      &-item--users {\r\n        display: flex;\r\n        flex-direction: column;\r\n        align-items: center;\r\n      }\r\n      &-item--icon {\r\n        margin: 0 5px 0 0;\r\n        border: 2px solid var(--clr-secondary);\r\n        padding: 0 10px;\r\n        border-radius: 4px;\r\n        display: inline-block;\r\n        & > .svg__icon {\r\n          width: 20px;\r\n          height: 20px;\r\n        }\r\n        & svg path {\r\n          stroke: var(--clr-secondary);\r\n        }\r\n      }\r\n      &-item--users {\r\n        border-left: 2px solid var(--clr-secondary);\r\n        padding: 10px;\r\n        margin-left: auto;\r\n      }\r\n    }\r\n  }\r\n  @media screen and (max-width: 900px) {\r\n    .home__list {\r\n      grid-template-columns: repeat(2, 1fr);\r\n    }\r\n  }\r\n  @media screen and (max-width: 600px) {\r\n    .home__list {\r\n      grid-template-columns: repeat(1, 1fr);\r\n    }\r\n  }\r\n</style>","import script from \"./HomeView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./HomeView.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./HomeView.vue?vue&type=style&index=0&id=221604c2&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["store","useStore","WS","state","ws","socketIOClient","router","useRouter","rooms","ref","errors","search","createRoom","name","active","passwordActive","password","passwordForm","key","next","roomsComputed","computed","value","filter","e","sizeUser","toLowerCase","includes","enterRoom","room","length","emit","roomID","push","on","console","log","goToRouteCreateRoom","trim","Object","keys","path","query","getRooms","roomsData","getRoomsNew","updateRoom","item","find","__exports__"],"sourceRoot":""}