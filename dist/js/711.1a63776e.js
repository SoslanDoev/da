"use strict";(self["webpackChunkvue_chat_v2"]=self["webpackChunkvue_chat_v2"]||[]).push([[711],{9711:function(e,s,a){a.r(s),a.d(s,{default:function(){return N}});a(4114);var l=a(6768),o=a(5130),t=a(4232),n=a(144),u=a(1387),i=a(7910),c=a(782);const r={class:"home"},v={class:"container"},k={class:"home__buttons"},p={class:"home__inner"},d={key:0,class:"home__create-room"},m={class:"home__create-room__inner"},_=(0,l.Lk)("h1",{class:"title home__title"},[(0,l.Lk)("span",{class:"span--green"},"Создание"),(0,l.eW)(" комнаты")],-1),h={class:"box"},w=(0,l.Lk)("label",{class:"label",for:"name"},"Название комнаты *",-1),b={key:0,for:"name",class:"error"},y={class:"box"},L=(0,l.Lk)("label",{class:"label",for:"password"},"Введите пароль*",-1),C={key:0,for:"password",class:"error"},g={key:1,class:"home__info"},f={key:0,class:"title home__title"},x=(0,l.Lk)("span",{class:"span--green"},"Все",-1),E={key:1,class:"title home__title"},X=(0,l.Lk)("span",{class:"span--green"},"Все",-1),U={key:2,class:"box"},R=(0,l.Lk)("label",{class:"label",for:"search"},"Поиск: ",-1),K={class:"home__list"},z={key:0,class:"home__list-item--box"},A=(0,l.Lk)("h3",null,"Вход в комнату",-1),$={class:"home__list-item--box--btn"},D=["onClick"],V={key:1,class:"home__list-item--box"},W={class:"home__list-item--btns"},Q={class:"home__list-item--icon"},I={class:"home__list-item--icon"},J={class:"home__list-item__info"},j={class:"home__list-item--name"},F=["onClick"];var H={__name:"HomeView",setup(e){const s=(0,c.Pj)(),a=s.state.ws,H=(0,i.Ay)(a),q=(0,u.rd)(),N=(0,n.KR)([]),O=(0,n.KR)({}),P=(0,n.KR)(""),B=(0,n.KR)({name:"",active:!1,passwordActive:!1,password:""}),G=(0,n.KR)({active:!1,key:"",password:"",next:""}),M=(0,l.EW)((()=>N.value.filter((e=>{if(e.sizeUser>0)return e.name.toLowerCase().includes(P.value.toLowerCase())})))),S=e=>{G.value["next"]=`room/${e["key"]}?name=${e["name"]}&roomID=${e["key"]}`,e.password.length>0?(G.value["active"]=!0,G.value["key"]=e.key,H.emit("room-check-password",{roomID:e.key,password:G.value.password})):q.push(G.value.next+"&password=")};H.on("room-password-correct",(()=>{q.push(G.value.next+`&password=${G.value.password}`)})),H.on("room-password-incorrect",(({roomID:e})=>{console.log("Пароль не подошел, можно присоединяться к комнате",e)}));const T=()=>{O.value={};const e=B.value["name"].trim();e&&e.length?(e.length<3||e.length>50)&&(O.value["name"]="Ошибка. Название должно быть больше 3 символов и меньше 50"):O.value["name"]="Ошибка. Название не должно быть пустым";const s=B.value["password"].trim();B.value["passwordActive"]&&(s&&s.length?(s.length<3||s.length>50)&&(O.value["password"]="Ошибка. Пароль должно быть больше 3 символов и меньше 50"):O.value["password"]="Ошибка. Пароль не должно быть пустым"),Object.keys(O.value).length>0||q.push({path:"/create-room",query:{name:e,password:s}})},Y=({rooms:e})=>{console.log("HomeView: ",e);for(const s in e)N.value.push(e[s])},Z=({key:e,name:s,sizeUser:a,password:l})=>{N.value.push({key:e,name:s,sizeUser:a,password:l})},ee=({key:e,name:s,sizeUser:a})=>{console.log("update, ",e,s,a);const l=N.value.find((s=>s.key===e));l&&(l["sizeUser"]=a,l.sizeUser<=0&&(N.value=N.value.filter((e=>e.key!==l.key))))};return H.on("getRooms",Y),H.on("getRoomsNew",Z),H.on("updateRoom",ee),(e,s)=>{const a=(0,l.g2)("font-awesome-icon");return(0,l.uX)(),(0,l.CE)("div",r,[(0,l.Lk)("div",v,[(0,l.Lk)("div",k,[B.value["active"]?((0,l.uX)(),(0,l.CE)("button",{key:0,class:"btn",onClick:s[0]||(s[0]=(0,o.D$)((e=>B.value["active"]=!1),["prevent"]))},"Все комнаты")):((0,l.uX)(),(0,l.CE)("button",{key:1,class:"btn",onClick:s[1]||(s[1]=e=>B.value["active"]=!0)},"Создать комнату"))]),(0,l.Lk)("div",p,[B.value["active"]?((0,l.uX)(),(0,l.CE)("div",d,[(0,l.Lk)("div",m,[_,(0,l.Lk)("div",h,[w,(0,l.bo)((0,l.Lk)("input",{type:"text",onKeyup:(0,o.jR)(T,["enter"]),id:"name","onUpdate:modelValue":s[2]||(s[2]=e=>B.value["name"]=e),class:"input--text",placeholder:"Введите название комнаты"},null,544),[[o.Jo,B.value["name"]]])]),O.value["name"]?((0,l.uX)(),(0,l.CE)("label",b,(0,t.v_)(O.value["name"]),1)):(0,l.Q3)("",!0),(0,l.Lk)("div",null,[B.value["passwordActive"]?((0,l.uX)(),(0,l.CE)("button",{key:1,class:"btn",onClick:s[4]||(s[4]=e=>B.value["passwordActive"]=!1)},"Без пароля")):((0,l.uX)(),(0,l.CE)("button",{key:0,class:"btn",onClick:s[3]||(s[3]=e=>B.value["passwordActive"]=!0)},"Поставить пароль"))]),B.value["passwordActive"]?((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[(0,l.Lk)("div",y,[L,(0,l.bo)((0,l.Lk)("input",{id:"password",type:"text","onUpdate:modelValue":s[5]||(s[5]=e=>B.value["password"]=e),class:"input--text",placeholder:"Введите пароль"},null,512),[[o.Jo,B.value["password"]]])]),O.value["password"]?((0,l.uX)(),(0,l.CE)("label",C,(0,t.v_)(O.value["password"]),1)):(0,l.Q3)("",!0)],64)):(0,l.Q3)("",!0),(0,l.Lk)("button",{class:"btn",onClick:(0,o.D$)(T,["prevent"])},"Создать комнату")])])):((0,l.uX)(),(0,l.CE)("div",g,[N.value.length?((0,l.uX)(),(0,l.CE)("h1",E,[X,(0,l.eW)(" комнаты")])):((0,l.uX)(),(0,l.CE)("h1",f,[x,(0,l.eW)(" комнаты пусты")])),N.value.length?((0,l.uX)(),(0,l.CE)("div",U,[R,(0,l.bo)((0,l.Lk)("input",{type:"text",id:"search",class:"input--text home__search",placeholder:"Поиск...","onUpdate:modelValue":s[6]||(s[6]=e=>P.value=e)},null,512),[[o.Jo,P.value]])])):(0,l.Q3)("",!0),(0,l.Lk)("ul",K,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(M.value,(e=>((0,l.uX)(),(0,l.CE)("li",{class:"home__list-item",key:e.key},[G.value["active"]&&G.value["key"]===e["key"]?((0,l.uX)(),(0,l.CE)("div",z,[A,(0,l.bo)((0,l.Lk)("input",{id:"enter__password",type:"text",class:"input--text",placeholder:"Введите пароль","onUpdate:modelValue":s[7]||(s[7]=e=>G.value["password"]=e)},null,512),[[o.Jo,G.value["password"]]]),(0,l.Lk)("div",$,[(0,l.Lk)("button",{class:"btn",onClick:s=>S(e)},"Войти",8,D),(0,l.Lk)("button",{class:"btn",onClick:s[8]||(s[8]=(0,o.D$)((e=>(G.value["active"]=!1,G.value["key"]=null)),["prevent"]))},"Отмена")])])):((0,l.uX)(),(0,l.CE)("div",V,[(0,l.Lk)("div",W,[(0,l.Lk)("div",Q,[e.password&&e.password.length>0?((0,l.uX)(),(0,l.Wv)(a,{key:0,icon:"lock"})):(0,l.Q3)("",!0)]),(0,l.Lk)("div",I,[(0,l.bF)(a,{icon:"eye"}),(0,l.eW)(" "+(0,t.v_)(e.sizeUser),1)])]),(0,l.Lk)("div",J,[(0,l.Lk)("div",j,(0,t.v_)(e["name"]),1),(0,l.Lk)("button",{class:"home__list-item--btn btn",onClick:s=>S(e)},"Войти",8,F)])]))])))),128))])]))])])])}}};const q=H;var N=q}}]);
//# sourceMappingURL=711.1a63776e.js.map