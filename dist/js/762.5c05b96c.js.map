{"version":3,"file":"js/762.5c05b96c.js","mappings":"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","sources":["webpack://vue-chat-v2/./node_modules/sdp/sdp.js","webpack://vue-chat-v2/./node_modules/uuid/dist/esm-browser/native.js","webpack://vue-chat-v2/./node_modules/uuid/dist/esm-browser/rng.js","webpack://vue-chat-v2/./node_modules/uuid/dist/esm-browser/stringify.js","webpack://vue-chat-v2/./node_modules/uuid/dist/esm-browser/v4.js","webpack://vue-chat-v2/./src/components/AppAlert.vue","webpack://vue-chat-v2/./src/components/AppAlert.vue?dd66","webpack://vue-chat-v2/./src/components/AppVideo.vue","webpack://vue-chat-v2/./src/components/AppVideo.vue?3e3b","webpack://vue-chat-v2/./src/components/chat/ChatMessage.vue","webpack://vue-chat-v2/../lib/bufferbuilder.ts","webpack://vue-chat-v2/../lib/binarypack.ts","webpack://vue-chat-v2/./node_modules/webrtc-adapter/src/js/utils.js","webpack://vue-chat-v2/./node_modules/webrtc-adapter/src/js/chrome/getusermedia.js","webpack://vue-chat-v2/./node_modules/webrtc-adapter/src/js/chrome/chrome_shim.js","webpack://vue-chat-v2/./node_modules/webrtc-adapter/src/js/firefox/getusermedia.js","webpack://vue-chat-v2/./node_modules/webrtc-adapter/src/js/firefox/getdisplaymedia.js","webpack://vue-chat-v2/./node_modules/webrtc-adapter/src/js/firefox/firefox_shim.js","webpack://vue-chat-v2/./node_modules/webrtc-adapter/src/js/safari/safari_shim.js","webpack://vue-chat-v2/./node_modules/webrtc-adapter/src/js/common_shim.js","webpack://vue-chat-v2/./node_modules/webrtc-adapter/src/js/adapter_factory.js","webpack://vue-chat-v2/./node_modules/webrtc-adapter/src/js/adapter_core.js","webpack://vue-chat-v2/../../src/utils/int.ts","webpack://vue-chat-v2/../../src/utils/utf8.ts","webpack://vue-chat-v2/../src/ExtData.ts","webpack://vue-chat-v2/../src/DecodeError.ts","webpack://vue-chat-v2/../src/timestamp.ts","webpack://vue-chat-v2/../src/ExtensionCodec.ts","webpack://vue-chat-v2/../../src/utils/typedArrays.ts","webpack://vue-chat-v2/../src/Encoder.ts","webpack://vue-chat-v2/../../src/utils/prettyByte.ts","webpack://vue-chat-v2/../src/CachedKeyDecoder.ts","webpack://vue-chat-v2/../src/Decoder.ts","webpack://vue-chat-v2/lib/dataconnection/BufferedConnection/binaryPackChunker.ts","webpack://vue-chat-v2/lib/supports.ts","webpack://vue-chat-v2/lib/utils/validateId.ts","webpack://vue-chat-v2/lib/utils/randomToken.ts","webpack://vue-chat-v2/lib/util.ts","webpack://vue-chat-v2/lib/logger.ts","webpack://vue-chat-v2/node_modules/eventemitter3/index.js","webpack://vue-chat-v2/lib/enums.ts","webpack://vue-chat-v2/package.json","webpack://vue-chat-v2/lib/socket.ts","webpack://vue-chat-v2/lib/negotiator.ts","webpack://vue-chat-v2/lib/peerError.ts","webpack://vue-chat-v2/lib/baseconnection.ts","webpack://vue-chat-v2/lib/mediaconnection.ts","webpack://vue-chat-v2/lib/api.ts","webpack://vue-chat-v2/lib/dataconnection/DataConnection.ts","webpack://vue-chat-v2/lib/dataconnection/BufferedConnection/BufferedConnection.ts","webpack://vue-chat-v2/lib/dataconnection/BufferedConnection/BinaryPack.ts","webpack://vue-chat-v2/lib/dataconnection/BufferedConnection/Raw.ts","webpack://vue-chat-v2/lib/dataconnection/BufferedConnection/Json.ts","webpack://vue-chat-v2/lib/peer.ts","webpack://vue-chat-v2/lib/exports.ts","webpack://vue-chat-v2/./src/views/RoomView.vue","webpack://vue-chat-v2/./src/views/RoomView.vue?c793","webpack://vue-chat-v2/./node_modules/core-js/internals/an-instance.js","webpack://vue-chat-v2/./node_modules/core-js/internals/dom-exception-constants.js","webpack://vue-chat-v2/./node_modules/core-js/internals/error-stack-clear.js","webpack://vue-chat-v2/./node_modules/core-js/internals/inherit-if-required.js","webpack://vue-chat-v2/./node_modules/core-js/internals/normalize-string-argument.js","webpack://vue-chat-v2/./node_modules/core-js/internals/to-string.js","webpack://vue-chat-v2/./node_modules/core-js/internals/validate-arguments-length.js","webpack://vue-chat-v2/./node_modules/core-js/modules/web.dom-exception.stack.js","webpack://vue-chat-v2/./node_modules/core-js/modules/web.url-search-params.delete.js","webpack://vue-chat-v2/./node_modules/core-js/modules/web.url-search-params.has.js","webpack://vue-chat-v2/./node_modules/core-js/modules/web.url-search-params.size.js"],"sourcesContent":["/* eslint-env node */\n'use strict';\n\n// SDP helpers.\nconst SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substring(2, 12);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(line => line.trim());\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  const parts = blob.split('\\nm=');\n  return parts.map((part, index) => (index > 0 ?\n    'm=' + part : part).trim() + '\\r\\n');\n};\n\n// Returns the session description.\nSDPUtils.getDescription = function(blob) {\n  const sections = SDPUtils.splitSections(blob);\n  return sections && sections[0];\n};\n\n// Returns the individual media sections.\nSDPUtils.getMediaSections = function(blob) {\n  const sections = SDPUtils.splitSections(blob);\n  sections.shift();\n  return sections;\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(line => line.indexOf(prefix) === 0);\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\n// Input can be prefixed with a=.\nSDPUtils.parseCandidate = function(line) {\n  let parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  const candidate = {\n    foundation: parts[0],\n    component: {1: 'rtp', 2: 'rtcp'}[parts[1]] || parts[1],\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    address: parts[4], // address is an alias for ip.\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7],\n  };\n\n  for (let i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compatibility.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag. Don't overwrite.\n        if (candidate[parts[i]] === undefined) {\n          candidate[parts[i]] = parts[i + 1];\n        }\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\n// This does not include the a= prefix!\nSDPUtils.writeCandidate = function(candidate) {\n  const sdp = [];\n  sdp.push(candidate.foundation);\n\n  const component = candidate.component;\n  if (component === 'rtp') {\n    sdp.push(1);\n  } else if (component === 'rtcp') {\n    sdp.push(2);\n  } else {\n    sdp.push(component);\n  }\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.address || candidate.ip);\n  sdp.push(candidate.port);\n\n  const type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress);\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort);\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.usernameFragment || candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.usernameFragment || candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// Sample input:\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substring(14).split(' ');\n};\n\n// Parses a rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  let parts = line.substring(9).split(' ');\n  const parsed = {\n    payloadType: parseInt(parts.shift(), 10), // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  // legacy alias, got renamed back to channels in ORTC.\n  parsed.numChannels = parsed.channels;\n  return parsed;\n};\n\n// Generates a rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  let pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  const channels = codec.channels || codec.numChannels || 1;\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (channels !== 1 ? '/' + channels : '') + '\\r\\n';\n};\n\n// Parses a extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  const parts = line.substring(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1],\n    attributes: parts.slice(2).join(' '),\n  };\n};\n\n// Generates an extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n        ? '/' + headerExtension.direction\n        : '') +\n      ' ' + headerExtension.uri +\n      (headerExtension.attributes ? ' ' + headerExtension.attributes : '') +\n      '\\r\\n';\n};\n\n// Parses a fmtp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  const parsed = {};\n  let kv;\n  const parts = line.substring(line.indexOf(' ') + 1).split(';');\n  for (let j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates a fmtp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  let line = '';\n  let pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    const params = [];\n    Object.keys(codec.parameters).forEach(param => {\n      if (codec.parameters[param] !== undefined) {\n        params.push(param + '=' + codec.parameters[param]);\n      } else {\n        params.push(param);\n      }\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses a rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  const parts = line.substring(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' '),\n  };\n};\n\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  let lines = '';\n  let pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(fb => {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses a RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  const sp = line.indexOf(' ');\n  const parts = {\n    ssrc: parseInt(line.substring(7, sp), 10),\n  };\n  const colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substring(sp + 1, colon);\n    parts.value = line.substring(colon + 1);\n  } else {\n    parts.attribute = line.substring(sp + 1);\n  }\n  return parts;\n};\n\n// Parse a ssrc-group line (see RFC 5576). Sample input:\n// a=ssrc-group:semantics 12 34\nSDPUtils.parseSsrcGroup = function(line) {\n  const parts = line.substring(13).split(' ');\n  return {\n    semantics: parts.shift(),\n    ssrcs: parts.map(ssrc => parseInt(ssrc, 10)),\n  };\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// Returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  const mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substring(6);\n  }\n};\n\n// Parses a fingerprint line for DTLS-SRTP.\nSDPUtils.parseFingerprint = function(line) {\n  const parts = line.substring(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1].toUpperCase(), // the definition is upper-case in RFC 4572.\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  const lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint),\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  let sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(fp => {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n\n// Parses a=crypto lines into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#dictionary-rtcsrtpsdesparameters-members\nSDPUtils.parseCryptoLine = function(line) {\n  const parts = line.substring(9).split(' ');\n  return {\n    tag: parseInt(parts[0], 10),\n    cryptoSuite: parts[1],\n    keyParams: parts[2],\n    sessionParams: parts.slice(3),\n  };\n};\n\nSDPUtils.writeCryptoLine = function(parameters) {\n  return 'a=crypto:' + parameters.tag + ' ' +\n    parameters.cryptoSuite + ' ' +\n    (typeof parameters.keyParams === 'object'\n      ? SDPUtils.writeCryptoKeyParams(parameters.keyParams)\n      : parameters.keyParams) +\n    (parameters.sessionParams ? ' ' + parameters.sessionParams.join(' ') : '') +\n    '\\r\\n';\n};\n\n// Parses the crypto key parameters into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#rtcsrtpkeyparam*\nSDPUtils.parseCryptoKeyParams = function(keyParams) {\n  if (keyParams.indexOf('inline:') !== 0) {\n    return null;\n  }\n  const parts = keyParams.substring(7).split('|');\n  return {\n    keyMethod: 'inline',\n    keySalt: parts[0],\n    lifeTime: parts[1],\n    mkiValue: parts[2] ? parts[2].split(':')[0] : undefined,\n    mkiLength: parts[2] ? parts[2].split(':')[1] : undefined,\n  };\n};\n\nSDPUtils.writeCryptoKeyParams = function(keyParams) {\n  return keyParams.keyMethod + ':'\n    + keyParams.keySalt +\n    (keyParams.lifeTime ? '|' + keyParams.lifeTime : '') +\n    (keyParams.mkiValue && keyParams.mkiLength\n      ? '|' + keyParams.mkiValue + ':' + keyParams.mkiLength\n      : '');\n};\n\n// Extracts all SDES parameters.\nSDPUtils.getCryptoParameters = function(mediaSection, sessionpart) {\n  const lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=crypto:');\n  return lines.map(SDPUtils.parseCryptoLine);\n};\n\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  const ufrag = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-ufrag:')[0];\n  const pwd = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-pwd:')[0];\n  if (!(ufrag && pwd)) {\n    return null;\n  }\n  return {\n    usernameFragment: ufrag.substring(12),\n    password: pwd.substring(10),\n  };\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  let sdp = 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n  if (params.iceLite) {\n    sdp += 'a=ice-lite\\r\\n';\n  }\n  return sdp;\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  const description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: [],\n  };\n  const lines = SDPUtils.splitLines(mediaSection);\n  const mline = lines[0].split(' ');\n  description.profile = mline[2];\n  for (let i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    const pt = mline[i];\n    const rtpmapline = SDPUtils.matchPrefix(\n      mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      const codec = SDPUtils.parseRtpMap(rtpmapline);\n      const fmtps = SDPUtils.matchPrefix(\n        mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(line => {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  const wildcardRtcpFb = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-fb:* ')\n    .map(SDPUtils.parseRtcpFb);\n  description.codecs.forEach(codec => {\n    wildcardRtcpFb.forEach(fb=> {\n      const duplicate = codec.rtcpFeedback.find(existingFeedback => {\n        return existingFeedback.type === fb.type &&\n          existingFeedback.parameter === fb.parameter;\n      });\n      if (!duplicate) {\n        codec.rtcpFeedback.push(fb);\n      }\n    });\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  let sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' ' + (caps.profile || 'UDP/TLS/RTP/SAVPF') + ' ';\n  sdp += caps.codecs.map(codec => {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(codec => {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  let maxptime = 0;\n  caps.codecs.forEach(codec => {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n\n  if (caps.headerExtensions) {\n    caps.headerExtensions.forEach(extension => {\n      sdp += SDPUtils.writeExtmap(extension);\n    });\n  }\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  const encodingParameters = [];\n  const description = SDPUtils.parseRtpParameters(mediaSection);\n  const hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  const hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  const ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(line => SDPUtils.parseSsrcMedia(line))\n    .filter(parts => parts.attribute === 'cname');\n  const primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  let secondarySsrc;\n\n  const flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n    .map(line => {\n      const parts = line.substring(17).split(' ');\n      return parts.map(part => parseInt(part, 10));\n    });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(codec => {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      let encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10),\n      };\n      if (primarySsrc && secondarySsrc) {\n        encParam.rtx = {ssrc: secondarySsrc};\n      }\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: primarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red',\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc,\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  let bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substring(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substring(5), 10) * 1000 * 0.95\n          - (50 * 40 * 8);\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(params => {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  const rtcpParameters = {};\n\n  // Gets the first SSRC. Note that with RTX there might be multiple\n  // SSRCs.\n  const remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(line => SDPUtils.parseSsrcMedia(line))\n    .filter(obj => obj.attribute === 'cname')[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  const rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrіbute.\n  // Note that Edge does not support unmuxed RTCP.\n  const mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\nSDPUtils.writeRtcpParameters = function(rtcpParameters) {\n  let sdp = '';\n  if (rtcpParameters.reducedSize) {\n    sdp += 'a=rtcp-rsize\\r\\n';\n  }\n  if (rtcpParameters.mux) {\n    sdp += 'a=rtcp-mux\\r\\n';\n  }\n  if (rtcpParameters.ssrc !== undefined && rtcpParameters.cname) {\n    sdp += 'a=ssrc:' + rtcpParameters.ssrc +\n      ' cname:' + rtcpParameters.cname + '\\r\\n';\n  }\n  return sdp;\n};\n\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  let parts;\n  const spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substring(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  const planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(line => SDPUtils.parseSsrcMedia(line))\n    .filter(msidParts => msidParts.attribute === 'msid');\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\n// SCTP\n// parses draft-ietf-mmusic-sctp-sdp-26 first and falls back\n// to draft-ietf-mmusic-sctp-sdp-05\nSDPUtils.parseSctpDescription = function(mediaSection) {\n  const mline = SDPUtils.parseMLine(mediaSection);\n  const maxSizeLine = SDPUtils.matchPrefix(mediaSection, 'a=max-message-size:');\n  let maxMessageSize;\n  if (maxSizeLine.length > 0) {\n    maxMessageSize = parseInt(maxSizeLine[0].substring(19), 10);\n  }\n  if (isNaN(maxMessageSize)) {\n    maxMessageSize = 65536;\n  }\n  const sctpPort = SDPUtils.matchPrefix(mediaSection, 'a=sctp-port:');\n  if (sctpPort.length > 0) {\n    return {\n      port: parseInt(sctpPort[0].substring(12), 10),\n      protocol: mline.fmt,\n      maxMessageSize,\n    };\n  }\n  const sctpMapLines = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:');\n  if (sctpMapLines.length > 0) {\n    const parts = sctpMapLines[0]\n      .substring(10)\n      .split(' ');\n    return {\n      port: parseInt(parts[0], 10),\n      protocol: parts[1],\n      maxMessageSize,\n    };\n  }\n};\n\n// SCTP\n// outputs the draft-ietf-mmusic-sctp-sdp-26 version that all browsers\n// support by now receiving in this format, unless we originally parsed\n// as the draft-ietf-mmusic-sctp-sdp-05 format (indicated by the m-line\n// protocol of DTLS/SCTP -- without UDP/ or TCP/)\nSDPUtils.writeSctpDescription = function(media, sctp) {\n  let output = [];\n  if (media.protocol !== 'DTLS/SCTP') {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.protocol + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctp-port:' + sctp.port + '\\r\\n',\n    ];\n  } else {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.port + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctpmap:' + sctp.port + ' ' + sctp.protocol + ' 65535\\r\\n',\n    ];\n  }\n  if (sctp.maxMessageSize !== undefined) {\n    output.push('a=max-message-size:' + sctp.maxMessageSize + '\\r\\n');\n  }\n  return output.join('');\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function() {\n  return Math.random().toString().substr(2, 22);\n};\n\n// Write boiler plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\n// sessUser is optional and defaults to 'thisisadapterortc'\nSDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {\n  let sessionId;\n  const version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  const user = sessUser || 'thisisadapterortc';\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=' + user + ' ' + sessionId + ' ' + version +\n        ' IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  const lines = SDPUtils.splitLines(mediaSection);\n  for (let i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substring(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  const lines = SDPUtils.splitLines(mediaSection);\n  const mline = lines[0].split(' ');\n  return mline[0].substring(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function(mediaSection) {\n  const lines = SDPUtils.splitLines(mediaSection);\n  const parts = lines[0].substring(2).split(' ');\n  return {\n    kind: parts[0],\n    port: parseInt(parts[1], 10),\n    protocol: parts[2],\n    fmt: parts.slice(3).join(' '),\n  };\n};\n\nSDPUtils.parseOLine = function(mediaSection) {\n  const line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n  const parts = line.substring(2).split(' ');\n  return {\n    username: parts[0],\n    sessionId: parts[1],\n    sessionVersion: parseInt(parts[2], 10),\n    netType: parts[3],\n    addressType: parts[4],\n    address: parts[5],\n  };\n};\n\n// a very naive interpretation of a valid SDP.\nSDPUtils.isValidSDP = function(blob) {\n  if (typeof blob !== 'string' || blob.length === 0) {\n    return false;\n  }\n  const lines = SDPUtils.splitLines(blob);\n  for (let i = 0; i < lines.length; i++) {\n    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n      return false;\n    }\n    // TODO: check the modifier a bit more.\n  }\n  return true;\n};\n\n// Expose public methods.\nif (typeof module === 'object') {\n  module.exports = SDPUtils;\n}\n","var randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default {\n  randomUUID\n};","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\n\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n  return getRandomValues(rnds8);\n}","import validate from './validate.js';\n\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  //\n  // Note to future-self: No, you can't remove the `toLowerCase()` call.\n  // REF: https://github.com/uuidjs/uuid/pull/677#issuecomment-1757351351\n  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();\n}\nfunction stringify(arr, offset = 0) {\n  var uuid = unsafeStringify(arr, offset);\n  // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n  return uuid;\n}\nexport default stringify;","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    offset = offset || 0;\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n    return buf;\n  }\n  return unsafeStringify(rnds);\n}\nexport default v4;","<template>\r\n    <Transition name=\"fade\" @click.prevent=\"hide\">\r\n        <div class=\"alert\" v-if=\"isVisible\">\r\n            {{ message }}\r\n        </div>\r\n    </Transition>\r\n</template>\r\n\r\n<script setup>\r\n    import { defineEmits, defineProps, onMounted, onUnmounted, ref } from \"vue\"\r\n    const emit = defineEmits([\"hide\"])\r\n    defineProps({ message: String, })\r\n    const isVisible = ref(false)\r\n    const myTimeout = ref(null)\r\n    // Отключить\r\n    const hide = () => {\r\n        isVisible.value = false \r\n        clearTimeout(myTimeout.value)\r\n        myTimeout.value = null\r\n        emit(\"hide\", false)\r\n    }\r\n    // Активировать\r\n    const show = () => {\r\n        isVisible.value = true\r\n        myTimeout.value = setTimeout(() => {\r\n            hide()\r\n        }, 2500);\r\n    }\r\n    onMounted(() => { show() })\r\n    onUnmounted(() => { clearTimeout(myTimeout.value) })\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n    .alert {\r\n        max-width: 250px;\r\n        cursor: pointer;\r\n        position: fixed;\r\n        z-index: 100;\r\n        top: 10px;\r\n        right: 10px;\r\n        padding: 10px;\r\n        background-color: var(--clr-primary);\r\n        color: var(--clr-tertiary);\r\n        border-radius: var(--border-radius-default);\r\n    }\r\n</style>","import script from \"./AppAlert.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./AppAlert.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./AppAlert.vue?vue&type=style&index=0&id=716a84f9&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\r\n    <div class=\"video__box\" :id=\"`${videoID}--box`\">\r\n        <video \r\n            ref=\"videoEL\"\r\n            class=\"video\"\r\n            :id=\"`${videoID}--video`\"\r\n            :srcObject=\"srcObject\"\r\n            :muted=\"muted\"\r\n            @loadedmetadata=\"onLoadedMetadata\"\r\n            @click.prevent=\"onActive\"\r\n            v-if=\"srcObject\"\r\n        ></video>\r\n\r\n        <div v-else>ПУсто</div>\r\n        <p class=\"video__box-name\">{{ name }}</p>\r\n        <div class=\"video__top\" v-if=\"!isMe\">\r\n            <!-- <AppAudio :class=\"{'svg__icon--disabled': audioActive}\"/> -->\r\n            <div class=\"video__top-box\" :class=\"{'svg__icon--disabled': audioActive}\">\r\n                <font-awesome-icon class=\"svg__icon\" icon=\"microphone\"/>\r\n            </div>\r\n            <div class=\"video__top-box\" :class=\"{'svg__icon--disabled': videoActive}\">\r\n                <font-awesome-icon class=\"svg__icon\" icon=\"video\"/>\r\n            </div>\r\n            <div class=\"video__top-box\" :class=\"{'svg__icon--disabled': headphoneActive}\">\r\n                <font-awesome-icon class=\"svg__icon\" icon=\"headphones\"/>\r\n            </div>\r\n            <div class=\"video__top-box\" :class=\"{'svg__icon--disabled': screenShareActive}\">\r\n                <font-awesome-icon class=\"svg__icon\" icon=\"display\"/>\r\n            </div>\r\n\r\n            <!-- <AppVideo :class=\"{'svg__icon--disabled': videoActive}\" />  -->\r\n            <!-- <AppHeadphone :class=\"{'svg__icon--disabled': headphoneActive}\" />  -->\r\n            <!-- <AppScreenShare :class=\"{'svg__icon--disabled': screenShareActive}\" />  -->\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n    import { defineProps } from \"vue\"\r\n    defineProps({\r\n        isMe: { type: Boolean, default: true }, // True - Я \\ False - Другой человек\r\n        srcObject: { type: Object, },\r\n        muted: { type: Boolean, },\r\n        videoID: { type: String, },\r\n        name: { type: String }, \r\n        audioActive: { type: Boolean, default: false },\r\n        headphoneActive: { type: Boolean, default: false },\r\n        screenShareActive: { type: Boolean, default: false },\r\n        videoActive: { type: Boolean, default: false },\r\n    })\r\n    const onLoadedMetadata = (video) => { video.target.play() }\r\n    const onActive = (video) => { video.target.classList.toggle(\"video--active\"); }\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n    .video {\r\n        object-fit: cover;\r\n        background-color: var(--clr-secondary);\r\n        width: 100%;\r\n        height: 100%;\r\n        position: relative;\r\n        &__top {\r\n            position: absolute;\r\n            top: 5px;\r\n            right: 5px;\r\n            display: flex;\r\n            gap: 15px;\r\n            & svg {\r\n                width: 15px;\r\n                height: 15px;\r\n                color: var(--clr-secondary);\r\n            }\r\n        }\r\n        &__top-box {\r\n            border: 2px solid var(--clr-tertiary);\r\n            opacity: .5;\r\n            padding: 2px;\r\n            background: var(--clr-tertiary);\r\n            border-radius: var(--border-radius-default);\r\n        }\r\n        &__box {\r\n            width: 33.33333%;\r\n            height: 50%;\r\n            position: relative;\r\n            border: 2px solid var(--clr-tertiary);\r\n        }\r\n        &__box-name {\r\n            position: absolute;\r\n            bottom: 5px;\r\n            left: 5px;\r\n            color: var(--clr-tertiary);\r\n        }\r\n        &--active {\r\n            position: fixed;\r\n            inset: 0;\r\n            width: 100%;\r\n            height: 100%;\r\n            z-index: 5;\r\n            object-fit: contain;\r\n            background: rgba(0, 0, 0, 0.8);\r\n        }\r\n    }\r\n</style>","import script from \"./AppVideo.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./AppVideo.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./AppVideo.vue?vue&type=style&index=0&id=69f22e46&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import script from \"./ChatMessage.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ChatMessage.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ChatMessage.vue?vue&type=style&index=0&id=79668ae8&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","class BufferBuilder {\n\tprivate _pieces: number[];\n\tprivate readonly _parts: ArrayBufferView[];\n\n\tconstructor() {\n\t\tthis._pieces = [];\n\t\tthis._parts = [];\n\t}\n\n\tappend_buffer(data: ArrayBufferView) {\n\t\tthis.flush();\n\t\tthis._parts.push(data);\n\t}\n\n\tappend(data: number) {\n\t\tthis._pieces.push(data);\n\t}\n\n\tflush() {\n\t\tif (this._pieces.length > 0) {\n\t\t\tconst buf = new Uint8Array(this._pieces);\n\t\t\tthis._parts.push(buf);\n\t\t\tthis._pieces = [];\n\t\t}\n\t}\n\n\tprivate encoder = new TextEncoder();\n\n\tpublic toArrayBuffer() {\n\t\tconst buffer = [];\n\t\tfor (const part of this._parts) {\n\t\t\tbuffer.push(part);\n\t\t}\n\t\treturn concatArrayBuffers(buffer).buffer;\n\t}\n}\n\nexport { BufferBuilder };\n\nfunction concatArrayBuffers(bufs: ArrayBufferView[]) {\n\tlet size = 0;\n\tfor (const buf of bufs) {\n\t\tsize += buf.byteLength;\n\t}\n\tconst result = new Uint8Array(size);\n\tlet offset = 0;\n\tfor (const buf of bufs) {\n\t\tconst view = new Uint8Array(buf.buffer, buf.byteOffset, buf.byteLength);\n\t\tresult.set(view, offset);\n\t\toffset += buf.byteLength;\n\t}\n\treturn result;\n}\n","import { BufferBuilder } from \"./bufferbuilder\";\n\nexport type Packable =\n\t| null\n\t| undefined\n\t| string\n\t| number\n\t| boolean\n\t| Date\n\t| ArrayBuffer\n\t| Blob\n\t| Array<Packable>\n\t| { [key: string]: Packable }\n\t| ({ BYTES_PER_ELEMENT: number } & ArrayBufferView);\nexport type Unpackable =\n\t| null\n\t| undefined\n\t| string\n\t| number\n\t| boolean\n\t| ArrayBuffer\n\t| Array<Unpackable>\n\t| { [key: string]: Unpackable };\n\nexport function unpack<T extends Unpackable>(data: ArrayBuffer) {\n\tconst unpacker = new Unpacker(data);\n\treturn unpacker.unpack() as T;\n}\n\nexport function pack(data: Packable) {\n\tconst packer = new Packer();\n\tconst res = packer.pack(data);\n\tif (res instanceof Promise) {\n\t\treturn res.then(() => packer.getBuffer());\n\t}\n\treturn packer.getBuffer();\n}\n\nclass Unpacker {\n\tprivate index: number;\n\tprivate readonly dataBuffer: ArrayBuffer;\n\tprivate readonly dataView: Uint8Array;\n\tprivate readonly length: number;\n\n\tconstructor(data: ArrayBuffer) {\n\t\tthis.index = 0;\n\t\tthis.dataBuffer = data;\n\t\tthis.dataView = new Uint8Array(this.dataBuffer);\n\t\tthis.length = this.dataBuffer.byteLength;\n\t}\n\n\tunpack(): Unpackable {\n\t\tconst type = this.unpack_uint8();\n\t\tif (type < 0x80) {\n\t\t\treturn type;\n\t\t} else if ((type ^ 0xe0) < 0x20) {\n\t\t\treturn (type ^ 0xe0) - 0x20;\n\t\t}\n\n\t\tlet size;\n\t\tif ((size = type ^ 0xa0) <= 0x0f) {\n\t\t\treturn this.unpack_raw(size);\n\t\t} else if ((size = type ^ 0xb0) <= 0x0f) {\n\t\t\treturn this.unpack_string(size);\n\t\t} else if ((size = type ^ 0x90) <= 0x0f) {\n\t\t\treturn this.unpack_array(size);\n\t\t} else if ((size = type ^ 0x80) <= 0x0f) {\n\t\t\treturn this.unpack_map(size);\n\t\t}\n\n\t\tswitch (type) {\n\t\t\tcase 0xc0:\n\t\t\t\treturn null;\n\t\t\tcase 0xc1:\n\t\t\t\treturn undefined;\n\t\t\tcase 0xc2:\n\t\t\t\treturn false;\n\t\t\tcase 0xc3:\n\t\t\t\treturn true;\n\t\t\tcase 0xca:\n\t\t\t\treturn this.unpack_float();\n\t\t\tcase 0xcb:\n\t\t\t\treturn this.unpack_double();\n\t\t\tcase 0xcc:\n\t\t\t\treturn this.unpack_uint8();\n\t\t\tcase 0xcd:\n\t\t\t\treturn this.unpack_uint16();\n\t\t\tcase 0xce:\n\t\t\t\treturn this.unpack_uint32();\n\t\t\tcase 0xcf:\n\t\t\t\treturn this.unpack_uint64();\n\t\t\tcase 0xd0:\n\t\t\t\treturn this.unpack_int8();\n\t\t\tcase 0xd1:\n\t\t\t\treturn this.unpack_int16();\n\t\t\tcase 0xd2:\n\t\t\t\treturn this.unpack_int32();\n\t\t\tcase 0xd3:\n\t\t\t\treturn this.unpack_int64();\n\t\t\tcase 0xd4:\n\t\t\t\treturn undefined;\n\t\t\tcase 0xd5:\n\t\t\t\treturn undefined;\n\t\t\tcase 0xd6:\n\t\t\t\treturn undefined;\n\t\t\tcase 0xd7:\n\t\t\t\treturn undefined;\n\t\t\tcase 0xd8:\n\t\t\t\tsize = this.unpack_uint16();\n\t\t\t\treturn this.unpack_string(size);\n\t\t\tcase 0xd9:\n\t\t\t\tsize = this.unpack_uint32();\n\t\t\t\treturn this.unpack_string(size);\n\t\t\tcase 0xda:\n\t\t\t\tsize = this.unpack_uint16();\n\t\t\t\treturn this.unpack_raw(size);\n\t\t\tcase 0xdb:\n\t\t\t\tsize = this.unpack_uint32();\n\t\t\t\treturn this.unpack_raw(size);\n\t\t\tcase 0xdc:\n\t\t\t\tsize = this.unpack_uint16();\n\t\t\t\treturn this.unpack_array(size);\n\t\t\tcase 0xdd:\n\t\t\t\tsize = this.unpack_uint32();\n\t\t\t\treturn this.unpack_array(size);\n\t\t\tcase 0xde:\n\t\t\t\tsize = this.unpack_uint16();\n\t\t\t\treturn this.unpack_map(size);\n\t\t\tcase 0xdf:\n\t\t\t\tsize = this.unpack_uint32();\n\t\t\t\treturn this.unpack_map(size);\n\t\t}\n\t}\n\n\tunpack_uint8() {\n\t\tconst byte = this.dataView[this.index] & 0xff;\n\t\tthis.index++;\n\t\treturn byte;\n\t}\n\n\tunpack_uint16() {\n\t\tconst bytes = this.read(2);\n\t\tconst uint16 = (bytes[0] & 0xff) * 256 + (bytes[1] & 0xff);\n\t\tthis.index += 2;\n\t\treturn uint16;\n\t}\n\n\tunpack_uint32() {\n\t\tconst bytes = this.read(4);\n\t\tconst uint32 =\n\t\t\t((bytes[0] * 256 + bytes[1]) * 256 + bytes[2]) * 256 + bytes[3];\n\t\tthis.index += 4;\n\t\treturn uint32;\n\t}\n\n\tunpack_uint64() {\n\t\tconst bytes = this.read(8);\n\t\tconst uint64 =\n\t\t\t((((((bytes[0] * 256 + bytes[1]) * 256 + bytes[2]) * 256 + bytes[3]) *\n\t\t\t\t256 +\n\t\t\t\tbytes[4]) *\n\t\t\t\t256 +\n\t\t\t\tbytes[5]) *\n\t\t\t\t256 +\n\t\t\t\tbytes[6]) *\n\t\t\t\t256 +\n\t\t\tbytes[7];\n\t\tthis.index += 8;\n\t\treturn uint64;\n\t}\n\n\tunpack_int8() {\n\t\tconst uint8 = this.unpack_uint8();\n\t\treturn uint8 < 0x80 ? uint8 : uint8 - (1 << 8);\n\t}\n\n\tunpack_int16() {\n\t\tconst uint16 = this.unpack_uint16();\n\t\treturn uint16 < 0x8000 ? uint16 : uint16 - (1 << 16);\n\t}\n\n\tunpack_int32() {\n\t\tconst uint32 = this.unpack_uint32();\n\t\treturn uint32 < 2 ** 31 ? uint32 : uint32 - 2 ** 32;\n\t}\n\n\tunpack_int64() {\n\t\tconst uint64 = this.unpack_uint64();\n\t\treturn uint64 < 2 ** 63 ? uint64 : uint64 - 2 ** 64;\n\t}\n\n\tunpack_raw(size: number) {\n\t\tif (this.length < this.index + size) {\n\t\t\tthrow new Error(\n\t\t\t\t`BinaryPackFailure: index is out of range ${this.index} ${size} ${this.length}`,\n\t\t\t);\n\t\t}\n\t\tconst buf = this.dataBuffer.slice(this.index, this.index + size);\n\t\tthis.index += size;\n\n\t\treturn buf;\n\t}\n\n\tunpack_string(size: number) {\n\t\tconst bytes = this.read(size);\n\t\tlet i = 0;\n\t\tlet str = \"\";\n\t\tlet c;\n\t\tlet code;\n\n\t\twhile (i < size) {\n\t\t\tc = bytes[i];\n\t\t\t// The length of a UTF-8 sequence is specified in the first byte:\n\t\t\t// 0xxxxxxx means length 1,\n\t\t\t// 110xxxxx means length 2,\n\t\t\t// 1110xxxx means length 3,\n\t\t\t// 11110xxx means length 4.\n\t\t\t// 10xxxxxx is for non-initial bytes.\n\t\t\tif (c < 0xa0) {\n\t\t\t\t// One-byte sequence: bits 0xxxxxxx\n\t\t\t\tcode = c;\n\t\t\t\ti++;\n\t\t\t} else if ((c ^ 0xc0) < 0x20) {\n\t\t\t\t// Two-byte sequence: bits 110xxxxx 10xxxxxx\n\t\t\t\tcode = ((c & 0x1f) << 6) | (bytes[i + 1] & 0x3f);\n\t\t\t\ti += 2;\n\t\t\t} else if ((c ^ 0xe0) < 0x10) {\n\t\t\t\t// Three-byte sequence: bits 1110xxxx 10xxxxxx 10xxxxxx\n\t\t\t\tcode =\n\t\t\t\t\t((c & 0x0f) << 12) |\n\t\t\t\t\t((bytes[i + 1] & 0x3f) << 6) |\n\t\t\t\t\t(bytes[i + 2] & 0x3f);\n\t\t\t\ti += 3;\n\t\t\t} else {\n\t\t\t\t// Four-byte sequence: bits 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx\n\t\t\t\tcode =\n\t\t\t\t\t((c & 0x07) << 18) |\n\t\t\t\t\t((bytes[i + 1] & 0x3f) << 12) |\n\t\t\t\t\t((bytes[i + 2] & 0x3f) << 6) |\n\t\t\t\t\t(bytes[i + 3] & 0x3f);\n\t\t\t\ti += 4;\n\t\t\t}\n\t\t\tstr += String.fromCodePoint(code);\n\t\t}\n\n\t\tthis.index += size;\n\t\treturn str;\n\t}\n\n\tunpack_array(size: number) {\n\t\tconst objects = new Array<Unpackable>(size);\n\t\tfor (let i = 0; i < size; i++) {\n\t\t\tobjects[i] = this.unpack();\n\t\t}\n\t\treturn objects;\n\t}\n\n\tunpack_map(size: number) {\n\t\tconst map: { [key: string]: Unpackable } = {};\n\t\tfor (let i = 0; i < size; i++) {\n\t\t\tconst key = this.unpack() as string;\n\t\t\tmap[key] = this.unpack();\n\t\t}\n\t\treturn map;\n\t}\n\n\tunpack_float() {\n\t\tconst uint32 = this.unpack_uint32();\n\t\tconst sign = uint32 >> 31;\n\t\tconst exp = ((uint32 >> 23) & 0xff) - 127;\n\t\tconst fraction = (uint32 & 0x7fffff) | 0x800000;\n\t\treturn (sign === 0 ? 1 : -1) * fraction * 2 ** (exp - 23);\n\t}\n\n\tunpack_double() {\n\t\tconst h32 = this.unpack_uint32();\n\t\tconst l32 = this.unpack_uint32();\n\t\tconst sign = h32 >> 31;\n\t\tconst exp = ((h32 >> 20) & 0x7ff) - 1023;\n\t\tconst hfrac = (h32 & 0xfffff) | 0x100000;\n\t\tconst frac = hfrac * 2 ** (exp - 20) + l32 * 2 ** (exp - 52);\n\t\treturn (sign === 0 ? 1 : -1) * frac;\n\t}\n\n\tread(length: number) {\n\t\tconst j = this.index;\n\t\tif (j + length <= this.length) {\n\t\t\treturn this.dataView.subarray(j, j + length);\n\t\t} else {\n\t\t\tthrow new Error(\"BinaryPackFailure: read index out of range\");\n\t\t}\n\t}\n}\n\nexport class Packer {\n\tprivate _bufferBuilder = new BufferBuilder();\n\tprivate _textEncoder = new TextEncoder();\n\n\tgetBuffer() {\n\t\treturn this._bufferBuilder.toArrayBuffer();\n\t}\n\n\tpack(value: Packable) {\n\t\tif (typeof value === \"string\") {\n\t\t\tthis.pack_string(value);\n\t\t} else if (typeof value === \"number\") {\n\t\t\tif (Math.floor(value) === value) {\n\t\t\t\tthis.pack_integer(value);\n\t\t\t} else {\n\t\t\t\tthis.pack_double(value);\n\t\t\t}\n\t\t} else if (typeof value === \"boolean\") {\n\t\t\tif (value === true) {\n\t\t\t\tthis._bufferBuilder.append(0xc3);\n\t\t\t} else if (value === false) {\n\t\t\t\tthis._bufferBuilder.append(0xc2);\n\t\t\t}\n\t\t} else if (value === undefined) {\n\t\t\tthis._bufferBuilder.append(0xc0);\n\t\t} else if (typeof value === \"object\") {\n\t\t\tif (value === null) {\n\t\t\t\tthis._bufferBuilder.append(0xc0);\n\t\t\t} else {\n\t\t\t\tconst constructor = value.constructor;\n\t\t\t\tif (value instanceof Array) {\n\t\t\t\t\tconst res = this.pack_array(value);\n\t\t\t\t\tif (res instanceof Promise) {\n\t\t\t\t\t\treturn res.then(() => this._bufferBuilder.flush());\n\t\t\t\t\t}\n\t\t\t\t} else if (value instanceof ArrayBuffer) {\n\t\t\t\t\tthis.pack_bin(new Uint8Array(value));\n\t\t\t\t} else if (\"BYTES_PER_ELEMENT\" in value) {\n\t\t\t\t\tconst v = value as unknown as DataView;\n\t\t\t\t\tthis.pack_bin(new Uint8Array(v.buffer, v.byteOffset, v.byteLength));\n\t\t\t\t} else if (value instanceof Date) {\n\t\t\t\t\tthis.pack_string(value.toString());\n\t\t\t\t} else if (value instanceof Blob) {\n\t\t\t\t\treturn value.arrayBuffer().then((buffer) => {\n\t\t\t\t\t\tthis.pack_bin(new Uint8Array(buffer));\n\t\t\t\t\t\tthis._bufferBuilder.flush();\n\t\t\t\t\t});\n\t\t\t\t\t// this.pack_bin(new Uint8Array(await value.arrayBuffer()));\n\t\t\t\t} else if (\n\t\t\t\t\tconstructor == Object ||\n\t\t\t\t\tconstructor.toString().startsWith(\"class\")\n\t\t\t\t) {\n\t\t\t\t\tconst res = this.pack_object(value);\n\t\t\t\t\tif (res instanceof Promise) {\n\t\t\t\t\t\treturn res.then(() => this._bufferBuilder.flush());\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(`Type \"${constructor.toString()}\" not yet supported`);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthrow new Error(`Type \"${typeof value}\" not yet supported`);\n\t\t}\n\t\tthis._bufferBuilder.flush();\n\t}\n\n\tpack_bin(blob: Uint8Array) {\n\t\tconst length = blob.length;\n\n\t\tif (length <= 0x0f) {\n\t\t\tthis.pack_uint8(0xa0 + length);\n\t\t} else if (length <= 0xffff) {\n\t\t\tthis._bufferBuilder.append(0xda);\n\t\t\tthis.pack_uint16(length);\n\t\t} else if (length <= 0xffffffff) {\n\t\t\tthis._bufferBuilder.append(0xdb);\n\t\t\tthis.pack_uint32(length);\n\t\t} else {\n\t\t\tthrow new Error(\"Invalid length\");\n\t\t}\n\t\tthis._bufferBuilder.append_buffer(blob);\n\t}\n\n\tpack_string(str: string) {\n\t\tconst encoded = this._textEncoder.encode(str);\n\t\tconst length = encoded.length;\n\n\t\tif (length <= 0x0f) {\n\t\t\tthis.pack_uint8(0xb0 + length);\n\t\t} else if (length <= 0xffff) {\n\t\t\tthis._bufferBuilder.append(0xd8);\n\t\t\tthis.pack_uint16(length);\n\t\t} else if (length <= 0xffffffff) {\n\t\t\tthis._bufferBuilder.append(0xd9);\n\t\t\tthis.pack_uint32(length);\n\t\t} else {\n\t\t\tthrow new Error(\"Invalid length\");\n\t\t}\n\t\tthis._bufferBuilder.append_buffer(encoded);\n\t}\n\n\tpack_array(ary: Packable[]) {\n\t\tconst length = ary.length;\n\t\tif (length <= 0x0f) {\n\t\t\tthis.pack_uint8(0x90 + length);\n\t\t} else if (length <= 0xffff) {\n\t\t\tthis._bufferBuilder.append(0xdc);\n\t\t\tthis.pack_uint16(length);\n\t\t} else if (length <= 0xffffffff) {\n\t\t\tthis._bufferBuilder.append(0xdd);\n\t\t\tthis.pack_uint32(length);\n\t\t} else {\n\t\t\tthrow new Error(\"Invalid length\");\n\t\t}\n\n\t\tconst packNext = (index: number): Promise<void> | void => {\n\t\t\tif (index < length) {\n\t\t\t\tconst res = this.pack(ary[index]);\n\t\t\t\tif (res instanceof Promise) {\n\t\t\t\t\treturn res.then(() => packNext(index + 1));\n\t\t\t\t}\n\t\t\t\treturn packNext(index + 1);\n\t\t\t}\n\t\t};\n\n\t\treturn packNext(0);\n\t}\n\n\tpack_integer(num: number) {\n\t\tif (num >= -0x20 && num <= 0x7f) {\n\t\t\tthis._bufferBuilder.append(num & 0xff);\n\t\t} else if (num >= 0x00 && num <= 0xff) {\n\t\t\tthis._bufferBuilder.append(0xcc);\n\t\t\tthis.pack_uint8(num);\n\t\t} else if (num >= -0x80 && num <= 0x7f) {\n\t\t\tthis._bufferBuilder.append(0xd0);\n\t\t\tthis.pack_int8(num);\n\t\t} else if (num >= 0x0000 && num <= 0xffff) {\n\t\t\tthis._bufferBuilder.append(0xcd);\n\t\t\tthis.pack_uint16(num);\n\t\t} else if (num >= -0x8000 && num <= 0x7fff) {\n\t\t\tthis._bufferBuilder.append(0xd1);\n\t\t\tthis.pack_int16(num);\n\t\t} else if (num >= 0x00000000 && num <= 0xffffffff) {\n\t\t\tthis._bufferBuilder.append(0xce);\n\t\t\tthis.pack_uint32(num);\n\t\t} else if (num >= -0x80000000 && num <= 0x7fffffff) {\n\t\t\tthis._bufferBuilder.append(0xd2);\n\t\t\tthis.pack_int32(num);\n\t\t} else if (num >= -0x8000000000000000 && num <= 0x7fffffffffffffff) {\n\t\t\tthis._bufferBuilder.append(0xd3);\n\t\t\tthis.pack_int64(num);\n\t\t} else if (num >= 0x0000000000000000 && num <= 0xffffffffffffffff) {\n\t\t\tthis._bufferBuilder.append(0xcf);\n\t\t\tthis.pack_uint64(num);\n\t\t} else {\n\t\t\tthrow new Error(\"Invalid integer\");\n\t\t}\n\t}\n\n\tpack_double(num: number) {\n\t\tlet sign = 0;\n\t\tif (num < 0) {\n\t\t\tsign = 1;\n\t\t\tnum = -num;\n\t\t}\n\t\tconst exp = Math.floor(Math.log(num) / Math.LN2);\n\t\tconst frac0 = num / 2 ** exp - 1;\n\t\tconst frac1 = Math.floor(frac0 * 2 ** 52);\n\t\tconst b32 = 2 ** 32;\n\t\tconst h32 =\n\t\t\t(sign << 31) | ((exp + 1023) << 20) | ((frac1 / b32) & 0x0fffff);\n\t\tconst l32 = frac1 % b32;\n\t\tthis._bufferBuilder.append(0xcb);\n\t\tthis.pack_int32(h32);\n\t\tthis.pack_int32(l32);\n\t}\n\n\tpack_object(obj: { [key: string]: Packable }) {\n\t\tconst keys = Object.keys(obj);\n\t\tconst length = keys.length;\n\t\tif (length <= 0x0f) {\n\t\t\tthis.pack_uint8(0x80 + length);\n\t\t} else if (length <= 0xffff) {\n\t\t\tthis._bufferBuilder.append(0xde);\n\t\t\tthis.pack_uint16(length);\n\t\t} else if (length <= 0xffffffff) {\n\t\t\tthis._bufferBuilder.append(0xdf);\n\t\t\tthis.pack_uint32(length);\n\t\t} else {\n\t\t\tthrow new Error(\"Invalid length\");\n\t\t}\n\n\t\tconst packNext = (index: number): Promise<void> | void => {\n\t\t\tif (index < keys.length) {\n\t\t\t\tconst prop = keys[index];\n\t\t\t\t// eslint-disable-next-line no-prototype-builtins\n\t\t\t\tif (obj.hasOwnProperty(prop)) {\n\t\t\t\t\tthis.pack(prop);\n\t\t\t\t\tconst res = this.pack(obj[prop]);\n\t\t\t\t\tif (res instanceof Promise) {\n\t\t\t\t\t\treturn res.then(() => packNext(index + 1));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn packNext(index + 1);\n\t\t\t}\n\t\t};\n\n\t\treturn packNext(0);\n\t}\n\n\tpack_uint8(num: number) {\n\t\tthis._bufferBuilder.append(num);\n\t}\n\n\tpack_uint16(num: number) {\n\t\tthis._bufferBuilder.append(num >> 8);\n\t\tthis._bufferBuilder.append(num & 0xff);\n\t}\n\n\tpack_uint32(num: number) {\n\t\tconst n = num & 0xffffffff;\n\t\tthis._bufferBuilder.append((n & 0xff000000) >>> 24);\n\t\tthis._bufferBuilder.append((n & 0x00ff0000) >>> 16);\n\t\tthis._bufferBuilder.append((n & 0x0000ff00) >>> 8);\n\t\tthis._bufferBuilder.append(n & 0x000000ff);\n\t}\n\n\tpack_uint64(num: number) {\n\t\tconst high = num / 2 ** 32;\n\t\tconst low = num % 2 ** 32;\n\t\tthis._bufferBuilder.append((high & 0xff000000) >>> 24);\n\t\tthis._bufferBuilder.append((high & 0x00ff0000) >>> 16);\n\t\tthis._bufferBuilder.append((high & 0x0000ff00) >>> 8);\n\t\tthis._bufferBuilder.append(high & 0x000000ff);\n\t\tthis._bufferBuilder.append((low & 0xff000000) >>> 24);\n\t\tthis._bufferBuilder.append((low & 0x00ff0000) >>> 16);\n\t\tthis._bufferBuilder.append((low & 0x0000ff00) >>> 8);\n\t\tthis._bufferBuilder.append(low & 0x000000ff);\n\t}\n\n\tpack_int8(num: number) {\n\t\tthis._bufferBuilder.append(num & 0xff);\n\t}\n\n\tpack_int16(num: number) {\n\t\tthis._bufferBuilder.append((num & 0xff00) >> 8);\n\t\tthis._bufferBuilder.append(num & 0xff);\n\t}\n\n\tpack_int32(num: number) {\n\t\tthis._bufferBuilder.append((num >>> 24) & 0xff);\n\t\tthis._bufferBuilder.append((num & 0x00ff0000) >>> 16);\n\t\tthis._bufferBuilder.append((num & 0x0000ff00) >>> 8);\n\t\tthis._bufferBuilder.append(num & 0x000000ff);\n\t}\n\n\tpack_int64(num: number) {\n\t\tconst high = Math.floor(num / 2 ** 32);\n\t\tconst low = num % 2 ** 32;\n\t\tthis._bufferBuilder.append((high & 0xff000000) >>> 24);\n\t\tthis._bufferBuilder.append((high & 0x00ff0000) >>> 16);\n\t\tthis._bufferBuilder.append((high & 0x0000ff00) >>> 8);\n\t\tthis._bufferBuilder.append(high & 0x000000ff);\n\t\tthis._bufferBuilder.append((low & 0xff000000) >>> 24);\n\t\tthis._bufferBuilder.append((low & 0x00ff0000) >>> 16);\n\t\tthis._bufferBuilder.append((low & 0x0000ff00) >>> 8);\n\t\tthis._bufferBuilder.append(low & 0x000000ff);\n\t}\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nlet logDisabled_ = true;\nlet deprecationWarnings_ = true;\n\n/**\n * Extract browser version out of the provided user agent string.\n *\n * @param {!string} uastring userAgent string.\n * @param {!string} expr Regular expression used as match criteria.\n * @param {!number} pos position in the version string to be returned.\n * @return {!number} browser version.\n */\nexport function extractVersion(uastring, expr, pos) {\n  const match = uastring.match(expr);\n  return match && match.length >= pos && parseInt(match[pos], 10);\n}\n\n// Wraps the peerconnection event eventNameToWrap in a function\n// which returns the modified event object (or false to prevent\n// the event).\nexport function wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  const nativeAddEventListener = proto.addEventListener;\n  proto.addEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap) {\n      return nativeAddEventListener.apply(this, arguments);\n    }\n    const wrappedCallback = (e) => {\n      const modifiedEvent = wrapper(e);\n      if (modifiedEvent) {\n        if (cb.handleEvent) {\n          cb.handleEvent(modifiedEvent);\n        } else {\n          cb(modifiedEvent);\n        }\n      }\n    };\n    this._eventMap = this._eventMap || {};\n    if (!this._eventMap[eventNameToWrap]) {\n      this._eventMap[eventNameToWrap] = new Map();\n    }\n    this._eventMap[eventNameToWrap].set(cb, wrappedCallback);\n    return nativeAddEventListener.apply(this, [nativeEventName,\n      wrappedCallback]);\n  };\n\n  const nativeRemoveEventListener = proto.removeEventListener;\n  proto.removeEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap || !this._eventMap\n        || !this._eventMap[eventNameToWrap]) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    if (!this._eventMap[eventNameToWrap].has(cb)) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    const unwrappedCb = this._eventMap[eventNameToWrap].get(cb);\n    this._eventMap[eventNameToWrap].delete(cb);\n    if (this._eventMap[eventNameToWrap].size === 0) {\n      delete this._eventMap[eventNameToWrap];\n    }\n    if (Object.keys(this._eventMap).length === 0) {\n      delete this._eventMap;\n    }\n    return nativeRemoveEventListener.apply(this, [nativeEventName,\n      unwrappedCb]);\n  };\n\n  Object.defineProperty(proto, 'on' + eventNameToWrap, {\n    get() {\n      return this['_on' + eventNameToWrap];\n    },\n    set(cb) {\n      if (this['_on' + eventNameToWrap]) {\n        this.removeEventListener(eventNameToWrap,\n          this['_on' + eventNameToWrap]);\n        delete this['_on' + eventNameToWrap];\n      }\n      if (cb) {\n        this.addEventListener(eventNameToWrap,\n          this['_on' + eventNameToWrap] = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n}\n\nexport function disableLog(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  logDisabled_ = bool;\n  return (bool) ? 'adapter.js logging disabled' :\n    'adapter.js logging enabled';\n}\n\n/**\n * Disable or enable deprecation warnings\n * @param {!boolean} bool set to true to disable warnings.\n */\nexport function disableWarnings(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  deprecationWarnings_ = !bool;\n  return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\n}\n\nexport function log() {\n  if (typeof window === 'object') {\n    if (logDisabled_) {\n      return;\n    }\n    if (typeof console !== 'undefined' && typeof console.log === 'function') {\n      console.log.apply(console, arguments);\n    }\n  }\n}\n\n/**\n * Shows a deprecation warning suggesting the modern and spec-compatible API.\n */\nexport function deprecated(oldMethod, newMethod) {\n  if (!deprecationWarnings_) {\n    return;\n  }\n  console.warn(oldMethod + ' is deprecated, please use ' + newMethod +\n      ' instead.');\n}\n\n/**\n * Browser detector.\n *\n * @return {object} result containing browser and version\n *     properties.\n */\nexport function detectBrowser(window) {\n  // Returned result object.\n  const result = {browser: null, version: null};\n\n  // Fail early if it's not a browser\n  if (typeof window === 'undefined' || !window.navigator ||\n      !window.navigator.userAgent) {\n    result.browser = 'Not a browser.';\n    return result;\n  }\n\n  const {navigator} = window;\n\n  // Prefer navigator.userAgentData.\n  if (navigator.userAgentData && navigator.userAgentData.brands) {\n    const chromium = navigator.userAgentData.brands.find((brand) => {\n      return brand.brand === 'Chromium';\n    });\n    if (chromium) {\n      return {browser: 'chrome', version: parseInt(chromium.version, 10)};\n    }\n  }\n\n  if (navigator.mozGetUserMedia) { // Firefox.\n    result.browser = 'firefox';\n    result.version = extractVersion(navigator.userAgent,\n      /Firefox\\/(\\d+)\\./, 1);\n  } else if (navigator.webkitGetUserMedia ||\n      (window.isSecureContext === false && window.webkitRTCPeerConnection)) {\n    // Chrome, Chromium, Webview, Opera.\n    // Version matches Chrome/WebRTC version.\n    // Chrome 74 removed webkitGetUserMedia on http as well so we need the\n    // more complicated fallback to webkitRTCPeerConnection.\n    result.browser = 'chrome';\n    result.version = extractVersion(navigator.userAgent,\n      /Chrom(e|ium)\\/(\\d+)\\./, 2);\n  } else if (window.RTCPeerConnection &&\n      navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) { // Safari.\n    result.browser = 'safari';\n    result.version = extractVersion(navigator.userAgent,\n      /AppleWebKit\\/(\\d+)\\./, 1);\n    result.supportsUnifiedPlan = window.RTCRtpTransceiver &&\n        'currentDirection' in window.RTCRtpTransceiver.prototype;\n  } else { // Default fallthrough: not supported.\n    result.browser = 'Not a supported browser.';\n    return result;\n  }\n\n  return result;\n}\n\n/**\n * Checks if something is an object.\n *\n * @param {*} val The something you want to check.\n * @return true if val is an object, false otherwise.\n */\nfunction isObject(val) {\n  return Object.prototype.toString.call(val) === '[object Object]';\n}\n\n/**\n * Remove all empty objects and undefined values\n * from a nested object -- an enhanced and vanilla version\n * of Lodash's `compact`.\n */\nexport function compactObject(data) {\n  if (!isObject(data)) {\n    return data;\n  }\n\n  return Object.keys(data).reduce(function(accumulator, key) {\n    const isObj = isObject(data[key]);\n    const value = isObj ? compactObject(data[key]) : data[key];\n    const isEmptyObject = isObj && !Object.keys(value).length;\n    if (value === undefined || isEmptyObject) {\n      return accumulator;\n    }\n    return Object.assign(accumulator, {[key]: value});\n  }, {});\n}\n\n/* iterates the stats graph recursively. */\nexport function walkStats(stats, base, resultSet) {\n  if (!base || resultSet.has(base.id)) {\n    return;\n  }\n  resultSet.set(base.id, base);\n  Object.keys(base).forEach(name => {\n    if (name.endsWith('Id')) {\n      walkStats(stats, stats.get(base[name]), resultSet);\n    } else if (name.endsWith('Ids')) {\n      base[name].forEach(id => {\n        walkStats(stats, stats.get(id), resultSet);\n      });\n    }\n  });\n}\n\n/* filter getStats for a sender/receiver track. */\nexport function filterStats(result, track, outbound) {\n  const streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\n  const filteredResult = new Map();\n  if (track === null) {\n    return filteredResult;\n  }\n  const trackStats = [];\n  result.forEach(value => {\n    if (value.type === 'track' &&\n        value.trackIdentifier === track.id) {\n      trackStats.push(value);\n    }\n  });\n  trackStats.forEach(trackStat => {\n    result.forEach(stats => {\n      if (stats.type === streamStatsType && stats.trackId === trackStat.id) {\n        walkStats(result, stats, filteredResult);\n      }\n    });\n  });\n  return filteredResult;\n}\n\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\nconst logging = utils.log;\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n\n  if (!navigator.mediaDevices) {\n    return;\n  }\n\n  const constraintsToChrome_ = function(c) {\n    if (typeof c !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    const cc = {};\n    Object.keys(c).forEach(key => {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      const r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      const oldname_ = function(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return (name === 'deviceId') ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        let oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(mix => {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  const shimConstraints_ = function(constraints, func) {\n    if (browserDetails.version >= 61) {\n      return func(constraints);\n    }\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && typeof constraints.audio === 'object') {\n      const remap = function(obj, a, b) {\n        if (a in obj && !(b in obj)) {\n          obj[b] = obj[a];\n          delete obj[a];\n        }\n      };\n      constraints = JSON.parse(JSON.stringify(constraints));\n      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && typeof constraints.video === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      let face = constraints.video.facingMode;\n      face = face && ((typeof face === 'object') ? face : {ideal: face});\n      const getSupportedFacingModeLies = browserDetails.version < 66;\n\n      if ((face && (face.exact === 'user' || face.exact === 'environment' ||\n                    face.ideal === 'user' || face.ideal === 'environment')) &&\n          !(navigator.mediaDevices.getSupportedConstraints &&\n            navigator.mediaDevices.getSupportedConstraints().facingMode &&\n            !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        let matches;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices()\n            .then(devices => {\n              devices = devices.filter(d => d.kind === 'videoinput');\n              let dev = devices.find(d => matches.some(match =>\n                d.label.toLowerCase().includes(match)));\n              if (!dev && devices.length && matches.includes('back')) {\n                dev = devices[devices.length - 1]; // more likely the back cam\n              }\n              if (dev) {\n                constraints.video.deviceId = face.exact\n                  ? {exact: dev.deviceId}\n                  : {ideal: dev.deviceId};\n              }\n              constraints.video = constraintsToChrome_(constraints.video);\n              logging('chrome: ' + JSON.stringify(constraints));\n              return func(constraints);\n            });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  const shimError_ = function(e) {\n    if (browserDetails.version >= 64) {\n      return e;\n    }\n    return {\n      name: {\n        PermissionDeniedError: 'NotAllowedError',\n        PermissionDismissedError: 'NotAllowedError',\n        InvalidStateError: 'NotAllowedError',\n        DevicesNotFoundError: 'NotFoundError',\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        TrackStartError: 'NotReadableError',\n        MediaDeviceFailedDueToShutdown: 'NotAllowedError',\n        MediaDeviceKillSwitchOn: 'NotAllowedError',\n        TabCaptureError: 'AbortError',\n        ScreenCaptureError: 'AbortError',\n        DeviceCaptureError: 'AbortError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint || e.constraintName,\n      toString() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  const getUserMedia_ = function(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, c => {\n      navigator.webkitGetUserMedia(c, onSuccess, e => {\n        if (onError) {\n          onError(shimError_(e));\n        }\n      });\n    });\n  };\n  navigator.getUserMedia = getUserMedia_.bind(navigator);\n\n  // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n  // function which returns a Promise, it does not accept spec-style\n  // constraints.\n  if (navigator.mediaDevices.getUserMedia) {\n    const origGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(cs) {\n      return shimConstraints_(cs, c => origGetUserMedia(c).then(stream => {\n        if (c.audio && !stream.getAudioTracks().length ||\n            c.video && !stream.getVideoTracks().length) {\n          stream.getTracks().forEach(track => {\n            track.stop();\n          });\n          throw new DOMException('', 'NotFoundError');\n        }\n        return stream;\n      }, e => Promise.reject(shimError_(e))));\n    };\n  }\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\n\nexport {shimGetUserMedia} from './getusermedia';\n\nexport function shimMediaStream(window) {\n  window.MediaStream = window.MediaStream || window.webkitMediaStream;\n}\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n      window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n      get() {\n        return this._ontrack;\n      },\n      set(f) {\n        if (this._ontrack) {\n          this.removeEventListener('track', this._ontrack);\n        }\n        this.addEventListener('track', this._ontrack = f);\n      },\n      enumerable: true,\n      configurable: true\n    });\n    const origSetRemoteDescription =\n        window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        if (!this._ontrackpoly) {\n          this._ontrackpoly = (e) => {\n            // onaddstream does not fire when a track is added to an existing\n            // stream. But stream.onaddtrack is implemented so we use that.\n            e.stream.addEventListener('addtrack', te => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === te.track.id);\n              } else {\n                receiver = {track: te.track};\n              }\n\n              const event = new Event('track');\n              event.track = te.track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n            e.stream.getTracks().forEach(track => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === track.id);\n              } else {\n                receiver = {track};\n              }\n              const event = new Event('track');\n              event.track = track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n          };\n          this.addEventListener('addstream', this._ontrackpoly);\n        }\n        return origSetRemoteDescription.apply(this, arguments);\n      };\n  } else {\n    // even if RTCRtpTransceiver is in window, it is only used and\n    // emitted in unified-plan. Unfortunately this means we need\n    // to unconditionally wrap the event.\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      if (!e.transceiver) {\n        Object.defineProperty(e, 'transceiver',\n          {value: {receiver: e.receiver}});\n      }\n      return e;\n    });\n  }\n}\n\nexport function shimGetSendersWithDtmf(window) {\n  // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n  if (typeof window === 'object' && window.RTCPeerConnection &&\n      !('getSenders' in window.RTCPeerConnection.prototype) &&\n      'createDTMFSender' in window.RTCPeerConnection.prototype) {\n    const shimSenderWithDtmf = function(pc, track) {\n      return {\n        track,\n        get dtmf() {\n          if (this._dtmf === undefined) {\n            if (track.kind === 'audio') {\n              this._dtmf = pc.createDTMFSender(track);\n            } else {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        },\n        _pc: pc\n      };\n    };\n\n    // augment addTrack when getSenders is not available.\n    if (!window.RTCPeerConnection.prototype.getSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        this._senders = this._senders || [];\n        return this._senders.slice(); // return a copy of the internal state.\n      };\n      const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addTrack =\n        function addTrack(track, stream) {\n          let sender = origAddTrack.apply(this, arguments);\n          if (!sender) {\n            sender = shimSenderWithDtmf(this, track);\n            this._senders.push(sender);\n          }\n          return sender;\n        };\n\n      const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n      window.RTCPeerConnection.prototype.removeTrack =\n        function removeTrack(sender) {\n          origRemoveTrack.apply(this, arguments);\n          const idx = this._senders.indexOf(sender);\n          if (idx !== -1) {\n            this._senders.splice(idx, 1);\n          }\n        };\n    }\n    const origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      this._senders = this._senders || [];\n      origAddStream.apply(this, [stream]);\n      stream.getTracks().forEach(track => {\n        this._senders.push(shimSenderWithDtmf(this, track));\n      });\n    };\n\n    const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        this._senders = this._senders || [];\n        origRemoveStream.apply(this, [stream]);\n\n        stream.getTracks().forEach(track => {\n          const sender = this._senders.find(s => s.track === track);\n          if (sender) { // remove sender\n            this._senders.splice(this._senders.indexOf(sender), 1);\n          }\n        });\n      };\n  } else if (typeof window === 'object' && window.RTCPeerConnection &&\n             'getSenders' in window.RTCPeerConnection.prototype &&\n             'createDTMFSender' in window.RTCPeerConnection.prototype &&\n             window.RTCRtpSender &&\n             !('dtmf' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = this._pc.createDTMFSender(this.track);\n          } else {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n}\n\nexport function shimSenderReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender && window.RTCRtpReceiver)) {\n    return;\n  }\n\n  // shim sender stats.\n  if (!('getStats' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    if (origGetSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        const senders = origGetSenders.apply(this, []);\n        senders.forEach(sender => sender._pc = this);\n        return senders;\n      };\n    }\n\n    const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    if (origAddTrack) {\n      window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n        const sender = origAddTrack.apply(this, arguments);\n        sender._pc = this;\n        return sender;\n      };\n    }\n    window.RTCRtpSender.prototype.getStats = function getStats() {\n      const sender = this;\n      return this._pc.getStats().then(result =>\n        /* Note: this will include stats of all senders that\n         *   send a track with the same id as sender.track as\n         *   it is not possible to identify the RTCRtpSender.\n         */\n        utils.filterStats(result, sender.track, true));\n    };\n  }\n\n  // shim receiver stats.\n  if (!('getStats' in window.RTCRtpReceiver.prototype)) {\n    const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n    if (origGetReceivers) {\n      window.RTCPeerConnection.prototype.getReceivers =\n        function getReceivers() {\n          const receivers = origGetReceivers.apply(this, []);\n          receivers.forEach(receiver => receiver._pc = this);\n          return receivers;\n        };\n    }\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      e.receiver._pc = e.srcElement;\n      return e;\n    });\n    window.RTCRtpReceiver.prototype.getStats = function getStats() {\n      const receiver = this;\n      return this._pc.getStats().then(result =>\n        utils.filterStats(result, receiver.track, false));\n    };\n  }\n\n  if (!('getStats' in window.RTCRtpSender.prototype &&\n      'getStats' in window.RTCRtpReceiver.prototype)) {\n    return;\n  }\n\n  // shim RTCPeerConnection.getStats(track).\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    if (arguments.length > 0 &&\n        arguments[0] instanceof window.MediaStreamTrack) {\n      const track = arguments[0];\n      let sender;\n      let receiver;\n      let err;\n      this.getSenders().forEach(s => {\n        if (s.track === track) {\n          if (sender) {\n            err = true;\n          } else {\n            sender = s;\n          }\n        }\n      });\n      this.getReceivers().forEach(r => {\n        if (r.track === track) {\n          if (receiver) {\n            err = true;\n          } else {\n            receiver = r;\n          }\n        }\n        return r.track === track;\n      });\n      if (err || (sender && receiver)) {\n        return Promise.reject(new DOMException(\n          'There are more than one sender or receiver for the track.',\n          'InvalidAccessError'));\n      } else if (sender) {\n        return sender.getStats();\n      } else if (receiver) {\n        return receiver.getStats();\n      }\n      return Promise.reject(new DOMException(\n        'There is no sender or receiver for the track.',\n        'InvalidAccessError'));\n    }\n    return origGetStats.apply(this, arguments);\n  };\n}\n\nexport function shimAddTrackRemoveTrackWithNative(window) {\n  // shim addTrack/removeTrack with native variants in order to make\n  // the interactions with legacy getLocalStreams behave as in other browsers.\n  // Keeps a mapping stream.id => [stream, rtpsenders...]\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      return Object.keys(this._shimmedLocalStreams)\n        .map(streamId => this._shimmedLocalStreams[streamId][0]);\n    };\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (!stream) {\n        return origAddTrack.apply(this, arguments);\n      }\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n      const sender = origAddTrack.apply(this, arguments);\n      if (!this._shimmedLocalStreams[stream.id]) {\n        this._shimmedLocalStreams[stream.id] = [stream, sender];\n      } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\n        this._shimmedLocalStreams[stream.id].push(sender);\n      }\n      return sender;\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n          'InvalidAccessError');\n      }\n    });\n    const existingSenders = this.getSenders();\n    origAddStream.apply(this, arguments);\n    const newSenders = this.getSenders()\n      .filter(newSender => existingSenders.indexOf(newSender) === -1);\n    this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      delete this._shimmedLocalStreams[stream.id];\n      return origRemoveStream.apply(this, arguments);\n    };\n\n  const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      if (sender) {\n        Object.keys(this._shimmedLocalStreams).forEach(streamId => {\n          const idx = this._shimmedLocalStreams[streamId].indexOf(sender);\n          if (idx !== -1) {\n            this._shimmedLocalStreams[streamId].splice(idx, 1);\n          }\n          if (this._shimmedLocalStreams[streamId].length === 1) {\n            delete this._shimmedLocalStreams[streamId];\n          }\n        });\n      }\n      return origRemoveTrack.apply(this, arguments);\n    };\n}\n\nexport function shimAddTrackRemoveTrack(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // shim addTrack and removeTrack.\n  if (window.RTCPeerConnection.prototype.addTrack &&\n      browserDetails.version >= 65) {\n    return shimAddTrackRemoveTrackWithNative(window);\n  }\n\n  // also shim pc.getLocalStreams when addTrack is shimmed\n  // to return the original streams.\n  const origGetLocalStreams = window.RTCPeerConnection.prototype\n    .getLocalStreams;\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      const nativeStreams = origGetLocalStreams.apply(this);\n      this._reverseStreams = this._reverseStreams || {};\n      return nativeStreams.map(stream => this._reverseStreams[stream.id]);\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n          'InvalidAccessError');\n      }\n    });\n    // Add identity mapping for consistency with addTrack.\n    // Unless this is being used with a stream from addTrack.\n    if (!this._reverseStreams[stream.id]) {\n      const newStream = new window.MediaStream(stream.getTracks());\n      this._streams[stream.id] = newStream;\n      this._reverseStreams[newStream.id] = stream;\n      stream = newStream;\n    }\n    origAddStream.apply(this, [stream]);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n\n      origRemoveStream.apply(this, [(this._streams[stream.id] || stream)]);\n      delete this._reverseStreams[(this._streams[stream.id] ?\n        this._streams[stream.id].id : stream.id)];\n      delete this._streams[stream.id];\n    };\n\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      const streams = [].slice.call(arguments, 1);\n      if (streams.length !== 1 ||\n          !streams[0].getTracks().find(t => t === track)) {\n        // this is not fully correct but all we can manage without\n        // [[associated MediaStreams]] internal slot.\n        throw new DOMException(\n          'The adapter.js addTrack polyfill only supports a single ' +\n          ' stream which is associated with the specified track.',\n          'NotSupportedError');\n      }\n\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n          'InvalidAccessError');\n      }\n\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n      const oldStream = this._streams[stream.id];\n      if (oldStream) {\n        // this is using odd Chrome behaviour, use with caution:\n        // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n        // Note: we rely on the high-level addTrack/dtmf shim to\n        // create the sender with a dtmf sender.\n        oldStream.addTrack(track);\n\n        // Trigger ONN async.\n        Promise.resolve().then(() => {\n          this.dispatchEvent(new Event('negotiationneeded'));\n        });\n      } else {\n        const newStream = new window.MediaStream([track]);\n        this._streams[stream.id] = newStream;\n        this._reverseStreams[newStream.id] = stream;\n        this.addStream(newStream);\n      }\n      return this.getSenders().find(s => s.track === track);\n    };\n\n  // replace the internal stream id with the external one and\n  // vice versa.\n  function replaceInternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(internalStream.id, 'g'),\n        externalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  function replaceExternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(externalStream.id, 'g'),\n        internalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  ['createOffer', 'createAnswer'].forEach(function(method) {\n    const nativeMethod = window.RTCPeerConnection.prototype[method];\n    const methodObj = {[method]() {\n      const args = arguments;\n      const isLegacyCall = arguments.length &&\n          typeof arguments[0] === 'function';\n      if (isLegacyCall) {\n        return nativeMethod.apply(this, [\n          (description) => {\n            const desc = replaceInternalStreamId(this, description);\n            args[0].apply(null, [desc]);\n          },\n          (err) => {\n            if (args[1]) {\n              args[1].apply(null, err);\n            }\n          }, arguments[2]\n        ]);\n      }\n      return nativeMethod.apply(this, arguments)\n        .then(description => replaceInternalStreamId(this, description));\n    }};\n    window.RTCPeerConnection.prototype[method] = methodObj[method];\n  });\n\n  const origSetLocalDescription =\n      window.RTCPeerConnection.prototype.setLocalDescription;\n  window.RTCPeerConnection.prototype.setLocalDescription =\n    function setLocalDescription() {\n      if (!arguments.length || !arguments[0].type) {\n        return origSetLocalDescription.apply(this, arguments);\n      }\n      arguments[0] = replaceExternalStreamId(this, arguments[0]);\n      return origSetLocalDescription.apply(this, arguments);\n    };\n\n  // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n  const origLocalDescription = Object.getOwnPropertyDescriptor(\n    window.RTCPeerConnection.prototype, 'localDescription');\n  Object.defineProperty(window.RTCPeerConnection.prototype,\n    'localDescription', {\n      get() {\n        const description = origLocalDescription.get.apply(this);\n        if (description.type === '') {\n          return description;\n        }\n        return replaceInternalStreamId(this, description);\n      }\n    });\n\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      // We can not yet check for sender instanceof RTCRtpSender\n      // since we shim RTPSender. So we check if sender._pc is set.\n      if (!sender._pc) {\n        throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' +\n            'does not implement interface RTCRtpSender.', 'TypeError');\n      }\n      const isLocal = sender._pc === this;\n      if (!isLocal) {\n        throw new DOMException('Sender was not created by this connection.',\n          'InvalidAccessError');\n      }\n\n      // Search for the native stream the senders track belongs to.\n      this._streams = this._streams || {};\n      let stream;\n      Object.keys(this._streams).forEach(streamid => {\n        const hasTrack = this._streams[streamid].getTracks()\n          .find(track => sender.track === track);\n        if (hasTrack) {\n          stream = this._streams[streamid];\n        }\n      });\n\n      if (stream) {\n        if (stream.getTracks().length === 1) {\n          // if this is the last track of the stream, remove the stream. This\n          // takes care of any shimmed _senders.\n          this.removeStream(this._reverseStreams[stream.id]);\n        } else {\n          // relying on the same odd chrome behaviour as above.\n          stream.removeTrack(sender.track);\n        }\n        this.dispatchEvent(new Event('negotiationneeded'));\n      }\n    };\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.webkitRTCPeerConnection;\n  }\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n  if (browserDetails.version < 53) {\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n      .forEach(function(method) {\n        const nativeMethod = window.RTCPeerConnection.prototype[method];\n        const methodObj = {[method]() {\n          arguments[0] = new ((method === 'addIceCandidate') ?\n            window.RTCIceCandidate :\n            window.RTCSessionDescription)(arguments[0]);\n          return nativeMethod.apply(this, arguments);\n        }};\n        window.RTCPeerConnection.prototype[method] = methodObj[method];\n      });\n  }\n}\n\n// Attempt to fix ONN in plan-b mode.\nexport function fixNegotiationNeeded(window, browserDetails) {\n  utils.wrapPeerConnectionEvent(window, 'negotiationneeded', e => {\n    const pc = e.target;\n    if (browserDetails.version < 72 || (pc.getConfiguration &&\n        pc.getConfiguration().sdpSemantics === 'plan-b')) {\n      if (pc.signalingState !== 'stable') {\n        return;\n      }\n    }\n    return e;\n  });\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n  const MediaStreamTrack = window && window.MediaStreamTrack;\n\n  navigator.getUserMedia = function(constraints, onSuccess, onError) {\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    utils.deprecated('navigator.getUserMedia',\n      'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n\n  if (!(browserDetails.version > 55 &&\n      'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n    const remap = function(obj, a, b) {\n      if (a in obj && !(b in obj)) {\n        obj[b] = obj[a];\n        delete obj[a];\n      }\n    };\n\n    const nativeGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      if (typeof c === 'object' && typeof c.audio === 'object') {\n        c = JSON.parse(JSON.stringify(c));\n        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n      }\n      return nativeGetUserMedia(c);\n    };\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n      const nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n      MediaStreamTrack.prototype.getSettings = function() {\n        const obj = nativeGetSettings.apply(this, arguments);\n        remap(obj, 'mozAutoGainControl', 'autoGainControl');\n        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n        return obj;\n      };\n    }\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n      const nativeApplyConstraints =\n        MediaStreamTrack.prototype.applyConstraints;\n      MediaStreamTrack.prototype.applyConstraints = function(c) {\n        if (this.kind === 'audio' && typeof c === 'object') {\n          c = JSON.parse(JSON.stringify(c));\n          remap(c, 'autoGainControl', 'mozAutoGainControl');\n          remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n        }\n        return nativeApplyConstraints.apply(this, [c]);\n      };\n    }\n  }\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nexport function shimGetDisplayMedia(window, preferredMediaSource) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      if (!(constraints && constraints.video)) {\n        const err = new DOMException('getDisplayMedia without video ' +\n            'constraints is undefined');\n        err.name = 'NotFoundError';\n        // from https://heycam.github.io/webidl/#idl-DOMException-error-names\n        err.code = 8;\n        return Promise.reject(err);\n      }\n      if (constraints.video === true) {\n        constraints.video = {mediaSource: preferredMediaSource};\n      } else {\n        constraints.video.mediaSource = preferredMediaSource;\n      }\n      return window.navigator.mediaDevices.getUserMedia(constraints);\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      ('receiver' in window.RTCTrackEvent.prototype) &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (typeof window !== 'object' ||\n      !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\n    return; // probably media.peerconnection.enabled=false in about:config\n  }\n  if (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.mozRTCPeerConnection;\n  }\n\n  if (browserDetails.version < 53) {\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n      .forEach(function(method) {\n        const nativeMethod = window.RTCPeerConnection.prototype[method];\n        const methodObj = {[method]() {\n          arguments[0] = new ((method === 'addIceCandidate') ?\n            window.RTCIceCandidate :\n            window.RTCSessionDescription)(arguments[0]);\n          return nativeMethod.apply(this, arguments);\n        }};\n        window.RTCPeerConnection.prototype[method] = methodObj[method];\n      });\n  }\n\n  const modernStatsTypes = {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  };\n\n  const nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n    return nativeGetStats.apply(this, [selector || null])\n      .then(stats => {\n        if (browserDetails.version < 53 && !onSucc) {\n          // Shim only promise getStats with spec-hyphens in type names\n          // Leave callback version alone; misc old uses of forEach before Map\n          try {\n            stats.forEach(stat => {\n              stat.type = modernStatsTypes[stat.type] || stat.type;\n            });\n          } catch (e) {\n            if (e.name !== 'TypeError') {\n              throw e;\n            }\n            // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n            stats.forEach((stat, i) => {\n              stats.set(i, Object.assign({}, stat, {\n                type: modernStatsTypes[stat.type] || stat.type\n              }));\n            });\n          }\n        }\n        return stats;\n      })\n      .then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n    return;\n  }\n  const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n  if (origGetSenders) {\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n  }\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  if (origAddTrack) {\n    window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n      const sender = origAddTrack.apply(this, arguments);\n      sender._pc = this;\n      return sender;\n    };\n  }\n  window.RTCRtpSender.prototype.getStats = function getStats() {\n    return this.track ? this._pc.getStats(this.track) :\n      Promise.resolve(new Map());\n  };\n}\n\nexport function shimReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n    return;\n  }\n  const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n  if (origGetReceivers) {\n    window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n      const receivers = origGetReceivers.apply(this, []);\n      receivers.forEach(receiver => receiver._pc = this);\n      return receivers;\n    };\n  }\n  utils.wrapPeerConnectionEvent(window, 'track', e => {\n    e.receiver._pc = e.srcElement;\n    return e;\n  });\n  window.RTCRtpReceiver.prototype.getStats = function getStats() {\n    return this._pc.getStats(this.track);\n  };\n}\n\nexport function shimRemoveStream(window) {\n  if (!window.RTCPeerConnection ||\n      'removeStream' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      utils.deprecated('removeStream', 'removeTrack');\n      this.getSenders().forEach(sender => {\n        if (sender.track && stream.getTracks().includes(sender.track)) {\n          this.removeTrack(sender);\n        }\n      });\n    };\n}\n\nexport function shimRTCDataChannel(window) {\n  // rename DataChannel to RTCDataChannel (native fix in FF60):\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n  if (window.DataChannel && !window.RTCDataChannel) {\n    window.RTCDataChannel = window.DataChannel;\n  }\n}\n\nexport function shimAddTransceiver(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origAddTransceiver = window.RTCPeerConnection.prototype.addTransceiver;\n  if (origAddTransceiver) {\n    window.RTCPeerConnection.prototype.addTransceiver =\n      function addTransceiver() {\n        this.setParametersPromises = [];\n        // WebIDL input coercion and validation\n        let sendEncodings = arguments[1] && arguments[1].sendEncodings;\n        if (sendEncodings === undefined) {\n          sendEncodings = [];\n        }\n        sendEncodings = [...sendEncodings];\n        const shouldPerformCheck = sendEncodings.length > 0;\n        if (shouldPerformCheck) {\n          // If sendEncodings params are provided, validate grammar\n          sendEncodings.forEach((encodingParam) => {\n            if ('rid' in encodingParam) {\n              const ridRegex = /^[a-z0-9]{0,16}$/i;\n              if (!ridRegex.test(encodingParam.rid)) {\n                throw new TypeError('Invalid RID value provided.');\n              }\n            }\n            if ('scaleResolutionDownBy' in encodingParam) {\n              if (!(parseFloat(encodingParam.scaleResolutionDownBy) >= 1.0)) {\n                throw new RangeError('scale_resolution_down_by must be >= 1.0');\n              }\n            }\n            if ('maxFramerate' in encodingParam) {\n              if (!(parseFloat(encodingParam.maxFramerate) >= 0)) {\n                throw new RangeError('max_framerate must be >= 0.0');\n              }\n            }\n          });\n        }\n        const transceiver = origAddTransceiver.apply(this, arguments);\n        if (shouldPerformCheck) {\n          // Check if the init options were applied. If not we do this in an\n          // asynchronous way and save the promise reference in a global object.\n          // This is an ugly hack, but at the same time is way more robust than\n          // checking the sender parameters before and after the createOffer\n          // Also note that after the createoffer we are not 100% sure that\n          // the params were asynchronously applied so we might miss the\n          // opportunity to recreate offer.\n          const {sender} = transceiver;\n          const params = sender.getParameters();\n          if (!('encodings' in params) ||\n              // Avoid being fooled by patched getParameters() below.\n              (params.encodings.length === 1 &&\n               Object.keys(params.encodings[0]).length === 0)) {\n            params.encodings = sendEncodings;\n            sender.sendEncodings = sendEncodings;\n            this.setParametersPromises.push(sender.setParameters(params)\n              .then(() => {\n                delete sender.sendEncodings;\n              }).catch(() => {\n                delete sender.sendEncodings;\n              })\n            );\n          }\n        }\n        return transceiver;\n      };\n  }\n}\n\nexport function shimGetParameters(window) {\n  if (!(typeof window === 'object' && window.RTCRtpSender)) {\n    return;\n  }\n  const origGetParameters = window.RTCRtpSender.prototype.getParameters;\n  if (origGetParameters) {\n    window.RTCRtpSender.prototype.getParameters =\n      function getParameters() {\n        const params = origGetParameters.apply(this, arguments);\n        if (!('encodings' in params)) {\n          params.encodings = [].concat(this.sendEncodings || [{}]);\n        }\n        return params;\n      };\n  }\n}\n\nexport function shimCreateOffer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer = function createOffer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n        .then(() => {\n          return origCreateOffer.apply(this, arguments);\n        })\n        .finally(() => {\n          this.setParametersPromises = [];\n        });\n    }\n    return origCreateOffer.apply(this, arguments);\n  };\n}\n\nexport function shimCreateAnswer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateAnswer = window.RTCPeerConnection.prototype.createAnswer;\n  window.RTCPeerConnection.prototype.createAnswer = function createAnswer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n        .then(() => {\n          return origCreateAnswer.apply(this, arguments);\n        })\n        .finally(() => {\n          this.setParametersPromises = [];\n        });\n    }\n    return origCreateAnswer.apply(this, arguments);\n  };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\nimport * as utils from '../utils';\n\nexport function shimLocalStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getLocalStreams =\n      function getLocalStreams() {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        return this._localStreams;\n      };\n  }\n  if (!('addStream' in window.RTCPeerConnection.prototype)) {\n    const _addTrack = window.RTCPeerConnection.prototype.addTrack;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      if (!this._localStreams.includes(stream)) {\n        this._localStreams.push(stream);\n      }\n      // Try to emulate Chrome's behaviour of adding in audio-video order.\n      // Safari orders by track id.\n      stream.getAudioTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n      stream.getVideoTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n    };\n\n    window.RTCPeerConnection.prototype.addTrack =\n      function addTrack(track, ...streams) {\n        if (streams) {\n          streams.forEach((stream) => {\n            if (!this._localStreams) {\n              this._localStreams = [stream];\n            } else if (!this._localStreams.includes(stream)) {\n              this._localStreams.push(stream);\n            }\n          });\n        }\n        return _addTrack.apply(this, arguments);\n      };\n  }\n  if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        const index = this._localStreams.indexOf(stream);\n        if (index === -1) {\n          return;\n        }\n        this._localStreams.splice(index, 1);\n        const tracks = stream.getTracks();\n        this.getSenders().forEach(sender => {\n          if (tracks.includes(sender.track)) {\n            this.removeTrack(sender);\n          }\n        });\n      };\n  }\n}\n\nexport function shimRemoteStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getRemoteStreams =\n      function getRemoteStreams() {\n        return this._remoteStreams ? this._remoteStreams : [];\n      };\n  }\n  if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n      get() {\n        return this._onaddstream;\n      },\n      set(f) {\n        if (this._onaddstream) {\n          this.removeEventListener('addstream', this._onaddstream);\n          this.removeEventListener('track', this._onaddstreampoly);\n        }\n        this.addEventListener('addstream', this._onaddstream = f);\n        this.addEventListener('track', this._onaddstreampoly = (e) => {\n          e.streams.forEach(stream => {\n            if (!this._remoteStreams) {\n              this._remoteStreams = [];\n            }\n            if (this._remoteStreams.includes(stream)) {\n              return;\n            }\n            this._remoteStreams.push(stream);\n            const event = new Event('addstream');\n            event.stream = stream;\n            this.dispatchEvent(event);\n          });\n        });\n      }\n    });\n    const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        const pc = this;\n        if (!this._onaddstreampoly) {\n          this.addEventListener('track', this._onaddstreampoly = function(e) {\n            e.streams.forEach(stream => {\n              if (!pc._remoteStreams) {\n                pc._remoteStreams = [];\n              }\n              if (pc._remoteStreams.indexOf(stream) >= 0) {\n                return;\n              }\n              pc._remoteStreams.push(stream);\n              const event = new Event('addstream');\n              event.stream = stream;\n              pc.dispatchEvent(event);\n            });\n          });\n        }\n        return origSetRemoteDescription.apply(pc, arguments);\n      };\n  }\n}\n\nexport function shimCallbacksAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  const prototype = window.RTCPeerConnection.prototype;\n  const origCreateOffer = prototype.createOffer;\n  const origCreateAnswer = prototype.createAnswer;\n  const setLocalDescription = prototype.setLocalDescription;\n  const setRemoteDescription = prototype.setRemoteDescription;\n  const addIceCandidate = prototype.addIceCandidate;\n\n  prototype.createOffer =\n    function createOffer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateOffer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  prototype.createAnswer =\n    function createAnswer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateAnswer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  let withCallback = function(description, successCallback, failureCallback) {\n    const promise = setLocalDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setLocalDescription = withCallback;\n\n  withCallback = function(description, successCallback, failureCallback) {\n    const promise = setRemoteDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setRemoteDescription = withCallback;\n\n  withCallback = function(candidate, successCallback, failureCallback) {\n    const promise = addIceCandidate.apply(this, [candidate]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.addIceCandidate = withCallback;\n}\n\nexport function shimGetUserMedia(window) {\n  const navigator = window && window.navigator;\n\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    // shim not needed in Safari 12.1\n    const mediaDevices = navigator.mediaDevices;\n    const _getUserMedia = mediaDevices.getUserMedia.bind(mediaDevices);\n    navigator.mediaDevices.getUserMedia = (constraints) => {\n      return _getUserMedia(shimConstraints(constraints));\n    };\n  }\n\n  if (!navigator.getUserMedia && navigator.mediaDevices &&\n    navigator.mediaDevices.getUserMedia) {\n    navigator.getUserMedia = function getUserMedia(constraints, cb, errcb) {\n      navigator.mediaDevices.getUserMedia(constraints)\n        .then(cb, errcb);\n    }.bind(navigator);\n  }\n}\n\nexport function shimConstraints(constraints) {\n  if (constraints && constraints.video !== undefined) {\n    return Object.assign({},\n      constraints,\n      {video: utils.compactObject(constraints.video)}\n    );\n  }\n\n  return constraints;\n}\n\nexport function shimRTCIceServerUrls(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n  const OrigPeerConnection = window.RTCPeerConnection;\n  window.RTCPeerConnection =\n    function RTCPeerConnection(pcConfig, pcConstraints) {\n      if (pcConfig && pcConfig.iceServers) {\n        const newIceServers = [];\n        for (let i = 0; i < pcConfig.iceServers.length; i++) {\n          let server = pcConfig.iceServers[i];\n          if (server.urls === undefined && server.url) {\n            utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n            server = JSON.parse(JSON.stringify(server));\n            server.urls = server.url;\n            delete server.url;\n            newIceServers.push(server);\n          } else {\n            newIceServers.push(pcConfig.iceServers[i]);\n          }\n        }\n        pcConfig.iceServers = newIceServers;\n      }\n      return new OrigPeerConnection(pcConfig, pcConstraints);\n    };\n  window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n  // wrap static methods. Currently just generateCertificate.\n  if ('generateCertificate' in OrigPeerConnection) {\n    Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n      get() {\n        return OrigPeerConnection.generateCertificate;\n      }\n    });\n  }\n}\n\nexport function shimTrackEventTransceiver(window) {\n  // Add event.transceiver member over deprecated event.receiver\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      'receiver' in window.RTCTrackEvent.prototype &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimCreateOfferLegacy(window) {\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer =\n    function createOffer(offerOptions) {\n      if (offerOptions) {\n        if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveAudio =\n            !!offerOptions.offerToReceiveAudio;\n        }\n        const audioTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'audio');\n        if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n          if (audioTransceiver.direction === 'sendrecv') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('sendonly');\n            } else {\n              audioTransceiver.direction = 'sendonly';\n            }\n          } else if (audioTransceiver.direction === 'recvonly') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('inactive');\n            } else {\n              audioTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveAudio === true &&\n            !audioTransceiver) {\n          this.addTransceiver('audio', {direction: 'recvonly'});\n        }\n\n        if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveVideo =\n            !!offerOptions.offerToReceiveVideo;\n        }\n        const videoTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'video');\n        if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n          if (videoTransceiver.direction === 'sendrecv') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('sendonly');\n            } else {\n              videoTransceiver.direction = 'sendonly';\n            }\n          } else if (videoTransceiver.direction === 'recvonly') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('inactive');\n            } else {\n              videoTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveVideo === true &&\n            !videoTransceiver) {\n          this.addTransceiver('video', {direction: 'recvonly'});\n        }\n      }\n      return origCreateOffer.apply(this, arguments);\n    };\n}\n\nexport function shimAudioContext(window) {\n  if (typeof window !== 'object' || window.AudioContext) {\n    return;\n  }\n  window.AudioContext = window.webkitAudioContext;\n}\n\n","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport SDPUtils from 'sdp';\nimport * as utils from './utils';\n\nexport function shimRTCIceCandidate(window) {\n  // foundation is arbitrarily chosen as an indicator for full support for\n  // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n  if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'foundation' in\n      window.RTCIceCandidate.prototype)) {\n    return;\n  }\n\n  const NativeRTCIceCandidate = window.RTCIceCandidate;\n  window.RTCIceCandidate = function RTCIceCandidate(args) {\n    // Remove the a= which shouldn't be part of the candidate string.\n    if (typeof args === 'object' && args.candidate &&\n        args.candidate.indexOf('a=') === 0) {\n      args = JSON.parse(JSON.stringify(args));\n      args.candidate = args.candidate.substring(2);\n    }\n\n    if (args.candidate && args.candidate.length) {\n      // Augment the native candidate with the parsed fields.\n      const nativeCandidate = new NativeRTCIceCandidate(args);\n      const parsedCandidate = SDPUtils.parseCandidate(args.candidate);\n      for (const key in parsedCandidate) {\n        if (!(key in nativeCandidate)) {\n          Object.defineProperty(nativeCandidate, key,\n            {value: parsedCandidate[key]});\n        }\n      }\n\n      // Override serializer to not serialize the extra attributes.\n      nativeCandidate.toJSON = function toJSON() {\n        return {\n          candidate: nativeCandidate.candidate,\n          sdpMid: nativeCandidate.sdpMid,\n          sdpMLineIndex: nativeCandidate.sdpMLineIndex,\n          usernameFragment: nativeCandidate.usernameFragment,\n        };\n      };\n      return nativeCandidate;\n    }\n    return new NativeRTCIceCandidate(args);\n  };\n  window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', e => {\n    if (e.candidate) {\n      Object.defineProperty(e, 'candidate', {\n        value: new window.RTCIceCandidate(e.candidate),\n        writable: 'false'\n      });\n    }\n    return e;\n  });\n}\n\nexport function shimRTCIceCandidateRelayProtocol(window) {\n  if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'relayProtocol' in\n      window.RTCIceCandidate.prototype)) {\n    return;\n  }\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', e => {\n    if (e.candidate) {\n      const parsedCandidate = SDPUtils.parseCandidate(e.candidate.candidate);\n      if (parsedCandidate.type === 'relay') {\n        // This is a libwebrtc-specific mapping of local type preference\n        // to relayProtocol.\n        e.candidate.relayProtocol = {\n          0: 'tls',\n          1: 'tcp',\n          2: 'udp',\n        }[parsedCandidate.priority >> 24];\n      }\n    }\n    return e;\n  });\n}\n\nexport function shimMaxMessageSize(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  if (!('sctp' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\n      get() {\n        return typeof this._sctp === 'undefined' ? null : this._sctp;\n      }\n    });\n  }\n\n  const sctpInDescription = function(description) {\n    if (!description || !description.sdp) {\n      return false;\n    }\n    const sections = SDPUtils.splitSections(description.sdp);\n    sections.shift();\n    return sections.some(mediaSection => {\n      const mLine = SDPUtils.parseMLine(mediaSection);\n      return mLine && mLine.kind === 'application'\n          && mLine.protocol.indexOf('SCTP') !== -1;\n    });\n  };\n\n  const getRemoteFirefoxVersion = function(description) {\n    // TODO: Is there a better solution for detecting Firefox?\n    const match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\n    if (match === null || match.length < 2) {\n      return -1;\n    }\n    const version = parseInt(match[1], 10);\n    // Test for NaN (yes, this is ugly)\n    return version !== version ? -1 : version;\n  };\n\n  const getCanSendMaxMessageSize = function(remoteIsFirefox) {\n    // Every implementation we know can send at least 64 KiB.\n    // Note: Although Chrome is technically able to send up to 256 KiB, the\n    //       data does not reach the other peer reliably.\n    //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\n    let canSendMaxMessageSize = 65536;\n    if (browserDetails.browser === 'firefox') {\n      if (browserDetails.version < 57) {\n        if (remoteIsFirefox === -1) {\n          // FF < 57 will send in 16 KiB chunks using the deprecated PPID\n          // fragmentation.\n          canSendMaxMessageSize = 16384;\n        } else {\n          // However, other FF (and RAWRTC) can reassemble PPID-fragmented\n          // messages. Thus, supporting ~2 GiB when sending.\n          canSendMaxMessageSize = 2147483637;\n        }\n      } else if (browserDetails.version < 60) {\n        // Currently, all FF >= 57 will reset the remote maximum message size\n        // to the default value when a data channel is created at a later\n        // stage. :(\n        // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n        canSendMaxMessageSize =\n          browserDetails.version === 57 ? 65535 : 65536;\n      } else {\n        // FF >= 60 supports sending ~2 GiB\n        canSendMaxMessageSize = 2147483637;\n      }\n    }\n    return canSendMaxMessageSize;\n  };\n\n  const getMaxMessageSize = function(description, remoteIsFirefox) {\n    // Note: 65536 bytes is the default value from the SDP spec. Also,\n    //       every implementation we know supports receiving 65536 bytes.\n    let maxMessageSize = 65536;\n\n    // FF 57 has a slightly incorrect default remote max message size, so\n    // we need to adjust it here to avoid a failure when sending.\n    // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\n    if (browserDetails.browser === 'firefox'\n         && browserDetails.version === 57) {\n      maxMessageSize = 65535;\n    }\n\n    const match = SDPUtils.matchPrefix(description.sdp,\n      'a=max-message-size:');\n    if (match.length > 0) {\n      maxMessageSize = parseInt(match[0].substring(19), 10);\n    } else if (browserDetails.browser === 'firefox' &&\n                remoteIsFirefox !== -1) {\n      // If the maximum message size is not present in the remote SDP and\n      // both local and remote are Firefox, the remote peer can receive\n      // ~2 GiB.\n      maxMessageSize = 2147483637;\n    }\n    return maxMessageSize;\n  };\n\n  const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n    function setRemoteDescription() {\n      this._sctp = null;\n      // Chrome decided to not expose .sctp in plan-b mode.\n      // As usual, adapter.js has to do an 'ugly worakaround'\n      // to cover up the mess.\n      if (browserDetails.browser === 'chrome' && browserDetails.version >= 76) {\n        const {sdpSemantics} = this.getConfiguration();\n        if (sdpSemantics === 'plan-b') {\n          Object.defineProperty(this, 'sctp', {\n            get() {\n              return typeof this._sctp === 'undefined' ? null : this._sctp;\n            },\n            enumerable: true,\n            configurable: true,\n          });\n        }\n      }\n\n      if (sctpInDescription(arguments[0])) {\n        // Check if the remote is FF.\n        const isFirefox = getRemoteFirefoxVersion(arguments[0]);\n\n        // Get the maximum message size the local peer is capable of sending\n        const canSendMMS = getCanSendMaxMessageSize(isFirefox);\n\n        // Get the maximum message size of the remote peer.\n        const remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\n\n        // Determine final maximum message size\n        let maxMessageSize;\n        if (canSendMMS === 0 && remoteMMS === 0) {\n          maxMessageSize = Number.POSITIVE_INFINITY;\n        } else if (canSendMMS === 0 || remoteMMS === 0) {\n          maxMessageSize = Math.max(canSendMMS, remoteMMS);\n        } else {\n          maxMessageSize = Math.min(canSendMMS, remoteMMS);\n        }\n\n        // Create a dummy RTCSctpTransport object and the 'maxMessageSize'\n        // attribute.\n        const sctp = {};\n        Object.defineProperty(sctp, 'maxMessageSize', {\n          get() {\n            return maxMessageSize;\n          }\n        });\n        this._sctp = sctp;\n      }\n\n      return origSetRemoteDescription.apply(this, arguments);\n    };\n}\n\nexport function shimSendThrowTypeError(window) {\n  if (!(window.RTCPeerConnection &&\n      'createDataChannel' in window.RTCPeerConnection.prototype)) {\n    return;\n  }\n\n  // Note: Although Firefox >= 57 has a native implementation, the maximum\n  //       message size can be reset for all data channels at a later stage.\n  //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n\n  function wrapDcSend(dc, pc) {\n    const origDataChannelSend = dc.send;\n    dc.send = function send() {\n      const data = arguments[0];\n      const length = data.length || data.size || data.byteLength;\n      if (dc.readyState === 'open' &&\n          pc.sctp && length > pc.sctp.maxMessageSize) {\n        throw new TypeError('Message too large (can send a maximum of ' +\n          pc.sctp.maxMessageSize + ' bytes)');\n      }\n      return origDataChannelSend.apply(dc, arguments);\n    };\n  }\n  const origCreateDataChannel =\n    window.RTCPeerConnection.prototype.createDataChannel;\n  window.RTCPeerConnection.prototype.createDataChannel =\n    function createDataChannel() {\n      const dataChannel = origCreateDataChannel.apply(this, arguments);\n      wrapDcSend(dataChannel, this);\n      return dataChannel;\n    };\n  utils.wrapPeerConnectionEvent(window, 'datachannel', e => {\n    wrapDcSend(e.channel, e.target);\n    return e;\n  });\n}\n\n\n/* shims RTCConnectionState by pretending it is the same as iceConnectionState.\n * See https://bugs.chromium.org/p/webrtc/issues/detail?id=6145#c12\n * for why this is a valid hack in Chrome. In Firefox it is slightly incorrect\n * since DTLS failures would be hidden. See\n * https://bugzilla.mozilla.org/show_bug.cgi?id=1265827\n * for the Firefox tracking bug.\n */\nexport function shimConnectionState(window) {\n  if (!window.RTCPeerConnection ||\n      'connectionState' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  Object.defineProperty(proto, 'connectionState', {\n    get() {\n      return {\n        completed: 'connected',\n        checking: 'connecting'\n      }[this.iceConnectionState] || this.iceConnectionState;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(proto, 'onconnectionstatechange', {\n    get() {\n      return this._onconnectionstatechange || null;\n    },\n    set(cb) {\n      if (this._onconnectionstatechange) {\n        this.removeEventListener('connectionstatechange',\n          this._onconnectionstatechange);\n        delete this._onconnectionstatechange;\n      }\n      if (cb) {\n        this.addEventListener('connectionstatechange',\n          this._onconnectionstatechange = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  ['setLocalDescription', 'setRemoteDescription'].forEach((method) => {\n    const origMethod = proto[method];\n    proto[method] = function() {\n      if (!this._connectionstatechangepoly) {\n        this._connectionstatechangepoly = e => {\n          const pc = e.target;\n          if (pc._lastConnectionState !== pc.connectionState) {\n            pc._lastConnectionState = pc.connectionState;\n            const newEvent = new Event('connectionstatechange', e);\n            pc.dispatchEvent(newEvent);\n          }\n          return e;\n        };\n        this.addEventListener('iceconnectionstatechange',\n          this._connectionstatechangepoly);\n      }\n      return origMethod.apply(this, arguments);\n    };\n  });\n}\n\nexport function removeExtmapAllowMixed(window, browserDetails) {\n  /* remove a=extmap-allow-mixed for webrtc.org < M71 */\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  if (browserDetails.browser === 'chrome' && browserDetails.version >= 71) {\n    return;\n  }\n  if (browserDetails.browser === 'safari' && browserDetails.version >= 605) {\n    return;\n  }\n  const nativeSRD = window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n  function setRemoteDescription(desc) {\n    if (desc && desc.sdp && desc.sdp.indexOf('\\na=extmap-allow-mixed') !== -1) {\n      const sdp = desc.sdp.split('\\n').filter((line) => {\n        return line.trim() !== 'a=extmap-allow-mixed';\n      }).join('\\n');\n      // Safari enforces read-only-ness of RTCSessionDescription fields.\n      if (window.RTCSessionDescription &&\n          desc instanceof window.RTCSessionDescription) {\n        arguments[0] = new window.RTCSessionDescription({\n          type: desc.type,\n          sdp,\n        });\n      } else {\n        desc.sdp = sdp;\n      }\n    }\n    return nativeSRD.apply(this, arguments);\n  };\n}\n\nexport function shimAddIceCandidateNullOrEmpty(window, browserDetails) {\n  // Support for addIceCandidate(null or undefined)\n  // as well as addIceCandidate({candidate: \"\", ...})\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=978582\n  // Note: must be called before other polyfills which change the signature.\n  if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n    return;\n  }\n  const nativeAddIceCandidate =\n      window.RTCPeerConnection.prototype.addIceCandidate;\n  if (!nativeAddIceCandidate || nativeAddIceCandidate.length === 0) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.addIceCandidate =\n    function addIceCandidate() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      // Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\n      // in older versions.\n      // Native support for ignoring exists for Chrome M77+.\n      // Safari ignores as well, exact version unknown but works in the same\n      // version that also ignores addIceCandidate(null).\n      if (((browserDetails.browser === 'chrome' && browserDetails.version < 78)\n           || (browserDetails.browser === 'firefox'\n               && browserDetails.version < 68)\n           || (browserDetails.browser === 'safari'))\n          && arguments[0] && arguments[0].candidate === '') {\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n}\n\n// Note: Make sure to call this ahead of APIs that modify\n// setLocalDescription.length\nexport function shimParameterlessSetLocalDescription(window, browserDetails) {\n  if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n    return;\n  }\n  const nativeSetLocalDescription =\n      window.RTCPeerConnection.prototype.setLocalDescription;\n  if (!nativeSetLocalDescription || nativeSetLocalDescription.length === 0) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.setLocalDescription =\n    function setLocalDescription() {\n      let desc = arguments[0] || {};\n      if (typeof desc !== 'object' || (desc.type && desc.sdp)) {\n        return nativeSetLocalDescription.apply(this, arguments);\n      }\n      // The remaining steps should technically happen when SLD comes off the\n      // RTCPeerConnection's operations chain (not ahead of going on it), but\n      // this is too difficult to shim. Instead, this shim only covers the\n      // common case where the operations chain is empty. This is imperfect, but\n      // should cover many cases. Rationale: Even if we can't reduce the glare\n      // window to zero on imperfect implementations, there's value in tapping\n      // into the perfect negotiation pattern that several browsers support.\n      desc = {type: desc.type, sdp: desc.sdp};\n      if (!desc.type) {\n        switch (this.signalingState) {\n          case 'stable':\n          case 'have-local-offer':\n          case 'have-remote-pranswer':\n            desc.type = 'offer';\n            break;\n          default:\n            desc.type = 'answer';\n            break;\n        }\n      }\n      if (desc.sdp || (desc.type !== 'offer' && desc.type !== 'answer')) {\n        return nativeSetLocalDescription.apply(this, [desc]);\n      }\n      const func = desc.type === 'offer' ? this.createOffer : this.createAnswer;\n      return func.apply(this)\n        .then(d => nativeSetLocalDescription.apply(this, [d]));\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\nimport * as utils from './utils';\n\n// Browser shims.\nimport * as chromeShim from './chrome/chrome_shim';\nimport * as firefoxShim from './firefox/firefox_shim';\nimport * as safariShim from './safari/safari_shim';\nimport * as commonShim from './common_shim';\nimport * as sdp from 'sdp';\n\n// Shimming starts here.\nexport function adapterFactory({window} = {}, options = {\n  shimChrome: true,\n  shimFirefox: true,\n  shimSafari: true,\n}) {\n  // Utils.\n  const logging = utils.log;\n  const browserDetails = utils.detectBrowser(window);\n\n  const adapter = {\n    browserDetails,\n    commonShim,\n    extractVersion: utils.extractVersion,\n    disableLog: utils.disableLog,\n    disableWarnings: utils.disableWarnings,\n    // Expose sdp as a convenience. For production apps include directly.\n    sdp,\n  };\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection ||\n          !options.shimChrome) {\n        logging('Chrome shim is not included in this adapter release.');\n        return adapter;\n      }\n      if (browserDetails.version === null) {\n        logging('Chrome shim can not determine version, not shimming.');\n        return adapter;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = chromeShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n      chromeShim.shimGetUserMedia(window, browserDetails);\n      chromeShim.shimMediaStream(window, browserDetails);\n      chromeShim.shimPeerConnection(window, browserDetails);\n      chromeShim.shimOnTrack(window, browserDetails);\n      chromeShim.shimAddTrackRemoveTrack(window, browserDetails);\n      chromeShim.shimGetSendersWithDtmf(window, browserDetails);\n      chromeShim.shimSenderReceiverGetStats(window, browserDetails);\n      chromeShim.fixNegotiationNeeded(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimRTCIceCandidateRelayProtocol(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection ||\n          !options.shimFirefox) {\n        logging('Firefox shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = firefoxShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n      firefoxShim.shimGetUserMedia(window, browserDetails);\n      firefoxShim.shimPeerConnection(window, browserDetails);\n      firefoxShim.shimOnTrack(window, browserDetails);\n      firefoxShim.shimRemoveStream(window, browserDetails);\n      firefoxShim.shimSenderGetStats(window, browserDetails);\n      firefoxShim.shimReceiverGetStats(window, browserDetails);\n      firefoxShim.shimRTCDataChannel(window, browserDetails);\n      firefoxShim.shimAddTransceiver(window, browserDetails);\n      firefoxShim.shimGetParameters(window, browserDetails);\n      firefoxShim.shimCreateOffer(window, browserDetails);\n      firefoxShim.shimCreateAnswer(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      break;\n    case 'safari':\n      if (!safariShim || !options.shimSafari) {\n        logging('Safari shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = safariShim;\n\n      // Must be called before shimCallbackAPI.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n      safariShim.shimRTCIceServerUrls(window, browserDetails);\n      safariShim.shimCreateOfferLegacy(window, browserDetails);\n      safariShim.shimCallbacksAPI(window, browserDetails);\n      safariShim.shimLocalStreamsAPI(window, browserDetails);\n      safariShim.shimRemoteStreamsAPI(window, browserDetails);\n      safariShim.shimTrackEventTransceiver(window, browserDetails);\n      safariShim.shimGetUserMedia(window, browserDetails);\n      safariShim.shimAudioContext(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimRTCIceCandidateRelayProtocol(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    default:\n      logging('Unsupported browser!');\n      break;\n  }\n\n  return adapter;\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n\n'use strict';\n\nimport {adapterFactory} from './adapter_factory.js';\n\nconst adapter =\n  adapterFactory({window: typeof window === 'undefined' ? undefined : window});\nexport default adapter;\n",null,null,null,null,null,null,null,null,null,null,null,"export class BinaryPackChunker {\n\treadonly chunkedMTU = 16300; // The original 60000 bytes setting does not work when sending data from Firefox to Chrome, which is \"cut off\" after 16384 bytes and delivered individually.\n\n\t// Binary stuff\n\n\tprivate _dataCount: number = 1;\n\n\tchunk = (\n\t\tblob: ArrayBuffer,\n\t): { __peerData: number; n: number; total: number; data: Uint8Array }[] => {\n\t\tconst chunks = [];\n\t\tconst size = blob.byteLength;\n\t\tconst total = Math.ceil(size / this.chunkedMTU);\n\n\t\tlet index = 0;\n\t\tlet start = 0;\n\n\t\twhile (start < size) {\n\t\t\tconst end = Math.min(size, start + this.chunkedMTU);\n\t\t\tconst b = blob.slice(start, end);\n\n\t\t\tconst chunk = {\n\t\t\t\t__peerData: this._dataCount,\n\t\t\t\tn: index,\n\t\t\t\tdata: b,\n\t\t\t\ttotal,\n\t\t\t};\n\n\t\t\tchunks.push(chunk);\n\n\t\t\tstart = end;\n\t\t\tindex++;\n\t\t}\n\n\t\tthis._dataCount++;\n\n\t\treturn chunks;\n\t};\n}\n\nexport function concatArrayBuffers(bufs: Uint8Array[]) {\n\tlet size = 0;\n\tfor (const buf of bufs) {\n\t\tsize += buf.byteLength;\n\t}\n\tconst result = new Uint8Array(size);\n\tlet offset = 0;\n\tfor (const buf of bufs) {\n\t\tresult.set(buf, offset);\n\t\toffset += buf.byteLength;\n\t}\n\treturn result;\n}\n","import webRTCAdapter_import from \"webrtc-adapter\";\n\nconst webRTCAdapter: typeof webRTCAdapter_import =\n\t//@ts-ignore\n\twebRTCAdapter_import.default || webRTCAdapter_import;\n\nexport const Supports = new (class {\n\treadonly isIOS =\n\t\ttypeof navigator !== \"undefined\"\n\t\t\t? [\"iPad\", \"iPhone\", \"iPod\"].includes(navigator.platform)\n\t\t\t: false;\n\treadonly supportedBrowsers = [\"firefox\", \"chrome\", \"safari\"];\n\n\treadonly minFirefoxVersion = 59;\n\treadonly minChromeVersion = 72;\n\treadonly minSafariVersion = 605;\n\n\tisWebRTCSupported(): boolean {\n\t\treturn typeof RTCPeerConnection !== \"undefined\";\n\t}\n\n\tisBrowserSupported(): boolean {\n\t\tconst browser = this.getBrowser();\n\t\tconst version = this.getVersion();\n\n\t\tconst validBrowser = this.supportedBrowsers.includes(browser);\n\n\t\tif (!validBrowser) return false;\n\n\t\tif (browser === \"chrome\") return version >= this.minChromeVersion;\n\t\tif (browser === \"firefox\") return version >= this.minFirefoxVersion;\n\t\tif (browser === \"safari\")\n\t\t\treturn !this.isIOS && version >= this.minSafariVersion;\n\n\t\treturn false;\n\t}\n\n\tgetBrowser(): string {\n\t\treturn webRTCAdapter.browserDetails.browser;\n\t}\n\n\tgetVersion(): number {\n\t\treturn webRTCAdapter.browserDetails.version || 0;\n\t}\n\n\tisUnifiedPlanSupported(): boolean {\n\t\tconst browser = this.getBrowser();\n\t\tconst version = webRTCAdapter.browserDetails.version || 0;\n\n\t\tif (browser === \"chrome\" && version < this.minChromeVersion) return false;\n\t\tif (browser === \"firefox\" && version >= this.minFirefoxVersion) return true;\n\t\tif (\n\t\t\t!window.RTCRtpTransceiver ||\n\t\t\t!(\"currentDirection\" in RTCRtpTransceiver.prototype)\n\t\t)\n\t\t\treturn false;\n\n\t\tlet tempPc: RTCPeerConnection;\n\t\tlet supported = false;\n\n\t\ttry {\n\t\t\ttempPc = new RTCPeerConnection();\n\t\t\ttempPc.addTransceiver(\"audio\");\n\t\t\tsupported = true;\n\t\t} catch (e) {\n\t\t} finally {\n\t\t\tif (tempPc) {\n\t\t\t\ttempPc.close();\n\t\t\t}\n\t\t}\n\n\t\treturn supported;\n\t}\n\n\ttoString(): string {\n\t\treturn `Supports:\n    browser:${this.getBrowser()}\n    version:${this.getVersion()}\n    isIOS:${this.isIOS}\n    isWebRTCSupported:${this.isWebRTCSupported()}\n    isBrowserSupported:${this.isBrowserSupported()}\n    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`;\n\t}\n})();\n","export const validateId = (id: string): boolean => {\n\t// Allow empty ids\n\treturn !id || /^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(id);\n};\n","export const randomToken = () => Math.random().toString(36).slice(2);\n","import { BinaryPackChunker } from \"./dataconnection/BufferedConnection/binaryPackChunker\";\nimport * as BinaryPack from \"peerjs-js-binarypack\";\nimport { Supports } from \"./supports\";\nimport { validateId } from \"./utils/validateId\";\nimport { randomToken } from \"./utils/randomToken\";\n\nexport interface UtilSupportsObj {\n\t/**\n\t * The current browser.\n\t * This property can be useful in determining whether two peers can connect.\n\t *\n\t * ```ts\n\t * if (util.browser === 'firefox') {\n\t *  // OK to peer with Firefox peers.\n\t * }\n\t * ```\n\t *\n\t * `util.browser` can currently have the values\n\t * `'firefox', 'chrome', 'safari', 'edge', 'Not a supported browser.', 'Not a browser.' (unknown WebRTC-compatible agent).\n\t */\n\tbrowser: boolean;\n\twebRTC: boolean;\n\t/**\n\t * True if the current browser supports media streams and PeerConnection.\n\t */\n\taudioVideo: boolean;\n\t/**\n\t * True if the current browser supports DataChannel and PeerConnection.\n\t */\n\tdata: boolean;\n\tbinaryBlob: boolean;\n\t/**\n\t * True if the current browser supports reliable DataChannels.\n\t */\n\treliable: boolean;\n}\n\nconst DEFAULT_CONFIG = {\n\ticeServers: [\n\t\t{ urls: \"stun:stun.l.google.com:19302\" },\n\t\t{\n\t\t\turls: [\n\t\t\t\t\"turn:eu-0.turn.peerjs.com:3478\",\n\t\t\t\t\"turn:us-0.turn.peerjs.com:3478\",\n\t\t\t],\n\t\t\tusername: \"peerjs\",\n\t\t\tcredential: \"peerjsp\",\n\t\t},\n\t],\n\tsdpSemantics: \"unified-plan\",\n};\n\nexport class Util extends BinaryPackChunker {\n\tnoop(): void {}\n\n\treadonly CLOUD_HOST = \"0.peerjs.com\";\n\treadonly CLOUD_PORT = 443;\n\n\t// Browsers that need chunking:\n\treadonly chunkedBrowsers = { Chrome: 1, chrome: 1 };\n\n\t// Returns browser-agnostic default config\n\treadonly defaultConfig = DEFAULT_CONFIG;\n\n\treadonly browser = Supports.getBrowser();\n\treadonly browserVersion = Supports.getVersion();\n\n\tpack = BinaryPack.pack;\n\tunpack = BinaryPack.unpack;\n\n\t/**\n\t * A hash of WebRTC features mapped to booleans that correspond to whether the feature is supported by the current browser.\n\t *\n\t * :::caution\n\t * Only the properties documented here are guaranteed to be present on `util.supports`\n\t * :::\n\t */\n\treadonly supports = (function () {\n\t\tconst supported: UtilSupportsObj = {\n\t\t\tbrowser: Supports.isBrowserSupported(),\n\t\t\twebRTC: Supports.isWebRTCSupported(),\n\t\t\taudioVideo: false,\n\t\t\tdata: false,\n\t\t\tbinaryBlob: false,\n\t\t\treliable: false,\n\t\t};\n\n\t\tif (!supported.webRTC) return supported;\n\n\t\tlet pc: RTCPeerConnection;\n\n\t\ttry {\n\t\t\tpc = new RTCPeerConnection(DEFAULT_CONFIG);\n\n\t\t\tsupported.audioVideo = true;\n\n\t\t\tlet dc: RTCDataChannel;\n\n\t\t\ttry {\n\t\t\t\tdc = pc.createDataChannel(\"_PEERJSTEST\", { ordered: true });\n\t\t\t\tsupported.data = true;\n\t\t\t\tsupported.reliable = !!dc.ordered;\n\n\t\t\t\t// Binary test\n\t\t\t\ttry {\n\t\t\t\t\tdc.binaryType = \"blob\";\n\t\t\t\t\tsupported.binaryBlob = !Supports.isIOS;\n\t\t\t\t} catch (e) {}\n\t\t\t} catch (e) {\n\t\t\t} finally {\n\t\t\t\tif (dc) {\n\t\t\t\t\tdc.close();\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (e) {\n\t\t} finally {\n\t\t\tif (pc) {\n\t\t\t\tpc.close();\n\t\t\t}\n\t\t}\n\n\t\treturn supported;\n\t})();\n\n\t// Ensure alphanumeric ids\n\tvalidateId = validateId;\n\trandomToken = randomToken;\n\n\tblobToArrayBuffer(\n\t\tblob: Blob,\n\t\tcb: (arg: ArrayBuffer | null) => void,\n\t): FileReader {\n\t\tconst fr = new FileReader();\n\n\t\tfr.onload = function (evt) {\n\t\t\tif (evt.target) {\n\t\t\t\tcb(evt.target.result as ArrayBuffer);\n\t\t\t}\n\t\t};\n\n\t\tfr.readAsArrayBuffer(blob);\n\n\t\treturn fr;\n\t}\n\n\tbinaryStringToArrayBuffer(binary: string): ArrayBuffer | SharedArrayBuffer {\n\t\tconst byteArray = new Uint8Array(binary.length);\n\n\t\tfor (let i = 0; i < binary.length; i++) {\n\t\t\tbyteArray[i] = binary.charCodeAt(i) & 0xff;\n\t\t}\n\n\t\treturn byteArray.buffer;\n\t}\n\tisSecure(): boolean {\n\t\treturn location.protocol === \"https:\";\n\t}\n}\n\n/**\n * Provides a variety of helpful utilities.\n *\n * :::caution\n * Only the utilities documented here are guaranteed to be present on `util`.\n * Undocumented utilities can be removed without warning.\n * We don't consider these to be breaking changes.\n * :::\n */\nexport const util = new Util();\n","const LOG_PREFIX = \"PeerJS: \";\n\n/*\nPrints log messages depending on the debug level passed in. Defaults to 0.\n0  Prints no logs.\n1  Prints only errors.\n2  Prints errors and warnings.\n3  Prints all logs.\n*/\nexport enum LogLevel {\n\t/**\n\t * Prints no logs.\n\t */\n\tDisabled,\n\t/**\n\t * Prints only errors.\n\t */\n\tErrors,\n\t/**\n\t * Prints errors and warnings.\n\t */\n\tWarnings,\n\t/**\n\t * Prints all logs.\n\t */\n\tAll,\n}\n\nclass Logger {\n\tprivate _logLevel = LogLevel.Disabled;\n\n\tget logLevel(): LogLevel {\n\t\treturn this._logLevel;\n\t}\n\n\tset logLevel(logLevel: LogLevel) {\n\t\tthis._logLevel = logLevel;\n\t}\n\n\tlog(...args: any[]) {\n\t\tif (this._logLevel >= LogLevel.All) {\n\t\t\tthis._print(LogLevel.All, ...args);\n\t\t}\n\t}\n\n\twarn(...args: any[]) {\n\t\tif (this._logLevel >= LogLevel.Warnings) {\n\t\t\tthis._print(LogLevel.Warnings, ...args);\n\t\t}\n\t}\n\n\terror(...args: any[]) {\n\t\tif (this._logLevel >= LogLevel.Errors) {\n\t\t\tthis._print(LogLevel.Errors, ...args);\n\t\t}\n\t}\n\n\tsetLogFunction(fn: (logLevel: LogLevel, ..._: any[]) => void): void {\n\t\tthis._print = fn;\n\t}\n\n\tprivate _print(logLevel: LogLevel, ...rest: any[]): void {\n\t\tconst copy = [LOG_PREFIX, ...rest];\n\n\t\tfor (const i in copy) {\n\t\t\tif (copy[i] instanceof Error) {\n\t\t\t\tcopy[i] = \"(\" + copy[i].name + \") \" + copy[i].message;\n\t\t\t}\n\t\t}\n\n\t\tif (logLevel >= LogLevel.All) {\n\t\t\tconsole.log(...copy);\n\t\t} else if (logLevel >= LogLevel.Warnings) {\n\t\t\tconsole.warn(\"WARNING\", ...copy);\n\t\t} else if (logLevel >= LogLevel.Errors) {\n\t\t\tconsole.error(\"ERROR\", ...copy);\n\t\t}\n\t}\n}\n\nexport default new Logger();\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","export enum ConnectionType {\n\tData = \"data\",\n\tMedia = \"media\",\n}\n\nexport enum PeerErrorType {\n\t/**\n\t * The client's browser does not support some or all WebRTC features that you are trying to use.\n\t */\n\tBrowserIncompatible = \"browser-incompatible\",\n\t/**\n\t * You've already disconnected this peer from the server and can no longer make any new connections on it.\n\t */\n\tDisconnected = \"disconnected\",\n\t/**\n\t * The ID passed into the Peer constructor contains illegal characters.\n\t */\n\tInvalidID = \"invalid-id\",\n\t/**\n\t * The API key passed into the Peer constructor contains illegal characters or is not in the system (cloud server only).\n\t */\n\tInvalidKey = \"invalid-key\",\n\t/**\n\t * Lost or cannot establish a connection to the signalling server.\n\t */\n\tNetwork = \"network\",\n\t/**\n\t * The peer you're trying to connect to does not exist.\n\t */\n\tPeerUnavailable = \"peer-unavailable\",\n\t/**\n\t * PeerJS is being used securely, but the cloud server does not support SSL. Use a custom PeerServer.\n\t */\n\tSslUnavailable = \"ssl-unavailable\",\n\t/**\n\t * Unable to reach the server.\n\t */\n\tServerError = \"server-error\",\n\t/**\n\t * An error from the underlying socket.\n\t */\n\tSocketError = \"socket-error\",\n\t/**\n\t * The underlying socket closed unexpectedly.\n\t */\n\tSocketClosed = \"socket-closed\",\n\t/**\n\t * The ID passed into the Peer constructor is already taken.\n\t *\n\t * :::caution\n\t * This error is not fatal if your peer has open peer-to-peer connections.\n\t * This can happen if you attempt to {@apilink Peer.reconnect} a peer that has been disconnected from the server,\n\t * but its old ID has now been taken.\n\t * :::\n\t */\n\tUnavailableID = \"unavailable-id\",\n\t/**\n\t * Native WebRTC errors.\n\t */\n\tWebRTC = \"webrtc\",\n}\n\nexport enum BaseConnectionErrorType {\n\tNegotiationFailed = \"negotiation-failed\",\n\tConnectionClosed = \"connection-closed\",\n}\n\nexport enum DataConnectionErrorType {\n\tNotOpenYet = \"not-open-yet\",\n\tMessageToBig = \"message-too-big\",\n}\n\nexport enum SerializationType {\n\tBinary = \"binary\",\n\tBinaryUTF8 = \"binary-utf8\",\n\tJSON = \"json\",\n\tNone = \"raw\",\n}\n\nexport enum SocketEventType {\n\tMessage = \"message\",\n\tDisconnected = \"disconnected\",\n\tError = \"error\",\n\tClose = \"close\",\n}\n\nexport enum ServerMessageType {\n\tHeartbeat = \"HEARTBEAT\",\n\tCandidate = \"CANDIDATE\",\n\tOffer = \"OFFER\",\n\tAnswer = \"ANSWER\",\n\tOpen = \"OPEN\", // The connection to the server is open.\n\tError = \"ERROR\", // Server error.\n\tIdTaken = \"ID-TAKEN\", // The selected ID is taken.\n\tInvalidKey = \"INVALID-KEY\", // The given API key cannot be found.\n\tLeave = \"LEAVE\", // Another peer has closed its connection to this peer.\n\tExpire = \"EXPIRE\", // The offer sent to a peer has expired without response.\n}\n","{\n\t\"name\": \"peerjs\",\n\t\"version\": \"1.5.4\",\n\t\"keywords\": [\n\t\t\"peerjs\",\n\t\t\"webrtc\",\n\t\t\"p2p\",\n\t\t\"rtc\"\n\t],\n\t\"description\": \"PeerJS client\",\n\t\"homepage\": \"https://peerjs.com\",\n\t\"bugs\": {\n\t\t\"url\": \"https://github.com/peers/peerjs/issues\"\n\t},\n\t\"repository\": {\n\t\t\"type\": \"git\",\n\t\t\"url\": \"https://github.com/peers/peerjs\"\n\t},\n\t\"license\": \"MIT\",\n\t\"contributors\": [\n\t\t\"Michelle Bu <michelle@michellebu.com>\",\n\t\t\"afrokick <devbyru@gmail.com>\",\n\t\t\"ericz <really.ez@gmail.com>\",\n\t\t\"Jairo <kidandcat@gmail.com>\",\n\t\t\"Jonas Gloning <34194370+jonasgloning@users.noreply.github.com>\",\n\t\t\"Jairo Caro-Accino Viciana <jairo@galax.be>\",\n\t\t\"Carlos Caballero <carlos.caballero.gonzalez@gmail.com>\",\n\t\t\"hc <hheennrryy@gmail.com>\",\n\t\t\"Muhammad Asif <capripio@gmail.com>\",\n\t\t\"PrashoonB <prashoonbhattacharjee@gmail.com>\",\n\t\t\"Harsh Bardhan Mishra <47351025+HarshCasper@users.noreply.github.com>\",\n\t\t\"akotynski <aleksanderkotbury@gmail.com>\",\n\t\t\"lmb <i@lmb.io>\",\n\t\t\"Jairooo <jairocaro@msn.com>\",\n\t\t\"Moritz Stückler <moritz.stueckler@gmail.com>\",\n\t\t\"Simon <crydotsnakegithub@gmail.com>\",\n\t\t\"Denis Lukov <denismassters@gmail.com>\",\n\t\t\"Philipp Hancke <fippo@andyet.net>\",\n\t\t\"Hans Oksendahl <hansoksendahl@gmail.com>\",\n\t\t\"Jess <jessachandler@gmail.com>\",\n\t\t\"khankuan <khankuan@gmail.com>\",\n\t\t\"DUODVK <kurmanov.work@gmail.com>\",\n\t\t\"XiZhao <kwang1imsa@gmail.com>\",\n\t\t\"Matthias Lohr <matthias@lohr.me>\",\n\t\t\"=frank tree <=frnktrb@googlemail.com>\",\n\t\t\"Andre Eckardt <aeckardt@outlook.com>\",\n\t\t\"Chris Cowan <agentme49@gmail.com>\",\n\t\t\"Alex Chuev <alex@chuev.com>\",\n\t\t\"alxnull <alxnull@e.mail.de>\",\n\t\t\"Yemel Jardi <angel.jardi@gmail.com>\",\n\t\t\"Ben Parnell <benjaminparnell.94@gmail.com>\",\n\t\t\"Benny Lichtner <bennlich@gmail.com>\",\n\t\t\"fresheneesz <bitetrudpublic@gmail.com>\",\n\t\t\"bob.barstead@exaptive.com <bob.barstead@exaptive.com>\",\n\t\t\"chandika <chandika@gmail.com>\",\n\t\t\"emersion <contact@emersion.fr>\",\n\t\t\"Christopher Van <cvan@users.noreply.github.com>\",\n\t\t\"eddieherm <edhermoso@gmail.com>\",\n\t\t\"Eduardo Pinho <enet4mikeenet@gmail.com>\",\n\t\t\"Evandro Zanatta <ezanatta@tray.net.br>\",\n\t\t\"Gardner Bickford <gardner@users.noreply.github.com>\",\n\t\t\"Gian Luca <gianluca.cecchi@cynny.com>\",\n\t\t\"PatrickJS <github@gdi2290.com>\",\n\t\t\"jonnyf <github@jonathanfoss.co.uk>\",\n\t\t\"Hizkia Felix <hizkifw@gmail.com>\",\n\t\t\"Hristo Oskov <hristo.oskov@gmail.com>\",\n\t\t\"Isaac Madwed <i.madwed@gmail.com>\",\n\t\t\"Ilya Konanykhin <ilya.konanykhin@gmail.com>\",\n\t\t\"jasonbarry <jasbarry@me.com>\",\n\t\t\"Jonathan Burke <jonathan.burke.1311@googlemail.com>\",\n\t\t\"Josh Hamit <josh.hamit@gmail.com>\",\n\t\t\"Jordan Austin <jrax86@gmail.com>\",\n\t\t\"Joel Wetzell <jwetzell@yahoo.com>\",\n\t\t\"xizhao <kevin.wang@cloudera.com>\",\n\t\t\"Alberto Torres <kungfoobar@gmail.com>\",\n\t\t\"Jonathan Mayol <mayoljonathan@gmail.com>\",\n\t\t\"Jefferson Felix <me@jsfelix.dev>\",\n\t\t\"Rolf Erik Lekang <me@rolflekang.com>\",\n\t\t\"Kevin Mai-Husan Chia <mhchia@users.noreply.github.com>\",\n\t\t\"Pepijn de Vos <pepijndevos@gmail.com>\",\n\t\t\"JooYoung <qkdlql@naver.com>\",\n\t\t\"Tobias Speicher <rootcommander@gmail.com>\",\n\t\t\"Steve Blaurock <sblaurock@gmail.com>\",\n\t\t\"Kyrylo Shegeda <shegeda@ualberta.ca>\",\n\t\t\"Diwank Singh Tomer <singh@diwank.name>\",\n\t\t\"Sören Balko <Soeren.Balko@gmail.com>\",\n\t\t\"Arpit Solanki <solankiarpit1997@gmail.com>\",\n\t\t\"Yuki Ito <yuki@gnnk.net>\",\n\t\t\"Artur Zayats <zag2art@gmail.com>\"\n\t],\n\t\"funding\": {\n\t\t\"type\": \"opencollective\",\n\t\t\"url\": \"https://opencollective.com/peer\"\n\t},\n\t\"collective\": {\n\t\t\"type\": \"opencollective\",\n\t\t\"url\": \"https://opencollective.com/peer\"\n\t},\n\t\"files\": [\n\t\t\"dist/*\"\n\t],\n\t\"sideEffects\": [\n\t\t\"lib/global.ts\",\n\t\t\"lib/supports.ts\"\n\t],\n\t\"main\": \"dist/bundler.cjs\",\n\t\"module\": \"dist/bundler.mjs\",\n\t\"browser-minified\": \"dist/peerjs.min.js\",\n\t\"browser-unminified\": \"dist/peerjs.js\",\n\t\"browser-minified-msgpack\": \"dist/serializer.msgpack.mjs\",\n\t\"types\": \"dist/types.d.ts\",\n\t\"engines\": {\n\t\t\"node\": \">= 14\"\n\t},\n\t\"targets\": {\n\t\t\"types\": {\n\t\t\t\"source\": \"lib/exports.ts\"\n\t\t},\n\t\t\"main\": {\n\t\t\t\"source\": \"lib/exports.ts\",\n\t\t\t\"sourceMap\": {\n\t\t\t\t\"inlineSources\": true\n\t\t\t}\n\t\t},\n\t\t\"module\": {\n\t\t\t\"source\": \"lib/exports.ts\",\n\t\t\t\"includeNodeModules\": [\n\t\t\t\t\"eventemitter3\"\n\t\t\t],\n\t\t\t\"sourceMap\": {\n\t\t\t\t\"inlineSources\": true\n\t\t\t}\n\t\t},\n\t\t\"browser-minified\": {\n\t\t\t\"context\": \"browser\",\n\t\t\t\"outputFormat\": \"global\",\n\t\t\t\"optimize\": true,\n\t\t\t\"engines\": {\n\t\t\t\t\"browsers\": \"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15\"\n\t\t\t},\n\t\t\t\"source\": \"lib/global.ts\"\n\t\t},\n\t\t\"browser-unminified\": {\n\t\t\t\"context\": \"browser\",\n\t\t\t\"outputFormat\": \"global\",\n\t\t\t\"optimize\": false,\n\t\t\t\"engines\": {\n\t\t\t\t\"browsers\": \"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15\"\n\t\t\t},\n\t\t\t\"source\": \"lib/global.ts\"\n\t\t},\n\t\t\"browser-minified-msgpack\": {\n\t\t\t\"context\": \"browser\",\n\t\t\t\"outputFormat\": \"esmodule\",\n\t\t\t\"isLibrary\": true,\n\t\t\t\"optimize\": true,\n\t\t\t\"engines\": {\n\t\t\t\t\"browsers\": \"chrome >= 83, edge >= 83, firefox >= 102, safari >= 15\"\n\t\t\t},\n\t\t\t\"source\": \"lib/dataconnection/StreamConnection/MsgPack.ts\"\n\t\t}\n\t},\n\t\"scripts\": {\n\t\t\"contributors\": \"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\\"chore(contributors): update and sort contributors list\\\"\",\n\t\t\"check\": \"tsc --noEmit && tsc -p e2e/tsconfig.json --noEmit\",\n\t\t\"watch\": \"parcel watch\",\n\t\t\"build\": \"rm -rf dist && parcel build\",\n\t\t\"prepublishOnly\": \"npm run build\",\n\t\t\"test\": \"jest\",\n\t\t\"test:watch\": \"jest --watch\",\n\t\t\"coverage\": \"jest --coverage --collectCoverageFrom=\\\"./lib/**\\\"\",\n\t\t\"format\": \"prettier --write .\",\n\t\t\"format:check\": \"prettier --check .\",\n\t\t\"semantic-release\": \"semantic-release\",\n\t\t\"e2e\": \"wdio run e2e/wdio.local.conf.ts\",\n\t\t\"e2e:bstack\": \"wdio run e2e/wdio.bstack.conf.ts\"\n\t},\n\t\"devDependencies\": {\n\t\t\"@parcel/config-default\": \"^2.9.3\",\n\t\t\"@parcel/packager-ts\": \"^2.9.3\",\n\t\t\"@parcel/transformer-typescript-tsc\": \"^2.9.3\",\n\t\t\"@parcel/transformer-typescript-types\": \"^2.9.3\",\n\t\t\"@semantic-release/changelog\": \"^6.0.1\",\n\t\t\"@semantic-release/git\": \"^10.0.1\",\n\t\t\"@swc/core\": \"^1.3.27\",\n\t\t\"@swc/jest\": \"^0.2.24\",\n\t\t\"@types/jasmine\": \"^4.3.4\",\n\t\t\"@wdio/browserstack-service\": \"^8.11.2\",\n\t\t\"@wdio/cli\": \"^8.11.2\",\n\t\t\"@wdio/globals\": \"^8.11.2\",\n\t\t\"@wdio/jasmine-framework\": \"^8.11.2\",\n\t\t\"@wdio/local-runner\": \"^8.11.2\",\n\t\t\"@wdio/spec-reporter\": \"^8.11.2\",\n\t\t\"@wdio/types\": \"^8.10.4\",\n\t\t\"http-server\": \"^14.1.1\",\n\t\t\"jest\": \"^29.3.1\",\n\t\t\"jest-environment-jsdom\": \"^29.3.1\",\n\t\t\"mock-socket\": \"^9.0.0\",\n\t\t\"parcel\": \"^2.9.3\",\n\t\t\"prettier\": \"^3.0.0\",\n\t\t\"semantic-release\": \"^21.0.0\",\n\t\t\"ts-node\": \"^10.9.1\",\n\t\t\"typescript\": \"^5.0.0\",\n\t\t\"wdio-geckodriver-service\": \"^5.0.1\"\n\t},\n\t\"dependencies\": {\n\t\t\"@msgpack/msgpack\": \"^2.8.0\",\n\t\t\"eventemitter3\": \"^4.0.7\",\n\t\t\"peerjs-js-binarypack\": \"^2.1.0\",\n\t\t\"webrtc-adapter\": \"^9.0.0\"\n\t},\n\t\"alias\": {\n\t\t\"process\": false,\n\t\t\"buffer\": false\n\t}\n}\n","import { EventEmitter } from \"eventemitter3\";\nimport logger from \"./logger\";\nimport { ServerMessageType, SocketEventType } from \"./enums\";\nimport { version } from \"../package.json\";\n\n/**\n * An abstraction on top of WebSockets to provide fastest\n * possible connection for peers.\n */\nexport class Socket extends EventEmitter {\n\tprivate _disconnected: boolean = true;\n\tprivate _id?: string;\n\tprivate _messagesQueue: Array<object> = [];\n\tprivate _socket?: WebSocket;\n\tprivate _wsPingTimer?: any;\n\tprivate readonly _baseUrl: string;\n\n\tconstructor(\n\t\tsecure: any,\n\t\thost: string,\n\t\tport: number,\n\t\tpath: string,\n\t\tkey: string,\n\t\tprivate readonly pingInterval: number = 5000,\n\t) {\n\t\tsuper();\n\n\t\tconst wsProtocol = secure ? \"wss://\" : \"ws://\";\n\n\t\tthis._baseUrl = wsProtocol + host + \":\" + port + path + \"peerjs?key=\" + key;\n\t}\n\n\tstart(id: string, token: string): void {\n\t\tthis._id = id;\n\n\t\tconst wsUrl = `${this._baseUrl}&id=${id}&token=${token}`;\n\n\t\tif (!!this._socket || !this._disconnected) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._socket = new WebSocket(wsUrl + \"&version=\" + version);\n\t\tthis._disconnected = false;\n\n\t\tthis._socket.onmessage = (event) => {\n\t\t\tlet data;\n\n\t\t\ttry {\n\t\t\t\tdata = JSON.parse(event.data);\n\t\t\t\tlogger.log(\"Server message received:\", data);\n\t\t\t} catch (e) {\n\t\t\t\tlogger.log(\"Invalid server message\", event.data);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.emit(SocketEventType.Message, data);\n\t\t};\n\n\t\tthis._socket.onclose = (event) => {\n\t\t\tif (this._disconnected) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlogger.log(\"Socket closed.\", event);\n\n\t\t\tthis._cleanup();\n\t\t\tthis._disconnected = true;\n\n\t\t\tthis.emit(SocketEventType.Disconnected);\n\t\t};\n\n\t\t// Take care of the queue of connections if necessary and make sure Peer knows\n\t\t// socket is open.\n\t\tthis._socket.onopen = () => {\n\t\t\tif (this._disconnected) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._sendQueuedMessages();\n\n\t\t\tlogger.log(\"Socket open\");\n\n\t\t\tthis._scheduleHeartbeat();\n\t\t};\n\t}\n\n\tprivate _scheduleHeartbeat(): void {\n\t\tthis._wsPingTimer = setTimeout(() => {\n\t\t\tthis._sendHeartbeat();\n\t\t}, this.pingInterval);\n\t}\n\n\tprivate _sendHeartbeat(): void {\n\t\tif (!this._wsOpen()) {\n\t\t\tlogger.log(`Cannot send heartbeat, because socket closed`);\n\t\t\treturn;\n\t\t}\n\n\t\tconst message = JSON.stringify({ type: ServerMessageType.Heartbeat });\n\n\t\tthis._socket!.send(message);\n\n\t\tthis._scheduleHeartbeat();\n\t}\n\n\t/** Is the websocket currently open? */\n\tprivate _wsOpen(): boolean {\n\t\treturn !!this._socket && this._socket.readyState === 1;\n\t}\n\n\t/** Send queued messages. */\n\tprivate _sendQueuedMessages(): void {\n\t\t//Create copy of queue and clear it,\n\t\t//because send method push the message back to queue if smth will go wrong\n\t\tconst copiedQueue = [...this._messagesQueue];\n\t\tthis._messagesQueue = [];\n\n\t\tfor (const message of copiedQueue) {\n\t\t\tthis.send(message);\n\t\t}\n\t}\n\n\t/** Exposed send for DC & Peer. */\n\tsend(data: any): void {\n\t\tif (this._disconnected) {\n\t\t\treturn;\n\t\t}\n\n\t\t// If we didn't get an ID yet, we can't yet send anything so we should queue\n\t\t// up these messages.\n\t\tif (!this._id) {\n\t\t\tthis._messagesQueue.push(data);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!data.type) {\n\t\t\tthis.emit(SocketEventType.Error, \"Invalid message\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._wsOpen()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst message = JSON.stringify(data);\n\n\t\tthis._socket!.send(message);\n\t}\n\n\tclose(): void {\n\t\tif (this._disconnected) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._cleanup();\n\n\t\tthis._disconnected = true;\n\t}\n\n\tprivate _cleanup(): void {\n\t\tif (this._socket) {\n\t\t\tthis._socket.onopen =\n\t\t\t\tthis._socket.onmessage =\n\t\t\t\tthis._socket.onclose =\n\t\t\t\t\tnull;\n\t\t\tthis._socket.close();\n\t\t\tthis._socket = undefined;\n\t\t}\n\n\t\tclearTimeout(this._wsPingTimer!);\n\t}\n}\n","import logger from \"./logger\";\nimport type { MediaConnection } from \"./mediaconnection\";\nimport type { DataConnection } from \"./dataconnection/DataConnection\";\nimport {\n\tBaseConnectionErrorType,\n\tConnectionType,\n\tPeerErrorType,\n\tServerMessageType,\n} from \"./enums\";\nimport type { BaseConnection, BaseConnectionEvents } from \"./baseconnection\";\nimport type { ValidEventTypes } from \"eventemitter3\";\n\n/**\n * Manages all negotiations between Peers.\n */\nexport class Negotiator<\n\tEvents extends ValidEventTypes,\n\tConnectionType extends BaseConnection<Events | BaseConnectionEvents>,\n> {\n\tconstructor(readonly connection: ConnectionType) {}\n\n\t/** Returns a PeerConnection object set up correctly (for data, media). */\n\tstartConnection(options: any) {\n\t\tconst peerConnection = this._startPeerConnection();\n\n\t\t// Set the connection's PC.\n\t\tthis.connection.peerConnection = peerConnection;\n\n\t\tif (this.connection.type === ConnectionType.Media && options._stream) {\n\t\t\tthis._addTracksToConnection(options._stream, peerConnection);\n\t\t}\n\n\t\t// What do we need to do now?\n\t\tif (options.originator) {\n\t\t\tconst dataConnection = this.connection;\n\n\t\t\tconst config: RTCDataChannelInit = { ordered: !!options.reliable };\n\n\t\t\tconst dataChannel = peerConnection.createDataChannel(\n\t\t\t\tdataConnection.label,\n\t\t\t\tconfig,\n\t\t\t);\n\t\t\tdataConnection._initializeDataChannel(dataChannel);\n\n\t\t\tvoid this._makeOffer();\n\t\t} else {\n\t\t\tvoid this.handleSDP(\"OFFER\", options.sdp);\n\t\t}\n\t}\n\n\t/** Start a PC. */\n\tprivate _startPeerConnection(): RTCPeerConnection {\n\t\tlogger.log(\"Creating RTCPeerConnection.\");\n\n\t\tconst peerConnection = new RTCPeerConnection(\n\t\t\tthis.connection.provider.options.config,\n\t\t);\n\n\t\tthis._setupListeners(peerConnection);\n\n\t\treturn peerConnection;\n\t}\n\n\t/** Set up various WebRTC listeners. */\n\tprivate _setupListeners(peerConnection: RTCPeerConnection) {\n\t\tconst peerId = this.connection.peer;\n\t\tconst connectionId = this.connection.connectionId;\n\t\tconst connectionType = this.connection.type;\n\t\tconst provider = this.connection.provider;\n\n\t\t// ICE CANDIDATES.\n\t\tlogger.log(\"Listening for ICE candidates.\");\n\n\t\tpeerConnection.onicecandidate = (evt) => {\n\t\t\tif (!evt.candidate || !evt.candidate.candidate) return;\n\n\t\t\tlogger.log(`Received ICE candidates for ${peerId}:`, evt.candidate);\n\n\t\t\tprovider.socket.send({\n\t\t\t\ttype: ServerMessageType.Candidate,\n\t\t\t\tpayload: {\n\t\t\t\t\tcandidate: evt.candidate,\n\t\t\t\t\ttype: connectionType,\n\t\t\t\t\tconnectionId: connectionId,\n\t\t\t\t},\n\t\t\t\tdst: peerId,\n\t\t\t});\n\t\t};\n\n\t\tpeerConnection.oniceconnectionstatechange = () => {\n\t\t\tswitch (peerConnection.iceConnectionState) {\n\t\t\t\tcase \"failed\":\n\t\t\t\t\tlogger.log(\n\t\t\t\t\t\t\"iceConnectionState is failed, closing connections to \" + peerId,\n\t\t\t\t\t);\n\t\t\t\t\tthis.connection.emitError(\n\t\t\t\t\t\tBaseConnectionErrorType.NegotiationFailed,\n\t\t\t\t\t\t\"Negotiation of connection to \" + peerId + \" failed.\",\n\t\t\t\t\t);\n\t\t\t\t\tthis.connection.close();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"closed\":\n\t\t\t\t\tlogger.log(\n\t\t\t\t\t\t\"iceConnectionState is closed, closing connections to \" + peerId,\n\t\t\t\t\t);\n\t\t\t\t\tthis.connection.emitError(\n\t\t\t\t\t\tBaseConnectionErrorType.ConnectionClosed,\n\t\t\t\t\t\t\"Connection to \" + peerId + \" closed.\",\n\t\t\t\t\t);\n\t\t\t\t\tthis.connection.close();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"disconnected\":\n\t\t\t\t\tlogger.log(\n\t\t\t\t\t\t\"iceConnectionState changed to disconnected on the connection with \" +\n\t\t\t\t\t\t\tpeerId,\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"completed\":\n\t\t\t\t\tpeerConnection.onicecandidate = () => {};\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tthis.connection.emit(\n\t\t\t\t\"iceStateChanged\",\n\t\t\t\tpeerConnection.iceConnectionState,\n\t\t\t);\n\t\t};\n\n\t\t// DATACONNECTION.\n\t\tlogger.log(\"Listening for data channel\");\n\t\t// Fired between offer and answer, so options should already be saved\n\t\t// in the options hash.\n\t\tpeerConnection.ondatachannel = (evt) => {\n\t\t\tlogger.log(\"Received data channel\");\n\n\t\t\tconst dataChannel = evt.channel;\n\t\t\tconst connection = <DataConnection>(\n\t\t\t\tprovider.getConnection(peerId, connectionId)\n\t\t\t);\n\n\t\t\tconnection._initializeDataChannel(dataChannel);\n\t\t};\n\n\t\t// MEDIACONNECTION.\n\t\tlogger.log(\"Listening for remote stream\");\n\n\t\tpeerConnection.ontrack = (evt) => {\n\t\t\tlogger.log(\"Received remote stream\");\n\n\t\t\tconst stream = evt.streams[0];\n\t\t\tconst connection = provider.getConnection(peerId, connectionId);\n\n\t\t\tif (connection.type === ConnectionType.Media) {\n\t\t\t\tconst mediaConnection = <MediaConnection>connection;\n\n\t\t\t\tthis._addStreamToMediaConnection(stream, mediaConnection);\n\t\t\t}\n\t\t};\n\t}\n\n\tcleanup(): void {\n\t\tlogger.log(\"Cleaning up PeerConnection to \" + this.connection.peer);\n\n\t\tconst peerConnection = this.connection.peerConnection;\n\n\t\tif (!peerConnection) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.connection.peerConnection = null;\n\n\t\t//unsubscribe from all PeerConnection's events\n\t\tpeerConnection.onicecandidate =\n\t\t\tpeerConnection.oniceconnectionstatechange =\n\t\t\tpeerConnection.ondatachannel =\n\t\t\tpeerConnection.ontrack =\n\t\t\t\t() => {};\n\n\t\tconst peerConnectionNotClosed = peerConnection.signalingState !== \"closed\";\n\t\tlet dataChannelNotClosed = false;\n\n\t\tconst dataChannel = this.connection.dataChannel;\n\n\t\tif (dataChannel) {\n\t\t\tdataChannelNotClosed =\n\t\t\t\t!!dataChannel.readyState && dataChannel.readyState !== \"closed\";\n\t\t}\n\n\t\tif (peerConnectionNotClosed || dataChannelNotClosed) {\n\t\t\tpeerConnection.close();\n\t\t}\n\t}\n\n\tprivate async _makeOffer(): Promise<void> {\n\t\tconst peerConnection = this.connection.peerConnection;\n\t\tconst provider = this.connection.provider;\n\n\t\ttry {\n\t\t\tconst offer = await peerConnection.createOffer(\n\t\t\t\tthis.connection.options.constraints,\n\t\t\t);\n\n\t\t\tlogger.log(\"Created offer.\");\n\n\t\t\tif (\n\t\t\t\tthis.connection.options.sdpTransform &&\n\t\t\t\ttypeof this.connection.options.sdpTransform === \"function\"\n\t\t\t) {\n\t\t\t\toffer.sdp =\n\t\t\t\t\tthis.connection.options.sdpTransform(offer.sdp) || offer.sdp;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tawait peerConnection.setLocalDescription(offer);\n\n\t\t\t\tlogger.log(\n\t\t\t\t\t\"Set localDescription:\",\n\t\t\t\t\toffer,\n\t\t\t\t\t`for:${this.connection.peer}`,\n\t\t\t\t);\n\n\t\t\t\tlet payload: any = {\n\t\t\t\t\tsdp: offer,\n\t\t\t\t\ttype: this.connection.type,\n\t\t\t\t\tconnectionId: this.connection.connectionId,\n\t\t\t\t\tmetadata: this.connection.metadata,\n\t\t\t\t};\n\n\t\t\t\tif (this.connection.type === ConnectionType.Data) {\n\t\t\t\t\tconst dataConnection = <DataConnection>(<unknown>this.connection);\n\n\t\t\t\t\tpayload = {\n\t\t\t\t\t\t...payload,\n\t\t\t\t\t\tlabel: dataConnection.label,\n\t\t\t\t\t\treliable: dataConnection.reliable,\n\t\t\t\t\t\tserialization: dataConnection.serialization,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tprovider.socket.send({\n\t\t\t\t\ttype: ServerMessageType.Offer,\n\t\t\t\t\tpayload,\n\t\t\t\t\tdst: this.connection.peer,\n\t\t\t\t});\n\t\t\t} catch (err) {\n\t\t\t\t// TODO: investigate why _makeOffer is being called from the answer\n\t\t\t\tif (\n\t\t\t\t\terr !=\n\t\t\t\t\t\"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer\"\n\t\t\t\t) {\n\t\t\t\t\tprovider.emitError(PeerErrorType.WebRTC, err);\n\t\t\t\t\tlogger.log(\"Failed to setLocalDescription, \", err);\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (err_1) {\n\t\t\tprovider.emitError(PeerErrorType.WebRTC, err_1);\n\t\t\tlogger.log(\"Failed to createOffer, \", err_1);\n\t\t}\n\t}\n\n\tprivate async _makeAnswer(): Promise<void> {\n\t\tconst peerConnection = this.connection.peerConnection;\n\t\tconst provider = this.connection.provider;\n\n\t\ttry {\n\t\t\tconst answer = await peerConnection.createAnswer();\n\t\t\tlogger.log(\"Created answer.\");\n\n\t\t\tif (\n\t\t\t\tthis.connection.options.sdpTransform &&\n\t\t\t\ttypeof this.connection.options.sdpTransform === \"function\"\n\t\t\t) {\n\t\t\t\tanswer.sdp =\n\t\t\t\t\tthis.connection.options.sdpTransform(answer.sdp) || answer.sdp;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tawait peerConnection.setLocalDescription(answer);\n\n\t\t\t\tlogger.log(\n\t\t\t\t\t`Set localDescription:`,\n\t\t\t\t\tanswer,\n\t\t\t\t\t`for:${this.connection.peer}`,\n\t\t\t\t);\n\n\t\t\t\tprovider.socket.send({\n\t\t\t\t\ttype: ServerMessageType.Answer,\n\t\t\t\t\tpayload: {\n\t\t\t\t\t\tsdp: answer,\n\t\t\t\t\t\ttype: this.connection.type,\n\t\t\t\t\t\tconnectionId: this.connection.connectionId,\n\t\t\t\t\t},\n\t\t\t\t\tdst: this.connection.peer,\n\t\t\t\t});\n\t\t\t} catch (err) {\n\t\t\t\tprovider.emitError(PeerErrorType.WebRTC, err);\n\t\t\t\tlogger.log(\"Failed to setLocalDescription, \", err);\n\t\t\t}\n\t\t} catch (err_1) {\n\t\t\tprovider.emitError(PeerErrorType.WebRTC, err_1);\n\t\t\tlogger.log(\"Failed to create answer, \", err_1);\n\t\t}\n\t}\n\n\t/** Handle an SDP. */\n\tasync handleSDP(type: string, sdp: any): Promise<void> {\n\t\tsdp = new RTCSessionDescription(sdp);\n\t\tconst peerConnection = this.connection.peerConnection;\n\t\tconst provider = this.connection.provider;\n\n\t\tlogger.log(\"Setting remote description\", sdp);\n\n\t\tconst self = this;\n\n\t\ttry {\n\t\t\tawait peerConnection.setRemoteDescription(sdp);\n\t\t\tlogger.log(`Set remoteDescription:${type} for:${this.connection.peer}`);\n\t\t\tif (type === \"OFFER\") {\n\t\t\t\tawait self._makeAnswer();\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tprovider.emitError(PeerErrorType.WebRTC, err);\n\t\t\tlogger.log(\"Failed to setRemoteDescription, \", err);\n\t\t}\n\t}\n\n\t/** Handle a candidate. */\n\tasync handleCandidate(ice: RTCIceCandidate) {\n\t\tlogger.log(`handleCandidate:`, ice);\n\n\t\ttry {\n\t\t\tawait this.connection.peerConnection.addIceCandidate(ice);\n\t\t\tlogger.log(`Added ICE candidate for:${this.connection.peer}`);\n\t\t} catch (err) {\n\t\t\tthis.connection.provider.emitError(PeerErrorType.WebRTC, err);\n\t\t\tlogger.log(\"Failed to handleCandidate, \", err);\n\t\t}\n\t}\n\n\tprivate _addTracksToConnection(\n\t\tstream: MediaStream,\n\t\tpeerConnection: RTCPeerConnection,\n\t): void {\n\t\tlogger.log(`add tracks from stream ${stream.id} to peer connection`);\n\n\t\tif (!peerConnection.addTrack) {\n\t\t\treturn logger.error(\n\t\t\t\t`Your browser does't support RTCPeerConnection#addTrack. Ignored.`,\n\t\t\t);\n\t\t}\n\n\t\tstream.getTracks().forEach((track) => {\n\t\t\tpeerConnection.addTrack(track, stream);\n\t\t});\n\t}\n\n\tprivate _addStreamToMediaConnection(\n\t\tstream: MediaStream,\n\t\tmediaConnection: MediaConnection,\n\t): void {\n\t\tlogger.log(\n\t\t\t`add stream ${stream.id} to media connection ${mediaConnection.connectionId}`,\n\t\t);\n\n\t\tmediaConnection.addStream(stream);\n\t}\n}\n","import { EventEmitter } from \"eventemitter3\";\nimport logger from \"./logger\";\n\nexport interface EventsWithError<ErrorType extends string> {\n\terror: (error: PeerError<`${ErrorType}`>) => void;\n}\n\nexport class EventEmitterWithError<\n\tErrorType extends string,\n\tEvents extends EventsWithError<ErrorType>,\n> extends EventEmitter<Events, never> {\n\t/**\n\t * Emits a typed error message.\n\t *\n\t * @internal\n\t */\n\temitError(type: ErrorType, err: string | Error): void {\n\t\tlogger.error(\"Error:\", err);\n\n\t\t// @ts-ignore\n\t\tthis.emit(\"error\", new PeerError<`${ErrorType}`>(`${type}`, err));\n\t}\n}\n/**\n * A PeerError is emitted whenever an error occurs.\n * It always has a `.type`, which can be used to identify the error.\n */\nexport class PeerError<T extends string> extends Error {\n\t/**\n\t * @internal\n\t */\n\tconstructor(type: T, err: Error | string) {\n\t\tif (typeof err === \"string\") {\n\t\t\tsuper(err);\n\t\t} else {\n\t\t\tsuper();\n\t\t\tObject.assign(this, err);\n\t\t}\n\n\t\tthis.type = type;\n\t}\n\n\tpublic type: T;\n}\n","import type { Peer } from \"./peer\";\nimport type { ServerMessage } from \"./servermessage\";\nimport type { ConnectionType } from \"./enums\";\nimport { BaseConnectionErrorType } from \"./enums\";\nimport {\n\tEventEmitterWithError,\n\ttype EventsWithError,\n\tPeerError,\n} from \"./peerError\";\nimport type { ValidEventTypes } from \"eventemitter3\";\n\nexport interface BaseConnectionEvents<\n\tErrorType extends string = BaseConnectionErrorType,\n> extends EventsWithError<ErrorType> {\n\t/**\n\t * Emitted when either you or the remote peer closes the connection.\n\t *\n\t * ```ts\n\t * connection.on('close', () => { ... });\n\t * ```\n\t */\n\tclose: () => void;\n\t/**\n\t * ```ts\n\t * connection.on('error', (error) => { ... });\n\t * ```\n\t */\n\terror: (error: PeerError<`${ErrorType}`>) => void;\n\ticeStateChanged: (state: RTCIceConnectionState) => void;\n}\n\nexport abstract class BaseConnection<\n\tSubClassEvents extends ValidEventTypes,\n\tErrorType extends string = never,\n> extends EventEmitterWithError<\n\tErrorType | BaseConnectionErrorType,\n\tSubClassEvents & BaseConnectionEvents<BaseConnectionErrorType | ErrorType>\n> {\n\tprotected _open = false;\n\n\t/**\n\t * Any type of metadata associated with the connection,\n\t * passed in by whoever initiated the connection.\n\t */\n\treadonly metadata: any;\n\tconnectionId: string;\n\n\tpeerConnection: RTCPeerConnection;\n\tdataChannel: RTCDataChannel;\n\n\tabstract get type(): ConnectionType;\n\n\t/**\n\t * The optional label passed in or assigned by PeerJS when the connection was initiated.\n\t */\n\tlabel: string;\n\n\t/**\n\t * Whether the media connection is active (e.g. your call has been answered).\n\t * You can check this if you want to set a maximum wait time for a one-sided call.\n\t */\n\tget open() {\n\t\treturn this._open;\n\t}\n\n\tprotected constructor(\n\t\t/**\n\t\t * The ID of the peer on the other end of this connection.\n\t\t */\n\t\treadonly peer: string,\n\t\tpublic provider: Peer,\n\t\treadonly options: any,\n\t) {\n\t\tsuper();\n\n\t\tthis.metadata = options.metadata;\n\t}\n\n\tabstract close(): void;\n\n\t/**\n\t * @internal\n\t */\n\tabstract handleMessage(message: ServerMessage): void;\n\n\t/**\n\t * Called by the Negotiator when the DataChannel is ready.\n\t * @internal\n\t * */\n\tabstract _initializeDataChannel(dc: RTCDataChannel): void;\n}\n","import { util } from \"./util\";\nimport logger from \"./logger\";\nimport { Negotiator } from \"./negotiator\";\nimport { ConnectionType, ServerMessageType } from \"./enums\";\nimport type { Peer } from \"./peer\";\nimport { BaseConnection, type BaseConnectionEvents } from \"./baseconnection\";\nimport type { ServerMessage } from \"./servermessage\";\nimport type { AnswerOption } from \"./optionInterfaces\";\n\nexport interface MediaConnectionEvents extends BaseConnectionEvents<never> {\n\t/**\n\t * Emitted when a connection to the PeerServer is established.\n\t *\n\t * ```ts\n\t * mediaConnection.on('stream', (stream) => { ... });\n\t * ```\n\t */\n\tstream: (stream: MediaStream) => void;\n\t/**\n\t * Emitted when the auxiliary data channel is established.\n\t * After this event, hanging up will close the connection cleanly on the remote peer.\n\t * @beta\n\t */\n\twillCloseOnRemote: () => void;\n}\n\n/**\n * Wraps WebRTC's media streams.\n * To get one, use {@apilink Peer.call} or listen for the {@apilink PeerEvents | `call`} event.\n */\nexport class MediaConnection extends BaseConnection<MediaConnectionEvents> {\n\tprivate static readonly ID_PREFIX = \"mc_\";\n\treadonly label: string;\n\n\tprivate _negotiator: Negotiator<MediaConnectionEvents, this>;\n\tprivate _localStream: MediaStream;\n\tprivate _remoteStream: MediaStream;\n\n\t/**\n\t * For media connections, this is always 'media'.\n\t */\n\tget type() {\n\t\treturn ConnectionType.Media;\n\t}\n\n\tget localStream(): MediaStream {\n\t\treturn this._localStream;\n\t}\n\n\tget remoteStream(): MediaStream {\n\t\treturn this._remoteStream;\n\t}\n\n\tconstructor(peerId: string, provider: Peer, options: any) {\n\t\tsuper(peerId, provider, options);\n\n\t\tthis._localStream = this.options._stream;\n\t\tthis.connectionId =\n\t\t\tthis.options.connectionId ||\n\t\t\tMediaConnection.ID_PREFIX + util.randomToken();\n\n\t\tthis._negotiator = new Negotiator(this);\n\n\t\tif (this._localStream) {\n\t\t\tthis._negotiator.startConnection({\n\t\t\t\t_stream: this._localStream,\n\t\t\t\toriginator: true,\n\t\t\t});\n\t\t}\n\t}\n\n\t/** Called by the Negotiator when the DataChannel is ready. */\n\toverride _initializeDataChannel(dc: RTCDataChannel): void {\n\t\tthis.dataChannel = dc;\n\n\t\tthis.dataChannel.onopen = () => {\n\t\t\tlogger.log(`DC#${this.connectionId} dc connection success`);\n\t\t\tthis.emit(\"willCloseOnRemote\");\n\t\t};\n\n\t\tthis.dataChannel.onclose = () => {\n\t\t\tlogger.log(`DC#${this.connectionId} dc closed for:`, this.peer);\n\t\t\tthis.close();\n\t\t};\n\t}\n\taddStream(remoteStream) {\n\t\tlogger.log(\"Receiving stream\", remoteStream);\n\n\t\tthis._remoteStream = remoteStream;\n\t\tsuper.emit(\"stream\", remoteStream); // Should we call this `open`?\n\t}\n\n\t/**\n\t * @internal\n\t */\n\thandleMessage(message: ServerMessage): void {\n\t\tconst type = message.type;\n\t\tconst payload = message.payload;\n\n\t\tswitch (message.type) {\n\t\t\tcase ServerMessageType.Answer:\n\t\t\t\t// Forward to negotiator\n\t\t\t\tvoid this._negotiator.handleSDP(type, payload.sdp);\n\t\t\t\tthis._open = true;\n\t\t\t\tbreak;\n\t\t\tcase ServerMessageType.Candidate:\n\t\t\t\tvoid this._negotiator.handleCandidate(payload.candidate);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlogger.warn(`Unrecognized message type:${type} from peer:${this.peer}`);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/**\n     * When receiving a {@apilink PeerEvents | `call`} event on a peer, you can call\n     * `answer` on the media connection provided by the callback to accept the call\n     * and optionally send your own media stream.\n\n     *\n     * @param stream A WebRTC media stream.\n     * @param options\n     * @returns\n     */\n\tanswer(stream?: MediaStream, options: AnswerOption = {}): void {\n\t\tif (this._localStream) {\n\t\t\tlogger.warn(\n\t\t\t\t\"Local stream already exists on this MediaConnection. Are you answering a call twice?\",\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._localStream = stream;\n\n\t\tif (options && options.sdpTransform) {\n\t\t\tthis.options.sdpTransform = options.sdpTransform;\n\t\t}\n\n\t\tthis._negotiator.startConnection({\n\t\t\t...this.options._payload,\n\t\t\t_stream: stream,\n\t\t});\n\t\t// Retrieve lost messages stored because PeerConnection not set up.\n\t\tconst messages = this.provider._getMessages(this.connectionId);\n\n\t\tfor (const message of messages) {\n\t\t\tthis.handleMessage(message);\n\t\t}\n\n\t\tthis._open = true;\n\t}\n\n\t/**\n\t * Exposed functionality for users.\n\t */\n\n\t/**\n\t * Closes the media connection.\n\t */\n\tclose(): void {\n\t\tif (this._negotiator) {\n\t\t\tthis._negotiator.cleanup();\n\t\t\tthis._negotiator = null;\n\t\t}\n\n\t\tthis._localStream = null;\n\t\tthis._remoteStream = null;\n\n\t\tif (this.provider) {\n\t\t\tthis.provider._removeConnection(this);\n\n\t\t\tthis.provider = null;\n\t\t}\n\n\t\tif (this.options && this.options._stream) {\n\t\t\tthis.options._stream = null;\n\t\t}\n\n\t\tif (!this.open) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._open = false;\n\n\t\tsuper.emit(\"close\");\n\t}\n}\n","import { util } from \"./util\";\nimport logger from \"./logger\";\nimport type { PeerJSOption } from \"./optionInterfaces\";\nimport { version } from \"../package.json\";\n\nexport class API {\n\tconstructor(private readonly _options: PeerJSOption) {}\n\n\tprivate _buildRequest(method: string): Promise<Response> {\n\t\tconst protocol = this._options.secure ? \"https\" : \"http\";\n\t\tconst { host, port, path, key } = this._options;\n\t\tconst url = new URL(`${protocol}://${host}:${port}${path}${key}/${method}`);\n\t\t// TODO: Why timestamp, why random?\n\t\turl.searchParams.set(\"ts\", `${Date.now()}${Math.random()}`);\n\t\turl.searchParams.set(\"version\", version);\n\t\treturn fetch(url.href, {\n\t\t\treferrerPolicy: this._options.referrerPolicy,\n\t\t});\n\t}\n\n\t/** Get a unique ID from the server via XHR and initialize with it. */\n\tasync retrieveId(): Promise<string> {\n\t\ttry {\n\t\t\tconst response = await this._buildRequest(\"id\");\n\n\t\t\tif (response.status !== 200) {\n\t\t\t\tthrow new Error(`Error. Status:${response.status}`);\n\t\t\t}\n\n\t\t\treturn response.text();\n\t\t} catch (error) {\n\t\t\tlogger.error(\"Error retrieving ID\", error);\n\n\t\t\tlet pathError = \"\";\n\n\t\t\tif (\n\t\t\t\tthis._options.path === \"/\" &&\n\t\t\t\tthis._options.host !== util.CLOUD_HOST\n\t\t\t) {\n\t\t\t\tpathError =\n\t\t\t\t\t\" If you passed in a `path` to your self-hosted PeerServer, \" +\n\t\t\t\t\t\"you'll also need to pass in that same path when creating a new \" +\n\t\t\t\t\t\"Peer.\";\n\t\t\t}\n\n\t\t\tthrow new Error(\"Could not get an ID from the server.\" + pathError);\n\t\t}\n\t}\n\n\t/** @deprecated */\n\tasync listAllPeers(): Promise<any[]> {\n\t\ttry {\n\t\t\tconst response = await this._buildRequest(\"peers\");\n\n\t\t\tif (response.status !== 200) {\n\t\t\t\tif (response.status === 401) {\n\t\t\t\t\tlet helpfulError = \"\";\n\n\t\t\t\t\tif (this._options.host === util.CLOUD_HOST) {\n\t\t\t\t\t\thelpfulError =\n\t\t\t\t\t\t\t\"It looks like you're using the cloud server. You can email \" +\n\t\t\t\t\t\t\t\"team@peerjs.com to enable peer listing for your API key.\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\thelpfulError =\n\t\t\t\t\t\t\t\"You need to enable `allow_discovery` on your self-hosted \" +\n\t\t\t\t\t\t\t\"PeerServer to use this feature.\";\n\t\t\t\t\t}\n\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\"It doesn't look like you have permission to list peers IDs. \" +\n\t\t\t\t\t\t\thelpfulError,\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tthrow new Error(`Error. Status:${response.status}`);\n\t\t\t}\n\n\t\t\treturn response.json();\n\t\t} catch (error) {\n\t\t\tlogger.error(\"Error retrieving list peers\", error);\n\n\t\t\tthrow new Error(\"Could not get list peers from the server.\" + error);\n\t\t}\n\t}\n}\n","import logger from \"../logger\";\nimport { Negotiator } from \"../negotiator\";\nimport {\n\tBaseConnectionErrorType,\n\tConnectionType,\n\tDataConnectionErrorType,\n\tServerMessageType,\n} from \"../enums\";\nimport type { Peer } from \"../peer\";\nimport { BaseConnection, type BaseConnectionEvents } from \"../baseconnection\";\nimport type { ServerMessage } from \"../servermessage\";\nimport type { EventsWithError } from \"../peerError\";\nimport { randomToken } from \"../utils/randomToken\";\n\nexport interface DataConnectionEvents\n\textends EventsWithError<DataConnectionErrorType | BaseConnectionErrorType>,\n\t\tBaseConnectionEvents<DataConnectionErrorType | BaseConnectionErrorType> {\n\t/**\n\t * Emitted when data is received from the remote peer.\n\t */\n\tdata: (data: unknown) => void;\n\t/**\n\t * Emitted when the connection is established and ready-to-use.\n\t */\n\topen: () => void;\n}\n\n/**\n * Wraps a DataChannel between two Peers.\n */\nexport abstract class DataConnection extends BaseConnection<\n\tDataConnectionEvents,\n\tDataConnectionErrorType\n> {\n\tprotected static readonly ID_PREFIX = \"dc_\";\n\tprotected static readonly MAX_BUFFERED_AMOUNT = 8 * 1024 * 1024;\n\n\tprivate _negotiator: Negotiator<DataConnectionEvents, this>;\n\tabstract readonly serialization: string;\n\treadonly reliable: boolean;\n\n\tpublic get type() {\n\t\treturn ConnectionType.Data;\n\t}\n\n\tconstructor(peerId: string, provider: Peer, options: any) {\n\t\tsuper(peerId, provider, options);\n\n\t\tthis.connectionId =\n\t\t\tthis.options.connectionId || DataConnection.ID_PREFIX + randomToken();\n\n\t\tthis.label = this.options.label || this.connectionId;\n\t\tthis.reliable = !!this.options.reliable;\n\n\t\tthis._negotiator = new Negotiator(this);\n\n\t\tthis._negotiator.startConnection(\n\t\t\tthis.options._payload || {\n\t\t\t\toriginator: true,\n\t\t\t\treliable: this.reliable,\n\t\t\t},\n\t\t);\n\t}\n\n\t/** Called by the Negotiator when the DataChannel is ready. */\n\toverride _initializeDataChannel(dc: RTCDataChannel): void {\n\t\tthis.dataChannel = dc;\n\n\t\tthis.dataChannel.onopen = () => {\n\t\t\tlogger.log(`DC#${this.connectionId} dc connection success`);\n\t\t\tthis._open = true;\n\t\t\tthis.emit(\"open\");\n\t\t};\n\n\t\tthis.dataChannel.onmessage = (e) => {\n\t\t\tlogger.log(`DC#${this.connectionId} dc onmessage:`, e.data);\n\t\t\t// this._handleDataMessage(e);\n\t\t};\n\n\t\tthis.dataChannel.onclose = () => {\n\t\t\tlogger.log(`DC#${this.connectionId} dc closed for:`, this.peer);\n\t\t\tthis.close();\n\t\t};\n\t}\n\n\t/**\n\t * Exposed functionality for users.\n\t */\n\n\t/** Allows user to close connection. */\n\tclose(options?: { flush?: boolean }): void {\n\t\tif (options?.flush) {\n\t\t\tthis.send({\n\t\t\t\t__peerData: {\n\t\t\t\t\ttype: \"close\",\n\t\t\t\t},\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tif (this._negotiator) {\n\t\t\tthis._negotiator.cleanup();\n\t\t\tthis._negotiator = null;\n\t\t}\n\n\t\tif (this.provider) {\n\t\t\tthis.provider._removeConnection(this);\n\n\t\t\tthis.provider = null;\n\t\t}\n\n\t\tif (this.dataChannel) {\n\t\t\tthis.dataChannel.onopen = null;\n\t\t\tthis.dataChannel.onmessage = null;\n\t\t\tthis.dataChannel.onclose = null;\n\t\t\tthis.dataChannel = null;\n\t\t}\n\n\t\tif (!this.open) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._open = false;\n\n\t\tsuper.emit(\"close\");\n\t}\n\n\tprotected abstract _send(data: any, chunked: boolean): void | Promise<void>;\n\n\t/** Allows user to send data. */\n\tpublic send(data: any, chunked = false) {\n\t\tif (!this.open) {\n\t\t\tthis.emitError(\n\t\t\t\tDataConnectionErrorType.NotOpenYet,\n\t\t\t\t\"Connection is not open. You should listen for the `open` event before sending messages.\",\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\treturn this._send(data, chunked);\n\t}\n\n\tasync handleMessage(message: ServerMessage) {\n\t\tconst payload = message.payload;\n\n\t\tswitch (message.type) {\n\t\t\tcase ServerMessageType.Answer:\n\t\t\t\tawait this._negotiator.handleSDP(message.type, payload.sdp);\n\t\t\t\tbreak;\n\t\t\tcase ServerMessageType.Candidate:\n\t\t\t\tawait this._negotiator.handleCandidate(payload.candidate);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlogger.warn(\n\t\t\t\t\t\"Unrecognized message type:\",\n\t\t\t\t\tmessage.type,\n\t\t\t\t\t\"from peer:\",\n\t\t\t\t\tthis.peer,\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n","import logger from \"../../logger\";\nimport { DataConnection } from \"../DataConnection\";\n\nexport abstract class BufferedConnection extends DataConnection {\n\tprivate _buffer: any[] = [];\n\tprivate _bufferSize = 0;\n\tprivate _buffering = false;\n\n\tpublic get bufferSize(): number {\n\t\treturn this._bufferSize;\n\t}\n\n\tpublic override _initializeDataChannel(dc: RTCDataChannel) {\n\t\tsuper._initializeDataChannel(dc);\n\t\tthis.dataChannel.binaryType = \"arraybuffer\";\n\t\tthis.dataChannel.addEventListener(\"message\", (e) =>\n\t\t\tthis._handleDataMessage(e),\n\t\t);\n\t}\n\n\tprotected abstract _handleDataMessage(e: MessageEvent): void;\n\n\tprotected _bufferedSend(msg: ArrayBuffer): void {\n\t\tif (this._buffering || !this._trySend(msg)) {\n\t\t\tthis._buffer.push(msg);\n\t\t\tthis._bufferSize = this._buffer.length;\n\t\t}\n\t}\n\n\t// Returns true if the send succeeds.\n\tprivate _trySend(msg: ArrayBuffer): boolean {\n\t\tif (!this.open) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.dataChannel.bufferedAmount > DataConnection.MAX_BUFFERED_AMOUNT) {\n\t\t\tthis._buffering = true;\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis._buffering = false;\n\t\t\t\tthis._tryBuffer();\n\t\t\t}, 50);\n\n\t\t\treturn false;\n\t\t}\n\n\t\ttry {\n\t\t\tthis.dataChannel.send(msg);\n\t\t} catch (e) {\n\t\t\tlogger.error(`DC#:${this.connectionId} Error when sending:`, e);\n\t\t\tthis._buffering = true;\n\n\t\t\tthis.close();\n\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t// Try to send the first message in the buffer.\n\tprivate _tryBuffer(): void {\n\t\tif (!this.open) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._buffer.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst msg = this._buffer[0];\n\n\t\tif (this._trySend(msg)) {\n\t\t\tthis._buffer.shift();\n\t\t\tthis._bufferSize = this._buffer.length;\n\t\t\tthis._tryBuffer();\n\t\t}\n\t}\n\n\tpublic override close(options?: { flush?: boolean }) {\n\t\tif (options?.flush) {\n\t\t\tthis.send({\n\t\t\t\t__peerData: {\n\t\t\t\t\ttype: \"close\",\n\t\t\t\t},\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tthis._buffer = [];\n\t\tthis._bufferSize = 0;\n\t\tsuper.close();\n\t}\n}\n","import { BinaryPackChunker, concatArrayBuffers } from \"./binaryPackChunker\";\nimport logger from \"../../logger\";\nimport type { Peer } from \"../../peer\";\nimport { BufferedConnection } from \"./BufferedConnection\";\nimport { SerializationType } from \"../../enums\";\nimport { pack, type Packable, unpack } from \"peerjs-js-binarypack\";\n\nexport class BinaryPack extends BufferedConnection {\n\tprivate readonly chunker = new BinaryPackChunker();\n\treadonly serialization = SerializationType.Binary;\n\n\tprivate _chunkedData: {\n\t\t[id: number]: {\n\t\t\tdata: Uint8Array[];\n\t\t\tcount: number;\n\t\t\ttotal: number;\n\t\t};\n\t} = {};\n\n\tpublic override close(options?: { flush?: boolean }) {\n\t\tsuper.close(options);\n\t\tthis._chunkedData = {};\n\t}\n\n\tconstructor(peerId: string, provider: Peer, options: any) {\n\t\tsuper(peerId, provider, options);\n\t}\n\n\t// Handles a DataChannel message.\n\tprotected override _handleDataMessage({ data }: { data: Uint8Array }): void {\n\t\tconst deserializedData = unpack(data);\n\n\t\t// PeerJS specific message\n\t\tconst peerData = deserializedData[\"__peerData\"];\n\t\tif (peerData) {\n\t\t\tif (peerData.type === \"close\") {\n\t\t\t\tthis.close();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Chunked data -- piece things back together.\n\t\t\t// @ts-ignore\n\t\t\tthis._handleChunk(deserializedData);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.emit(\"data\", deserializedData);\n\t}\n\n\tprivate _handleChunk(data: {\n\t\t__peerData: number;\n\t\tn: number;\n\t\ttotal: number;\n\t\tdata: ArrayBuffer;\n\t}): void {\n\t\tconst id = data.__peerData;\n\t\tconst chunkInfo = this._chunkedData[id] || {\n\t\t\tdata: [],\n\t\t\tcount: 0,\n\t\t\ttotal: data.total,\n\t\t};\n\n\t\tchunkInfo.data[data.n] = new Uint8Array(data.data);\n\t\tchunkInfo.count++;\n\t\tthis._chunkedData[id] = chunkInfo;\n\n\t\tif (chunkInfo.total === chunkInfo.count) {\n\t\t\t// Clean up before making the recursive call to `_handleDataMessage`.\n\t\t\tdelete this._chunkedData[id];\n\n\t\t\t// We've received all the chunks--time to construct the complete data.\n\t\t\t// const data = new Blob(chunkInfo.data);\n\t\t\tconst data = concatArrayBuffers(chunkInfo.data);\n\t\t\tthis._handleDataMessage({ data });\n\t\t}\n\t}\n\n\tprotected override _send(data: Packable, chunked: boolean) {\n\t\tconst blob = pack(data);\n\t\tif (blob instanceof Promise) {\n\t\t\treturn this._send_blob(blob);\n\t\t}\n\n\t\tif (!chunked && blob.byteLength > this.chunker.chunkedMTU) {\n\t\t\tthis._sendChunks(blob);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._bufferedSend(blob);\n\t}\n\tprivate async _send_blob(blobPromise: Promise<ArrayBufferLike>) {\n\t\tconst blob = await blobPromise;\n\t\tif (blob.byteLength > this.chunker.chunkedMTU) {\n\t\t\tthis._sendChunks(blob);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._bufferedSend(blob);\n\t}\n\n\tprivate _sendChunks(blob: ArrayBuffer) {\n\t\tconst blobs = this.chunker.chunk(blob);\n\t\tlogger.log(`DC#${this.connectionId} Try to send ${blobs.length} chunks...`);\n\n\t\tfor (const blob of blobs) {\n\t\t\tthis.send(blob, true);\n\t\t}\n\t}\n}\n","import { BufferedConnection } from \"./BufferedConnection\";\nimport { SerializationType } from \"../../enums\";\n\nexport class Raw extends BufferedConnection {\n\treadonly serialization = SerializationType.None;\n\n\tprotected _handleDataMessage({ data }) {\n\t\tsuper.emit(\"data\", data);\n\t}\n\n\toverride _send(data, _chunked) {\n\t\tthis._bufferedSend(data);\n\t}\n}\n","import { BufferedConnection } from \"./BufferedConnection\";\nimport { DataConnectionErrorType, SerializationType } from \"../../enums\";\nimport { util } from \"../../util\";\n\nexport class Json extends BufferedConnection {\n\treadonly serialization = SerializationType.JSON;\n\tprivate readonly encoder = new TextEncoder();\n\tprivate readonly decoder = new TextDecoder();\n\n\tstringify: (data: any) => string = JSON.stringify;\n\tparse: (data: string) => any = JSON.parse;\n\n\t// Handles a DataChannel message.\n\tprotected override _handleDataMessage({ data }: { data: Uint8Array }): void {\n\t\tconst deserializedData = this.parse(this.decoder.decode(data));\n\n\t\t// PeerJS specific message\n\t\tconst peerData = deserializedData[\"__peerData\"];\n\t\tif (peerData && peerData.type === \"close\") {\n\t\t\tthis.close();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.emit(\"data\", deserializedData);\n\t}\n\n\toverride _send(data, _chunked) {\n\t\tconst encodedData = this.encoder.encode(this.stringify(data));\n\t\tif (encodedData.byteLength >= util.chunkedMTU) {\n\t\t\tthis.emitError(\n\t\t\t\tDataConnectionErrorType.MessageToBig,\n\t\t\t\t\"Message too big for JSON channel\",\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\tthis._bufferedSend(encodedData);\n\t}\n}\n","import { util } from \"./util\";\nimport logger, { LogLevel } from \"./logger\";\nimport { Socket } from \"./socket\";\nimport { MediaConnection } from \"./mediaconnection\";\nimport type { DataConnection } from \"./dataconnection/DataConnection\";\nimport {\n\tConnectionType,\n\tPeerErrorType,\n\tServerMessageType,\n\tSocketEventType,\n} from \"./enums\";\nimport type { ServerMessage } from \"./servermessage\";\nimport { API } from \"./api\";\nimport type {\n\tCallOption,\n\tPeerConnectOption,\n\tPeerJSOption,\n} from \"./optionInterfaces\";\nimport { BinaryPack } from \"./dataconnection/BufferedConnection/BinaryPack\";\nimport { Raw } from \"./dataconnection/BufferedConnection/Raw\";\nimport { Json } from \"./dataconnection/BufferedConnection/Json\";\n\nimport { EventEmitterWithError, PeerError } from \"./peerError\";\n\nclass PeerOptions implements PeerJSOption {\n\t/**\n\t * Prints log messages depending on the debug level passed in.\n\t */\n\tdebug?: LogLevel;\n\t/**\n\t * Server host. Defaults to `0.peerjs.com`.\n\t * Also accepts `'/'` to signify relative hostname.\n\t */\n\thost?: string;\n\t/**\n\t * Server port. Defaults to `443`.\n\t */\n\tport?: number;\n\t/**\n\t * The path where your self-hosted PeerServer is running. Defaults to `'/'`\n\t */\n\tpath?: string;\n\t/**\n\t * API key for the PeerServer.\n\t * This is not used anymore.\n\t * @deprecated\n\t */\n\tkey?: string;\n\ttoken?: string;\n\t/**\n\t * Configuration hash passed to RTCPeerConnection.\n\t * This hash contains any custom ICE/TURN server configuration.\n\t *\n\t * Defaults to {@apilink util.defaultConfig}\n\t */\n\tconfig?: any;\n\t/**\n\t * Set to true `true` if you're using TLS.\n\t * :::danger\n\t * If possible *always use TLS*\n\t * :::\n\t */\n\tsecure?: boolean;\n\tpingInterval?: number;\n\treferrerPolicy?: ReferrerPolicy;\n\tlogFunction?: (logLevel: LogLevel, ...rest: any[]) => void;\n\tserializers?: SerializerMapping;\n}\n\nexport { type PeerOptions };\n\nexport interface SerializerMapping {\n\t[key: string]: new (\n\t\tpeerId: string,\n\t\tprovider: Peer,\n\t\toptions: any,\n\t) => DataConnection;\n}\n\nexport interface PeerEvents {\n\t/**\n\t * Emitted when a connection to the PeerServer is established.\n\t *\n\t * You may use the peer before this is emitted, but messages to the server will be queued. <code>id</code> is the brokering ID of the peer (which was either provided in the constructor or assigned by the server).<span class='tip'>You should not wait for this event before connecting to other peers if connection speed is important.</span>\n\t */\n\topen: (id: string) => void;\n\t/**\n\t * Emitted when a new data connection is established from a remote peer.\n\t */\n\tconnection: (dataConnection: DataConnection) => void;\n\t/**\n\t * Emitted when a remote peer attempts to call you.\n\t */\n\tcall: (mediaConnection: MediaConnection) => void;\n\t/**\n\t * Emitted when the peer is destroyed and can no longer accept or create any new connections.\n\t */\n\tclose: () => void;\n\t/**\n\t * Emitted when the peer is disconnected from the signalling server\n\t */\n\tdisconnected: (currentId: string) => void;\n\t/**\n\t * Errors on the peer are almost always fatal and will destroy the peer.\n\t *\n\t * Errors from the underlying socket and PeerConnections are forwarded here.\n\t */\n\terror: (error: PeerError<`${PeerErrorType}`>) => void;\n}\n/**\n * A peer who can initiate connections with other peers.\n */\nexport class Peer extends EventEmitterWithError<PeerErrorType, PeerEvents> {\n\tprivate static readonly DEFAULT_KEY = \"peerjs\";\n\n\tprotected readonly _serializers: SerializerMapping = {\n\t\traw: Raw,\n\t\tjson: Json,\n\t\tbinary: BinaryPack,\n\t\t\"binary-utf8\": BinaryPack,\n\n\t\tdefault: BinaryPack,\n\t};\n\tprivate readonly _options: PeerOptions;\n\tprivate readonly _api: API;\n\tprivate readonly _socket: Socket;\n\n\tprivate _id: string | null = null;\n\tprivate _lastServerId: string | null = null;\n\n\t// States.\n\tprivate _destroyed = false; // Connections have been killed\n\tprivate _disconnected = false; // Connection to PeerServer killed but P2P connections still active\n\tprivate _open = false; // Sockets and such are not yet open.\n\tprivate readonly _connections: Map<\n\t\tstring,\n\t\t(DataConnection | MediaConnection)[]\n\t> = new Map(); // All connections for this peer.\n\tprivate readonly _lostMessages: Map<string, ServerMessage[]> = new Map(); // src => [list of messages]\n\t/**\n\t * The brokering ID of this peer\n\t *\n\t * If no ID was specified in {@apilink Peer | the constructor},\n\t * this will be `undefined` until the {@apilink PeerEvents | `open`} event is emitted.\n\t */\n\tget id() {\n\t\treturn this._id;\n\t}\n\n\tget options() {\n\t\treturn this._options;\n\t}\n\n\tget open() {\n\t\treturn this._open;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tget socket() {\n\t\treturn this._socket;\n\t}\n\n\t/**\n\t * A hash of all connections associated with this peer, keyed by the remote peer's ID.\n\t * @deprecated\n\t * Return type will change from Object to Map<string,[]>\n\t */\n\tget connections(): Object {\n\t\tconst plainConnections = Object.create(null);\n\n\t\tfor (const [k, v] of this._connections) {\n\t\t\tplainConnections[k] = v;\n\t\t}\n\n\t\treturn plainConnections;\n\t}\n\n\t/**\n\t * true if this peer and all of its connections can no longer be used.\n\t */\n\tget destroyed() {\n\t\treturn this._destroyed;\n\t}\n\t/**\n\t * false if there is an active connection to the PeerServer.\n\t */\n\tget disconnected() {\n\t\treturn this._disconnected;\n\t}\n\n\t/**\n\t * A peer can connect to other peers and listen for connections.\n\t */\n\tconstructor();\n\n\t/**\n\t * A peer can connect to other peers and listen for connections.\n\t * @param options for specifying details about PeerServer\n\t */\n\tconstructor(options: PeerOptions);\n\n\t/**\n\t * A peer can connect to other peers and listen for connections.\n\t * @param id Other peers can connect to this peer using the provided ID.\n\t *     If no ID is given, one will be generated by the brokering server.\n\t * The ID must start and end with an alphanumeric character (lower or upper case character or a digit). In the middle of the ID spaces, dashes (-) and underscores (_) are allowed. Use {@apilink PeerOptions.metadata } to send identifying information.\n\t * @param options for specifying details about PeerServer\n\t */\n\tconstructor(id: string, options?: PeerOptions);\n\n\tconstructor(id?: string | PeerOptions, options?: PeerOptions) {\n\t\tsuper();\n\n\t\tlet userId: string | undefined;\n\n\t\t// Deal with overloading\n\t\tif (id && id.constructor == Object) {\n\t\t\toptions = id as PeerOptions;\n\t\t} else if (id) {\n\t\t\tuserId = id.toString();\n\t\t}\n\n\t\t// Configurize options\n\t\toptions = {\n\t\t\tdebug: 0, // 1: Errors, 2: Warnings, 3: All logs\n\t\t\thost: util.CLOUD_HOST,\n\t\t\tport: util.CLOUD_PORT,\n\t\t\tpath: \"/\",\n\t\t\tkey: Peer.DEFAULT_KEY,\n\t\t\ttoken: util.randomToken(),\n\t\t\tconfig: util.defaultConfig,\n\t\t\treferrerPolicy: \"strict-origin-when-cross-origin\",\n\t\t\tserializers: {},\n\t\t\t...options,\n\t\t};\n\t\tthis._options = options;\n\t\tthis._serializers = { ...this._serializers, ...this.options.serializers };\n\n\t\t// Detect relative URL host.\n\t\tif (this._options.host === \"/\") {\n\t\t\tthis._options.host = window.location.hostname;\n\t\t}\n\n\t\t// Set path correctly.\n\t\tif (this._options.path) {\n\t\t\tif (this._options.path[0] !== \"/\") {\n\t\t\t\tthis._options.path = \"/\" + this._options.path;\n\t\t\t}\n\t\t\tif (this._options.path[this._options.path.length - 1] !== \"/\") {\n\t\t\t\tthis._options.path += \"/\";\n\t\t\t}\n\t\t}\n\n\t\t// Set whether we use SSL to same as current host\n\t\tif (\n\t\t\tthis._options.secure === undefined &&\n\t\t\tthis._options.host !== util.CLOUD_HOST\n\t\t) {\n\t\t\tthis._options.secure = util.isSecure();\n\t\t} else if (this._options.host == util.CLOUD_HOST) {\n\t\t\tthis._options.secure = true;\n\t\t}\n\t\t// Set a custom log function if present\n\t\tif (this._options.logFunction) {\n\t\t\tlogger.setLogFunction(this._options.logFunction);\n\t\t}\n\n\t\tlogger.logLevel = this._options.debug || 0;\n\n\t\tthis._api = new API(options);\n\t\tthis._socket = this._createServerConnection();\n\n\t\t// Sanity checks\n\t\t// Ensure WebRTC supported\n\t\tif (!util.supports.audioVideo && !util.supports.data) {\n\t\t\tthis._delayedAbort(\n\t\t\t\tPeerErrorType.BrowserIncompatible,\n\t\t\t\t\"The current browser does not support WebRTC\",\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\t// Ensure alphanumeric id\n\t\tif (!!userId && !util.validateId(userId)) {\n\t\t\tthis._delayedAbort(PeerErrorType.InvalidID, `ID \"${userId}\" is invalid`);\n\t\t\treturn;\n\t\t}\n\n\t\tif (userId) {\n\t\t\tthis._initialize(userId);\n\t\t} else {\n\t\t\tthis._api\n\t\t\t\t.retrieveId()\n\t\t\t\t.then((id) => this._initialize(id))\n\t\t\t\t.catch((error) => this._abort(PeerErrorType.ServerError, error));\n\t\t}\n\t}\n\n\tprivate _createServerConnection(): Socket {\n\t\tconst socket = new Socket(\n\t\t\tthis._options.secure,\n\t\t\tthis._options.host!,\n\t\t\tthis._options.port!,\n\t\t\tthis._options.path!,\n\t\t\tthis._options.key!,\n\t\t\tthis._options.pingInterval,\n\t\t);\n\n\t\tsocket.on(SocketEventType.Message, (data: ServerMessage) => {\n\t\t\tthis._handleMessage(data);\n\t\t});\n\n\t\tsocket.on(SocketEventType.Error, (error: string) => {\n\t\t\tthis._abort(PeerErrorType.SocketError, error);\n\t\t});\n\n\t\tsocket.on(SocketEventType.Disconnected, () => {\n\t\t\tif (this.disconnected) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.emitError(PeerErrorType.Network, \"Lost connection to server.\");\n\t\t\tthis.disconnect();\n\t\t});\n\n\t\tsocket.on(SocketEventType.Close, () => {\n\t\t\tif (this.disconnected) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._abort(\n\t\t\t\tPeerErrorType.SocketClosed,\n\t\t\t\t\"Underlying socket is already closed.\",\n\t\t\t);\n\t\t});\n\n\t\treturn socket;\n\t}\n\n\t/** Initialize a connection with the server. */\n\tprivate _initialize(id: string): void {\n\t\tthis._id = id;\n\t\tthis.socket.start(id, this._options.token!);\n\t}\n\n\t/** Handles messages from the server. */\n\tprivate _handleMessage(message: ServerMessage): void {\n\t\tconst type = message.type;\n\t\tconst payload = message.payload;\n\t\tconst peerId = message.src;\n\n\t\tswitch (type) {\n\t\t\tcase ServerMessageType.Open: // The connection to the server is open.\n\t\t\t\tthis._lastServerId = this.id;\n\t\t\t\tthis._open = true;\n\t\t\t\tthis.emit(\"open\", this.id);\n\t\t\t\tbreak;\n\t\t\tcase ServerMessageType.Error: // Server error.\n\t\t\t\tthis._abort(PeerErrorType.ServerError, payload.msg);\n\t\t\t\tbreak;\n\t\t\tcase ServerMessageType.IdTaken: // The selected ID is taken.\n\t\t\t\tthis._abort(PeerErrorType.UnavailableID, `ID \"${this.id}\" is taken`);\n\t\t\t\tbreak;\n\t\t\tcase ServerMessageType.InvalidKey: // The given API key cannot be found.\n\t\t\t\tthis._abort(\n\t\t\t\t\tPeerErrorType.InvalidKey,\n\t\t\t\t\t`API KEY \"${this._options.key}\" is invalid`,\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase ServerMessageType.Leave: // Another peer has closed its connection to this peer.\n\t\t\t\tlogger.log(`Received leave message from ${peerId}`);\n\t\t\t\tthis._cleanupPeer(peerId);\n\t\t\t\tthis._connections.delete(peerId);\n\t\t\t\tbreak;\n\t\t\tcase ServerMessageType.Expire: // The offer sent to a peer has expired without response.\n\t\t\t\tthis.emitError(\n\t\t\t\t\tPeerErrorType.PeerUnavailable,\n\t\t\t\t\t`Could not connect to peer ${peerId}`,\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase ServerMessageType.Offer: {\n\t\t\t\t// we should consider switching this to CALL/CONNECT, but this is the least breaking option.\n\t\t\t\tconst connectionId = payload.connectionId;\n\t\t\t\tlet connection = this.getConnection(peerId, connectionId);\n\n\t\t\t\tif (connection) {\n\t\t\t\t\tconnection.close();\n\t\t\t\t\tlogger.warn(\n\t\t\t\t\t\t`Offer received for existing Connection ID:${connectionId}`,\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// Create a new connection.\n\t\t\t\tif (payload.type === ConnectionType.Media) {\n\t\t\t\t\tconst mediaConnection = new MediaConnection(peerId, this, {\n\t\t\t\t\t\tconnectionId: connectionId,\n\t\t\t\t\t\t_payload: payload,\n\t\t\t\t\t\tmetadata: payload.metadata,\n\t\t\t\t\t});\n\t\t\t\t\tconnection = mediaConnection;\n\t\t\t\t\tthis._addConnection(peerId, connection);\n\t\t\t\t\tthis.emit(\"call\", mediaConnection);\n\t\t\t\t} else if (payload.type === ConnectionType.Data) {\n\t\t\t\t\tconst dataConnection = new this._serializers[payload.serialization](\n\t\t\t\t\t\tpeerId,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconnectionId: connectionId,\n\t\t\t\t\t\t\t_payload: payload,\n\t\t\t\t\t\t\tmetadata: payload.metadata,\n\t\t\t\t\t\t\tlabel: payload.label,\n\t\t\t\t\t\t\tserialization: payload.serialization,\n\t\t\t\t\t\t\treliable: payload.reliable,\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\t\t\t\t\tconnection = dataConnection;\n\n\t\t\t\t\tthis._addConnection(peerId, connection);\n\t\t\t\t\tthis.emit(\"connection\", dataConnection);\n\t\t\t\t} else {\n\t\t\t\t\tlogger.warn(`Received malformed connection type:${payload.type}`);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Find messages.\n\t\t\t\tconst messages = this._getMessages(connectionId);\n\t\t\t\tfor (const message of messages) {\n\t\t\t\t\tconnection.handleMessage(message);\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdefault: {\n\t\t\t\tif (!payload) {\n\t\t\t\t\tlogger.warn(\n\t\t\t\t\t\t`You received a malformed message from ${peerId} of type ${type}`,\n\t\t\t\t\t);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst connectionId = payload.connectionId;\n\t\t\t\tconst connection = this.getConnection(peerId, connectionId);\n\n\t\t\t\tif (connection && connection.peerConnection) {\n\t\t\t\t\t// Pass it on.\n\t\t\t\t\tconnection.handleMessage(message);\n\t\t\t\t} else if (connectionId) {\n\t\t\t\t\t// Store for possible later use\n\t\t\t\t\tthis._storeMessage(connectionId, message);\n\t\t\t\t} else {\n\t\t\t\t\tlogger.warn(\"You received an unrecognized message:\", message);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t/** Stores messages without a set up connection, to be claimed later. */\n\tprivate _storeMessage(connectionId: string, message: ServerMessage): void {\n\t\tif (!this._lostMessages.has(connectionId)) {\n\t\t\tthis._lostMessages.set(connectionId, []);\n\t\t}\n\n\t\tthis._lostMessages.get(connectionId).push(message);\n\t}\n\n\t/**\n\t * Retrieve messages from lost message store\n\t * @internal\n\t */\n\t//TODO Change it to private\n\tpublic _getMessages(connectionId: string): ServerMessage[] {\n\t\tconst messages = this._lostMessages.get(connectionId);\n\n\t\tif (messages) {\n\t\t\tthis._lostMessages.delete(connectionId);\n\t\t\treturn messages;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\t/**\n\t * Connects to the remote peer specified by id and returns a data connection.\n\t * @param peer The brokering ID of the remote peer (their {@apilink Peer.id}).\n\t * @param options for specifying details about Peer Connection\n\t */\n\tconnect(peer: string, options: PeerConnectOption = {}): DataConnection {\n\t\toptions = {\n\t\t\tserialization: \"default\",\n\t\t\t...options,\n\t\t};\n\t\tif (this.disconnected) {\n\t\t\tlogger.warn(\n\t\t\t\t\"You cannot connect to a new Peer because you called \" +\n\t\t\t\t\t\".disconnect() on this Peer and ended your connection with the \" +\n\t\t\t\t\t\"server. You can create a new Peer to reconnect, or call reconnect \" +\n\t\t\t\t\t\"on this peer if you believe its ID to still be available.\",\n\t\t\t);\n\t\t\tthis.emitError(\n\t\t\t\tPeerErrorType.Disconnected,\n\t\t\t\t\"Cannot connect to new Peer after disconnecting from server.\",\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tconst dataConnection = new this._serializers[options.serialization](\n\t\t\tpeer,\n\t\t\tthis,\n\t\t\toptions,\n\t\t);\n\t\tthis._addConnection(peer, dataConnection);\n\t\treturn dataConnection;\n\t}\n\n\t/**\n\t * Calls the remote peer specified by id and returns a media connection.\n\t * @param peer The brokering ID of the remote peer (their peer.id).\n\t * @param stream The caller's media stream\n\t * @param options Metadata associated with the connection, passed in by whoever initiated the connection.\n\t */\n\tcall(\n\t\tpeer: string,\n\t\tstream: MediaStream,\n\t\toptions: CallOption = {},\n\t): MediaConnection {\n\t\tif (this.disconnected) {\n\t\t\tlogger.warn(\n\t\t\t\t\"You cannot connect to a new Peer because you called \" +\n\t\t\t\t\t\".disconnect() on this Peer and ended your connection with the \" +\n\t\t\t\t\t\"server. You can create a new Peer to reconnect.\",\n\t\t\t);\n\t\t\tthis.emitError(\n\t\t\t\tPeerErrorType.Disconnected,\n\t\t\t\t\"Cannot connect to new Peer after disconnecting from server.\",\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!stream) {\n\t\t\tlogger.error(\n\t\t\t\t\"To call a peer, you must provide a stream from your browser's `getUserMedia`.\",\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tconst mediaConnection = new MediaConnection(peer, this, {\n\t\t\t...options,\n\t\t\t_stream: stream,\n\t\t});\n\t\tthis._addConnection(peer, mediaConnection);\n\t\treturn mediaConnection;\n\t}\n\n\t/** Add a data/media connection to this peer. */\n\tprivate _addConnection(\n\t\tpeerId: string,\n\t\tconnection: MediaConnection | DataConnection,\n\t): void {\n\t\tlogger.log(\n\t\t\t`add connection ${connection.type}:${connection.connectionId} to peerId:${peerId}`,\n\t\t);\n\n\t\tif (!this._connections.has(peerId)) {\n\t\t\tthis._connections.set(peerId, []);\n\t\t}\n\t\tthis._connections.get(peerId).push(connection);\n\t}\n\n\t//TODO should be private\n\t_removeConnection(connection: DataConnection | MediaConnection): void {\n\t\tconst connections = this._connections.get(connection.peer);\n\n\t\tif (connections) {\n\t\t\tconst index = connections.indexOf(connection);\n\n\t\t\tif (index !== -1) {\n\t\t\t\tconnections.splice(index, 1);\n\t\t\t}\n\t\t}\n\n\t\t//remove from lost messages\n\t\tthis._lostMessages.delete(connection.connectionId);\n\t}\n\n\t/** Retrieve a data/media connection for this peer. */\n\tgetConnection(\n\t\tpeerId: string,\n\t\tconnectionId: string,\n\t): null | DataConnection | MediaConnection {\n\t\tconst connections = this._connections.get(peerId);\n\t\tif (!connections) {\n\t\t\treturn null;\n\t\t}\n\n\t\tfor (const connection of connections) {\n\t\t\tif (connection.connectionId === connectionId) {\n\t\t\t\treturn connection;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tprivate _delayedAbort(type: PeerErrorType, message: string | Error): void {\n\t\tsetTimeout(() => {\n\t\t\tthis._abort(type, message);\n\t\t}, 0);\n\t}\n\n\t/**\n\t * Emits an error message and destroys the Peer.\n\t * The Peer is not destroyed if it's in a disconnected state, in which case\n\t * it retains its disconnected state and its existing connections.\n\t */\n\tprivate _abort(type: PeerErrorType, message: string | Error): void {\n\t\tlogger.error(\"Aborting!\");\n\n\t\tthis.emitError(type, message);\n\n\t\tif (!this._lastServerId) {\n\t\t\tthis.destroy();\n\t\t} else {\n\t\t\tthis.disconnect();\n\t\t}\n\t}\n\n\t/**\n\t * Destroys the Peer: closes all active connections as well as the connection\n\t * to the server.\n\t *\n\t * :::caution\n\t * This cannot be undone; the respective peer object will no longer be able\n\t * to create or receive any connections, its ID will be forfeited on the server,\n\t * and all of its data and media connections will be closed.\n\t * :::\n\t */\n\tdestroy(): void {\n\t\tif (this.destroyed) {\n\t\t\treturn;\n\t\t}\n\n\t\tlogger.log(`Destroy peer with ID:${this.id}`);\n\n\t\tthis.disconnect();\n\t\tthis._cleanup();\n\n\t\tthis._destroyed = true;\n\n\t\tthis.emit(\"close\");\n\t}\n\n\t/** Disconnects every connection on this peer. */\n\tprivate _cleanup(): void {\n\t\tfor (const peerId of this._connections.keys()) {\n\t\t\tthis._cleanupPeer(peerId);\n\t\t\tthis._connections.delete(peerId);\n\t\t}\n\n\t\tthis.socket.removeAllListeners();\n\t}\n\n\t/** Closes all connections to this peer. */\n\tprivate _cleanupPeer(peerId: string): void {\n\t\tconst connections = this._connections.get(peerId);\n\n\t\tif (!connections) return;\n\n\t\tfor (const connection of connections) {\n\t\t\tconnection.close();\n\t\t}\n\t}\n\n\t/**\n\t * Disconnects the Peer's connection to the PeerServer. Does not close any\n\t *  active connections.\n\t * Warning: The peer can no longer create or accept connections after being\n\t *  disconnected. It also cannot reconnect to the server.\n\t */\n\tdisconnect(): void {\n\t\tif (this.disconnected) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentId = this.id;\n\n\t\tlogger.log(`Disconnect peer with ID:${currentId}`);\n\n\t\tthis._disconnected = true;\n\t\tthis._open = false;\n\n\t\tthis.socket.close();\n\n\t\tthis._lastServerId = currentId;\n\t\tthis._id = null;\n\n\t\tthis.emit(\"disconnected\", currentId);\n\t}\n\n\t/** Attempts to reconnect with the same ID.\n\t *\n\t * Only {@apilink Peer.disconnect | disconnected peers} can be reconnected.\n\t * Destroyed peers cannot be reconnected.\n\t * If the connection fails (as an example, if the peer's old ID is now taken),\n\t * the peer's existing connections will not close, but any associated errors events will fire.\n\t */\n\treconnect(): void {\n\t\tif (this.disconnected && !this.destroyed) {\n\t\t\tlogger.log(\n\t\t\t\t`Attempting reconnection to server with ID ${this._lastServerId}`,\n\t\t\t);\n\t\t\tthis._disconnected = false;\n\t\t\tthis._initialize(this._lastServerId!);\n\t\t} else if (this.destroyed) {\n\t\t\tthrow new Error(\n\t\t\t\t\"This peer cannot reconnect to the server. It has already been destroyed.\",\n\t\t\t);\n\t\t} else if (!this.disconnected && !this.open) {\n\t\t\t// Do nothing. We're still connecting the first time.\n\t\t\tlogger.error(\n\t\t\t\t\"In a hurry? We're still trying to make the initial connection!\",\n\t\t\t);\n\t\t} else {\n\t\t\tthrow new Error(\n\t\t\t\t`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`,\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Get a list of available peer IDs. If you're running your own server, you'll\n\t * want to set allow_discovery: true in the PeerServer options. If you're using\n\t * the cloud server, email team@peerjs.com to get the functionality enabled for\n\t * your key.\n\t */\n\tlistAllPeers(cb = (_: any[]) => {}): void {\n\t\tthis._api\n\t\t\t.listAllPeers()\n\t\t\t.then((peers) => cb(peers))\n\t\t\t.catch((error) => this._abort(PeerErrorType.ServerError, error));\n\t}\n}\n","export { util, type Util } from \"./util\";\nimport { Peer } from \"./peer\";\nimport { MsgPackPeer } from \"./msgPackPeer\";\n\nexport type { PeerEvents, PeerOptions } from \"./peer\";\n\nexport type {\n\tPeerJSOption,\n\tPeerConnectOption,\n\tAnswerOption,\n\tCallOption,\n} from \"./optionInterfaces\";\nexport type { UtilSupportsObj } from \"./util\";\nexport type { DataConnection } from \"./dataconnection/DataConnection\";\nexport type { MediaConnection } from \"./mediaconnection\";\nexport type { LogLevel } from \"./logger\";\nexport * from \"./enums\";\n\nexport { BufferedConnection } from \"./dataconnection/BufferedConnection/BufferedConnection\";\nexport { StreamConnection } from \"./dataconnection/StreamConnection/StreamConnection\";\nexport { MsgPack } from \"./dataconnection/StreamConnection/MsgPack\";\nexport type { SerializerMapping } from \"./peer\";\n\nexport { Peer, MsgPackPeer };\n\nexport { PeerError } from \"./peerError\";\nexport default Peer;\n","<template>\r\n  <div class=\"room\"> \r\n    <AppAlert v-if=\"alertMessage.visible\" @hide=\"isVisibleAlertMessageHideFunc\" :message=\"alertMessage.message\"/>\r\n\r\n      <div class=\"room__inner\">\r\n        \r\n        <div class=\"room__inner-info\">\r\n          <div id=\"video__grid\" class=\"video__grid\">\r\n\r\n            <AppVideo \r\n              v-for=\"video in videos\"\r\n              :key=\"video.user\"\r\n              :srcObject=\"video.stream\"\r\n              :muted=\"video.peerID === user.id\"\r\n              :videoID=\"`${video.peerID}`\"\r\n              :name=\"video.username\"\r\n              \r\n              :isMe=\"video.isMe || false\"\r\n              \r\n              :audioActive=\"!video.audioEnabled\"\r\n              :videoActive=\"!video.videoEnabled\"\r\n              :headphoneActive=\"!video.videoHeadphone\"\r\n              :screenShareActive=\"!video.videoScreenShare\"\r\n            />\r\n\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"video__input\">\r\n          <!-- Аудио Видео ВКЛ -->\r\n          <template v-if=\"user.inputEnabled\">\r\n            <button  class=\"btn\" :class=\"{'svg__icon--disabled': !user.audio.enabled}\" @click.prevent=\"toggleAudio\"><font-awesome-icon icon=\"microphone\"/></button>\r\n            <button  class=\"btn\" :class=\"{'svg__icon--disabled': !user.video.enabled}\" @click.prevent=\"toggleVideo\"><font-awesome-icon icon=\"video\"/></button>\r\n            <button  class=\"btn\" :class=\"{'svg__icon--disabled': !user.headphone.enabled}\" @click.prevent=\"toggleheadphone\"><font-awesome-icon icon=\"headphones\"/></button>\r\n            <button  class=\"btn\" :class=\"{'svg__icon--active': !user.screenshare.enabled}\" @click.prevent=\"toggleScreenShare\"><font-awesome-icon icon=\"display\"/></button>\r\n          </template>\r\n          <!-- Аудио Видео ВЫКЛ -->\r\n          <template v-else>\r\n            <button  class=\"btn\" @click.prevent=\"copyKeyRoom\">Включить микрофон</button >\r\n            <button  class=\"btn\" :class=\"{'svg__icon--disabled': input.audioEnabled }\" @click.prevent=\"input.audioEnabled = !input.audioEnabled, videoToggleSound(input.audioEnabled)\"><font-awesome-icon icon=\"headphones\"/></button>\r\n          </template>\r\n          <button  class=\"btn\" @click.prevent=\"copyKeyRoom\"><font-awesome-icon icon=\"copy\"/></button >\r\n          <button  class=\"btn\" @click.prevent=\"router.push('/room-finished')\"><font-awesome-icon icon=\"phone\"/></button>\r\n          </div>\r\n      </div>\r\n\r\n      <!-- Right Side -->\r\n      <!-- <AppArrow class=\"room__exit\" v-if=\"room.sideActive\" :class=\"{ 'room__exit--active': room.sideActive }\" @click.prevent=\"room.sideActive = !room.sideActive\"/> -->\r\n      <font-awesome-icon class=\"room__exit\" icon=\"arrow-right\" v-if=\"room.sideActive\" @click.prevent=\"room.sideActive = !room.sideActive\"/>\r\n      <div class=\"room__side\" v-if=\"!room.sideActive\">\r\n        <div class=\"room__chat-container\">\r\n          <div class=\"room__chat-header\">\r\n            <!-- <AppArrow class=\"room__exit\" :class=\"{ 'room__exit--active': room.sideActive }\" @click.prevent=\"room.sideActive = !room.sideActive\"/> -->\r\n            <font-awesome-icon class=\"room__exit\" icon=\"arrow-left\" @click.prevent=\"room.sideActive = !room.sideActive\"/>\r\n            <AppLogo :enabled=\"false\"></AppLogo>:\r\n            <h4 class=\"room__side-name\">{{ room.name }}</h4> \r\n          </div>\r\n          <div class=\"room__chat-area\">\r\n            <div class=\"room__chat-messages\">\r\n\r\n              <div v-for=\"(msg, idx) in room.messages\" :key=\"idx\">\r\n                <ChatMessage\r\n                  :message=\"msg['message']\"\r\n                  :username=\"msg['username']\"\r\n                  :my=\"user.id === msg['peerID']\"\r\n                />\r\n              </div>\r\n\r\n            </div>\r\n            <div class=\"room__chat-area__wrapper\">\r\n              <div class=\"room__chat-area__typing\">\r\n                <input v-model=\"room.inputMessage\" @keyup.enter=\"submitMessage\" type=\"text\" placeholder=\"Введите сообщение...\" class=\"input--text\" />\r\n                <button class=\"btn\" @click.prevent=\"submitMessage\">\r\n                  <font-awesome-icon icon=\"message\" />\r\n                  <!-- <AppMessage /> -->\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        </div>\r\n    <!-- </div> -->\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n  import AppLogo from \"@/components/AppLogo.vue\"\r\n  import AppVideo from \"@/components/AppVideo.vue\" // Видео\r\n  // import AppNoVideo from \"@/components/AppNoVideo\" // Без видео\r\n  import ChatMessage from \"@/components/chat/ChatMessage.vue\"\r\n  import AppAlert from \"@/components/AppAlert.vue\"\r\n  import { onUnmounted, onMounted, ref } from \"vue\"\r\n  import { useRoute, useRouter } from \"vue-router\"\r\n  import { v4 as uuidV4 } from \"uuid\"\r\n  import socketIOClient from \"socket.io-client\"\r\n  import Peer from \"peerjs\"\r\n  import { useStore } from \"vuex\"\r\n\r\n  // Глобальные переменные\r\n  const store = useStore()\r\n  // Адрес сервера \r\n  const WS = store.state.ws\r\n  // Подключение к серверу \r\n  const ws = socketIOClient(WS)\r\n  // Текущий роут\r\n  const route= useRoute()\r\n  const router = useRouter()\r\n  // Пользователь\r\n  const meID = uuidV4() \r\n  const user = ref({\r\n    id: meID,\r\n    peerID: new Peer(meID),\r\n    inputEnabled: false, // Показ кнопок\r\n    stream: null,\r\n    audio: { enabled: null, },\r\n    video: { enabled: null, },\r\n    headphone: { enabled: null, },\r\n    screenshare: { enabled: null, stream: null }\r\n  })\r\n  // Комната\r\n  const room = ref({\r\n    id: route.query.roomID,\r\n    name: route.query.name,\r\n    sideActive: false,\r\n    messages: [],\r\n    inputMessage: \"\",\r\n    interval: {\r\n      enabled: true, \r\n      size: 2000, \r\n    }\r\n  })\r\n  // Кнопки\r\n  const input = ref({\r\n    audioEnabled: false,\r\n  })\r\n  // Все видео\r\n  const videos = ref([])\r\n  // const noVideos = ref([])\r\n  // Предупреждение \r\n  const alertMessage = ref({\r\n    message: \"\",\r\n    visible: false,\r\n  })\r\n  const oldParticipants = ref([]) // Пользователи которые уже были когда мы зашли\r\n\r\n\r\n  // ========== ВИДЕО\r\n  // Пользователь без видео\r\n// const createdCard = ({ peerID, username }) => {\r\n  // const findUserNoVideos = noVideos.value.find((e) => e.peerID === peerID);\r\n  // const findUserVideos = videos.value.find((e) => e.peerID === peerID);\r\n\r\n  // Если пользователь уже существует в noVideos или videos, то ничего не делаем\r\n  // if (findUserNoVideos || findUserVideos) {\r\n    // return;\r\n  // }\r\n\r\n  // Добавляем пользователя в noVideos, если он не найден\r\n  // noVideos.value.push({ peerID, username: username || \"Без имени\" });\r\n// };\r\n  // ========---------========\r\n  \r\n  // Функция создания пустого видео\r\n  const createEmptyStream = ({ username, peerID }) => {\r\n    // Создаем пустой аудио-контекст и генератор сигнала\r\n    const  audioContext = new AudioContext();\r\n    const oscillator = audioContext.createOscillator();\r\n    const dst = audioContext.createMediaStreamDestination();\r\n\r\n    oscillator.connect(dst);\r\n    oscillator.start();\r\n    const audioTrack = dst.stream.getAudioTracks()[0];\r\n    // Создаем пустой видеопоток, используя canvas\r\n    const canvas = document.createElement(\"canvas\");\r\n    canvas.width = 1;\r\n    canvas.height = 1;\r\n    const videoStream = canvas.captureStream();\r\n    const videoTrack = videoStream.getVideoTracks()[0];\r\n\r\n    // Возвращаем новый MediaStream, состоящий из пустых аудио и видео треков\r\n    return { stream: new MediaStream([audioTrack, videoTrack]), username, peerID }\r\n  }\r\n  // ========---------========\r\n  \r\n  // Создание видео \r\n// Создание видео для пользователя\r\nconst createdVideo = ({ stream, peerID, username, audio, video, headphone, screenshare, isMe }) => {\r\n  const findUserVideos = videos.value.find((e) => e.peerID === peerID);\r\n\r\n  // Если пользователь уже существует в videos, обновляем его данные\r\n  if (findUserVideos) {\r\n    findUserVideos.stream = stream || new MediaStream();\r\n    findUserVideos.audioEnabled = audio !== undefined ? audio : true;\r\n    findUserVideos.videoEnabled = video !== undefined ? video : true;\r\n    findUserVideos.videoHeadphone = headphone !== undefined ? headphone : true;\r\n    findUserVideos.videoScreenShare = screenshare !== undefined ? screenshare : true;\r\n    return;\r\n  }\r\n\r\n  // Удаляем пользователя из noVideos, если он уже был там\r\n  // noVideos.value = noVideos.value.filter((e) => e.peerID !== peerID);\r\n\r\n  let videoObject = {}\r\n  if (!stream) {\r\n    const emptyStream = createEmptyStream({ username, peerID })\r\n    videoObject = {\r\n      isMe: isMe !== undefined ? isMe : false,\r\n      stream: emptyStream.stream,\r\n      peerID,\r\n      username: username || \"Без имени\",\r\n      audioEnabled: audio !== undefined ? audio : true,\r\n      videoEnabled: video !== undefined ? video : true,\r\n      videoHeadphone: headphone !== undefined ? headphone : true,\r\n      videoScreenShare: screenshare !== undefined ? screenshare : true,\r\n    }\r\n  } else {\r\n    videoObject = {\r\n      isMe: isMe !== undefined ? isMe : false,\r\n      stream: stream,\r\n      peerID,\r\n      username: username || \"Без имени\",\r\n      audioEnabled: audio !== undefined ? audio : true,\r\n      videoEnabled: video !== undefined ? video : true,\r\n      videoHeadphone: headphone !== undefined ? headphone : true,\r\n      videoScreenShare: screenshare !== undefined ? screenshare : true,\r\n    }\r\n  }\r\n  videos.value.push(videoObject)\r\n\r\n  // videos.value.push({\r\n  //   isMe: isMe !== undefined ? isMe : false,\r\n  //   stream: stream || emptyStream,\r\n  //   peerID,\r\n  //   username: username || \"Без имени\",\r\n  //   audioEnabled: audio !== undefined ? audio : true,\r\n  //   videoEnabled: video !== undefined ? video : true,\r\n  //   videoHeadphone: headphone !== undefined ? headphone : true,\r\n  //   videoScreenShare: screenshare !== undefined ? screenshare : true,\r\n  // });\r\n};\r\n  // ========---------========\r\n\r\n  // Функция удаления видео\r\n  // Удаление видео пользователя\r\n// const removeVideo = (peerID) => {\r\n  // Находим и удаляем элемент из массива видео\r\n  // videos.value = videos.value.filter((e) => e.peerID !== peerID);\r\n  // Также удаляем из noVideos, если такой пользователь был\r\n  // noVideos.value = noVideos.value.filter((e) => e.peerID !== peerID);\r\n// };\r\n  \r\n  const removeVideo = (peerID) => {\r\n    const videoElementBox = document.getElementById(peerID)\r\n    if (videoElementBox) {\r\n      videoElementBox.childNodes[0].srcObject.getTracks().forEach(track => track.stop())  // Остановка всех потоков\r\n      videoElementBox.remove()\r\n    }\r\n  }\r\n  // ========---------========\r\n  // ========== END ВИДЕО\r\n\r\n\r\n\r\n  // ========== КНОПКИ ВКЛ\\ВЫКЛ (МИКРОФОН КАМЕРА НАУШНИКИ ТД)\r\n  // Отключение звука микрофона\r\n  const toggleAudio = () => {\r\n    const audioEnabled = !user.value.audio.enabled\r\n    user.value.audio.enabled = audioEnabled\r\n    toggleTracks(user.value.stream.getAudioTracks(), audioEnabled)\r\n    ws.emit(\"toggle-audio-room\", { roomID: room.value.id, peerID: user.value.id, enabled: audioEnabled })\r\n  }\r\n  // ========---------========\r\n\r\n  // Отключение у определенного элемента\r\n  ws.on(\"toggle-audio-room\", ({ peerID, enabled }) => {\r\n    const userIndex = userFindIndex({ peerID: peerID })\r\n    if (userIndex !== -1) { videos.value[userIndex].audioEnabled = enabled; }\r\n  })\r\n  // ========---------========\r\n\r\n  // Отключение видео\r\n  const toggleVideo = () => {\r\n    const videoEnabled = !user.value.video.enabled\r\n    user.value.video.enabled = videoEnabled\r\n    toggleTracks(user.value.stream.getVideoTracks(), videoEnabled);\r\n    ws.emit(\"toggle-video-room\", { roomID: room.value.id, peerID: user.value.id, enabled: videoEnabled })\r\n  }\r\n  // ========---------========\r\n\r\n  // Отключение у определенного элемента\r\n  ws.on(\"toggle-video-room\", ({ peerID, enabled }) => {\r\n    const userIndex = userFindIndex({ peerID: peerID })\r\n    if (userIndex !== -1) { videos.value[userIndex].videoEnabled = enabled; }\r\n  })\r\n  // ========---------========\r\n\r\n  // Отключить звук\r\n  const toggleheadphone = () => {\r\n    // user.value.headphone.enabled = !user.value.headphone.enabled\r\n    const videoHeadphone = !user.value.headphone.enabled\r\n    user.value.headphone.enabled = videoHeadphone\r\n    // Выкл\r\n    if (!videoHeadphone) {\r\n      if (user.value.audio.enabled) { toggleAudio() }\r\n      videoToggleSound(true)\r\n    } else { // Вкл\r\n      videoToggleSound(false)\r\n    }\r\n    ws.emit(\"toggle-headphone-room\", { roomID: room.value.id, peerID: user.value.id, enabled: videoHeadphone })\r\n  }\r\n  // ========---------========\r\n\r\n  // Отключение у определенного элемента\r\n  ws.on(\"toggle-headphone-room\", ({ peerID, enabled }) => {\r\n    const userIndex = userFindIndex({ peerID: peerID })\r\n    if (userIndex !== -1) { videos.value[userIndex].videoHeadphone = enabled; }\r\n  })\r\n  // ========---------========\r\n\r\n    // Вкл\\Выкл трансляция экрана\r\n  const toggleScreenShare = async () => {\r\n    const videoScreenShare = !user.value.screenshare.enabled\r\n    user.value.screenshare.enabled = videoScreenShare\r\n    if (!videoScreenShare) { // Вкл\r\n      try {\r\n        const streamRes = await navigator.mediaDevices.getDisplayMedia({ video: true, audio: false });\r\n        const videoTrack = streamRes.getVideoTracks()[0]\r\n        const audioTracks = user.value.stream.getAudioTracks()\r\n        const combinedStream = new MediaStream([videoTrack, ...audioTracks]);\r\n        user.value.stream = combinedStream;\r\n        document.getElementById(`${user.value.id}--video`).srcObject = user.value.stream\r\n        user.value.screenshare.enabled = false;\r\n      } catch (error) {\r\n        console.error(\"Error accessing display media:\", error);\r\n        user.value.screenshare.enabled = true;\r\n        const streamRes = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });\r\n        const videoTrack = streamRes.getVideoTracks()[0];\r\n        const audioTracks = user.value.stream.getAudioTracks();\r\n        const combinedStream = new MediaStream([videoTrack, ...audioTracks]);\r\n        user.value.stream = combinedStream;\r\n        // document.querySelector(\".video--my\").srcObject = user.value.stream;\r\n        // document.getElementById(`${user.value.id}--video`).firstChild.srcObject = user.value.stream\r\n        document.getElementById(`${user.value.id}--video`).srcObject = user.value.stream\r\n      }\r\n    } else { // Выкл\r\n      user.value.stream.getVideoTracks().forEach((e) => e.stop())\r\n      const streamRes = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });\r\n      const videoTrack = streamRes.getVideoTracks()[0];\r\n      const audioTracks = user.value.stream.getAudioTracks();\r\n      const combinedStream = new MediaStream([videoTrack, ...audioTracks]);\r\n      user.value.stream = combinedStream;\r\n      // document.querySelector(\".video--my\").srcObject = user.value.stream\r\n      // document.getElementById(`${user.value.id}--video`).firstChild.srcObject = user.value.stream\r\n      document.getElementById(`${user.value.id}--video`).srcObject = user.value.stream\r\n      user.value.screenshare.enabled = true\r\n    }\r\n\r\n    ws.emit(\"toggle-screnshare-room\", { roomID: room.value.id, peerID: user.value.id, enabled: videoScreenShare })\r\n    // ========---------========\r\n\r\n    // Replace video track in existing peer connections\r\n    Object.keys(user.value.peerID?.connections).forEach((connectionKey) => {\r\n      const connection = user.value.peerID.connections[connectionKey]\r\n      if (connection && connection[0] && connection[0].peerConnection) {\r\n        const videoTrack = user.value.stream?.getTracks().find((track) => track.kind === \"video\");\r\n        if (videoTrack) {\r\n          connection[0].peerConnection.getSenders().forEach((sender) => {\r\n            if (sender.track && sender.track.kind === \"video\") {\r\n              sender.replaceTrack(videoTrack).catch((err) => {\r\n                console.log(\"Error replacing video track:\", err)\r\n              });\r\n            }\r\n          });\r\n        }\r\n      } else {  \r\n        console.log(\"Invalid connection:\", connection);\r\n      }\r\n    });\r\n    // ========---------========\r\n    \r\n    // Update audio and video track states\r\n    toggleTracks(user.value.stream.getAudioTracks(), user.value.audio.enabled);\r\n    toggleTracks(user.value.stream.getVideoTracks(), user.value.video.enabled);\r\n    // ========---------========\r\n  };\r\n  // ========---------========\r\n  // ========== END КНОПКИ ВКЛ\\ВЫКЛ (МИКРОФОН КАМЕРА НАУШНИКИ ТД)\r\n\r\n\r\n\r\n  // ========== СООБЩЕНИЯ\r\n  // Функция отправки сообщений \r\n  const submitMessage = () => {\r\n    const message = room.value.inputMessage.trim()\r\n    if (!message.length || !room.value.interval.enabled) { return }\r\n    console.log(room.value.interval)\r\n    ws.emit(\"send-message\", { roomID: room.value.id, peerID: user.value.id, message, username: store.state.username })\r\n    room.value.messages.push({ message, peerID: user.value.id, username: store.state.username })\r\n    room.value.inputMessage = \"\"\r\n    room.value.interval.enabled = false\r\n    setTimeout(() => {\r\n      room.value.interval.enabled = true\r\n    }, room.value.interval.size);\r\n  }\r\n  // ========---------========\r\n\r\n  // Получение чужих сообщений\r\n  ws.on(\"get-message\", ({ message, peerID, username }) => {\r\n    console.log(\"Получение чужого сообщения\", message, peerID, username)\r\n    room.value.messages.push({ message, peerID, username })\r\n  })\r\n  // ========---------========\r\n  \r\n  // Получение всех сообщений \r\n  ws.on(\"get-messages\", ({ messages: oldMessages }) => {\r\n    room.value.messages = [...room.value.messages, ...oldMessages]\r\n  })\r\n  // ========---------========\r\n  // ========== END СООБЩЕНИЯ\r\n\r\n\r\n\r\n  // ========== ДОПОЛНИТЕЛЬНЫЕ ФУНКЦИИ  \r\n  // Отключить сообщение\r\n  const isVisibleAlertMessageHideFunc = () => { \r\n    alertMessage.value.visible = false\r\n    alertMessage.value.message = \"\"\r\n  }\r\n  // ========---------========\r\n  // Показать сообщение \r\n  const isVisibleAlertMessageShowFunc = (message) => {\r\n    alertMessage.value.visible = true\r\n    alertMessage.value.message = message\r\n  }\r\n  // ========---------========\r\n  // Функция копирования url комнаты\r\n  const copyKeyRoom = () => {\r\n    navigator.clipboard.writeText(window.location.href)\r\n    isVisibleAlertMessageShowFunc(\"Комната скопирована\")\r\n  }\r\n  // ========---------========\r\n  // Функция для переключения состояния tracks.en = enabled\r\n  const toggleTracks = (tracks, enabled) => {\r\n    tracks.forEach(track => { track.enabled = enabled; });\r\n  };\r\n  // ========---------========\r\n  // Отключить весь звук на странице \r\n  const videoToggleSound = (fl) => {\r\n    console.log(\"fl \", fl)\r\n    document.querySelectorAll(\"video\").forEach((e) => {\r\n      if (`${user.value.peerID._id}--video` === e.id) { return }\r\n      e.muted = fl\r\n    })\r\n  }\r\n  // ========---------========\r\n  // Поиск определенного человека\r\n  const userFindIndex = ({ peerID }) => videos.value.findIndex((user) => user.peerID === peerID)\r\n  // ========---------========\r\n  \r\n    // Получение пользователей\r\n  const getUsers = ({ participants }) => {\r\n    participants.forEach((user) => {\r\n      const userFindVideos = videos.value.findIndex((e) => e.peerID === user.peerID)\r\n      if (userFindVideos !== -1) {\r\n        // Пользователь с видео\r\n        videos.value[userFindVideos].audioEnabled = user.audio;\r\n        videos.value[userFindVideos].videoEnabled = user.video;\r\n        videos.value[userFindVideos].videoHeadphone = user.headphone;\r\n        videos.value[userFindVideos].videoScreenShare = user.screenshare;\r\n      }\r\n      else {\r\n        createdVideo({ username: user.username, audio: user.audio, screenshare: user.screenshare, video: user.video, peerID: user.peerID })\r\n      }\r\n    });\r\n  };\r\n  // ========---------========\r\n\r\n  // ========== END ДОПОЛНИТЕЛЬНЫЕ ФУНКЦИИ  \r\n\r\n\r\n\r\n  // ========== ОБРАЩЕНИЕ К СЕРВЕРУ  \r\n  // Отключение пользователя\r\n  ws.on(\"user-disconnected\", ({ peerID }) => {\r\n    removeVideo(peerID)\r\n    // Удаление пользователя\r\n    videos.value = videos.value.filter((e) => e.peerID !== peerID)\r\n    // noVideos.value = noVideos.value.filter((e) => e.peerID !== peerID)\r\n  })\r\n  // ========---------========\r\n\r\n  // Подключение пользователя без камеры\r\n  ws.on(\"no-broadcast\", ({ username, peerID }) => {\r\n    createdVideo({ username, peerID, audio: false, video: false, screenshare: false, })\r\n    // noVideos.value.push({ username, peerID })\r\n  })\r\n\r\n  // Транслирование экрана\r\n  ws.on(\"screen-share\", ({ streamID }) => {\r\n    try {\r\n      console.log(\"server-share client: \", streamID)\r\n      navigator.mediaDevices.enumerateDevices().then((devices) => {\r\n        const deviceInfo = devices.find(e => e.deviceId === streamID)\r\n        if (deviceInfo) {\r\n          navigator.mediaDevices.getUserMedia({ video: { deviceId: streamID } }).then((stream) => {\r\n            console.log(\"video created_4\", stream)\r\n          })\r\n        }\r\n      })\r\n    } catch (error) {\r\n      console.log(error)\r\n    }\r\n  })\r\n  // ========---------========\r\n\r\n  // Запуск когда присоединяется другой пользователь \r\n  ws.on(\"user-joined\", ({ peerID, username }) => {\r\n    console.log(\"userJoined: \", user.value)\r\n    const metadata =  {\r\n      username: store.state.username, \r\n      audio: user.value.audio.enabled,\r\n      video: user.value.video.enabled,\r\n      headphone: user.value.headphone.enabled,\r\n      screenshare: user.value.screenshare.enabled,\r\n    } \r\n    if (user.value.inputEnabled) { // Аудио и Видео включено\r\n      const call = user.value.peerID.call(peerID, user.value.stream, { metadata })\r\n      if (call) {\r\n        call.on(\"stream\", (peerStream) => {\r\n          createdVideo({ stream: peerStream, peerID: peerID, username })\r\n          if (!user.value.headphone.enabled) { videoToggleSound(true); }\r\n        })\r\n        call.on(\"error\", (err) => { console.log(\"Error in call\", err); })\r\n        call.on(\"close\", () => { console.log(\"Call closed\"); })\r\n      } else {\r\n        console.warn(\"Failed to create call\")\r\n      } \r\n    } else { // Аудио и видео заблокировано\r\n      const video = createEmptyStream({ username: store.state.username, peerID: peerID })\r\n      const call = user.value.peerID.call(peerID, video.stream, { metadata })\r\n      if (call) {\r\n        call.on(\"stream\", (peerStream) => {\r\n          createdVideo({ stream: peerStream, peerID: peerID, username, })\r\n        })\r\n      }\r\n    }\r\n  })\r\n  // ========---------========\r\n\r\n  // Отключение у определенного элемента\r\n  ws.on(\"toggle-screnshare-room\", ({ peerID, enabled }) => {\r\n    const userIndex = userFindIndex({ peerID: peerID })\r\n    if (userIndex !== -1) { videos.value[userIndex].videoScreenShare = enabled; }\r\n  })\r\n  // ========== END ОБРАЩЕНИЕ К СЕРВЕРУ  \r\n\r\n  // ========== ПОДКЛЮЧЕНИЕ \r\n  onMounted(async () => {    \r\n    ws.on(\"error-room\", ({ message, status }) => {\r\n      router.push({ path: \"/404\", params: {message: message, status: status, } })\r\n    })\r\n    // ========---------========\r\n\r\n    ws.on(\"room-password\", ({ status }) => { // Проверка пароля комнаты\r\n      if (status === 400) { router.push(\"/404\"); }\r\n    })\r\n    // ========---------========\r\n    \r\n    // Функция для запроса камеры и видео\r\n    await navigator.mediaDevices.getUserMedia({ video: true, audio: true })\r\n    .then((streamRes) => {\r\n      console.log(\"helLOQOWe-iqwe ajijewi fjieajfr\")\r\n      user.value.stream = streamRes\r\n      user.value.audio.enabled = true\r\n      user.value.video.enabled = true\r\n      user.value.headphone.enabled = true\r\n      user.value.screenshare.enabled = true\r\n      user.value.inputEnabled = true\r\n      createdVideo({ stream: user.value.stream, streamClass: \"video--my\", peerID: user.value.id, username: store.state.username, isMe: true, })\r\n      // ========---------========\r\n    })\r\n    .catch((error) => {\r\n      console.log('Пользователь отключил камеру: ', error)\r\n      user.value.stream = null\r\n      user.value.audio.enabled = false\r\n      user.value.video.enabled = false\r\n      user.value.headphone.enabled = true\r\n      user.value.screenshare.enabled = false\r\n      user.value.inputEnabled = false\r\n      createdVideo({ stream: user.value.stream, streamClass: \"video--my\", peerID: user.value.id, audio: false, video: false, screenshare: false, username: store.state.username, isMe: true })\r\n      ws.emit(\"no-broadcast\", { roomID: room.value.id, peerID: user.value.id, username: store.state.username, })\r\n    })\r\n    .finally(() => {\r\n      // Подключение к серверу после получения разрешений\r\n      if (user.value.inputEnabled) {\r\n        ws.emit(\"join-room\", { roomID: room.value.id, peerID: user.value.id, password: route.query.password, username: store.state.username, audio: true, video: true, screenshare: true, })\r\n      } else {\r\n        ws.emit(\"join-room\", { roomID: room.value.id, peerID: user.value.id, password: route.query.password, username: store.state.username, audio: false, video: false, screenshare: false, })\r\n      }\r\n      // Пользователи которые были уже в комнате \r\n      ws.on(\"get-users\", ({ participants }) => { \r\n        console.log(\"participants\", participants)\r\n        oldParticipants.value = participants\r\n      })\r\n      // Сообщение в чате\r\n      room.value.messages.push({ message: `Добро пожаловать в комнату: ${room.value.name}`, peerID: user.value.id, username: store.state.username })\r\n      user.value.peerID.on(\"call\", (call) => {\r\n        call.answer(user.value.stream)\r\n        console.log(\"call\", call)\r\n        // Получение имени пользователя\r\n        call.on(\"stream\", (peerStream) => {\r\n          console.log(\"test: \", call)\r\n          createdVideo({ stream: peerStream, peerID: call.peer, username: call.metadata?.username || \"Без имени\", audio: call.metadata?.audio, video: call.metadata?.video, screenshare: call.metadata?.screenshare })\r\n          // Если звук выключен и подключился новый пользователь\r\n          if (!user.value.headphone.enabled) { videoToggleSound(true); } \r\n        })\r\n        getUsers({ participants: oldParticipants.value }) // Обновление videos\r\n        // ========---------========\r\n        call.on(\"close\", () => { \r\n          console.log(\"STREAM_CLOSE\")\r\n          removeVideo(call.peer)\r\n        })\r\n        call.on(\"error\", (error) => {\r\n          console.error(\"STREAM_ERROR: \", error)\r\n          removeVideo(call.peer)\r\n        })\r\n      })  \r\n    })\r\n    console.log(\"USER: \", user.value)\r\n    // ========---------========\r\n  })\r\n  // ========== END ПОДКЛЮЧЕНИЕ \r\n  \r\n  // ========== ОТКЛЮЧЕНИЕ С КОМНАТЫ \r\n  onUnmounted(() => {\r\n    ws.disconnect()\r\n    user.value.peerID.destroy()\r\n    user.value.stream?.getTracks().forEach(track => track.stop())\r\n  })\r\n  // ========== END ОТКЛЮЧЕНИЕ С КОМНАТЫ \r\n\r\n</script>\r\n\r\n\r\n<style lang=\"scss\">\r\n.footer__inner-bottom { display: none; }\r\nbody { overflow: hidden; }\r\n.room {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  &__inner-info {\r\n    width: 100%;\r\n    height: calc(100vh - 50px);\r\n  }\r\n  &__inner {\r\n    flex: 1;\r\n    width: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n  }\r\n  &__side {\r\n    margin-left: auto;\r\n    flex-basis: 400px;\r\n    width: 400px;\r\n    height: 90vh;\r\n    position: relative;\r\n    transition: all 300ms cubic-bezier(0.19, 1, 0.56, 1);\r\n  }\r\n  &__exit {\r\n    display: flex;\r\n    align-items: flex-end;\r\n    justify-content: start;\r\n    transform: rotate(180deg);\r\n    cursor: pointer;\r\n    background: var(--clr-primary);\r\n    padding: 5px;\r\n    color: var(--clr-tertiary);\r\n  }\r\n\r\n  &__side.show {\r\n    display: block;\r\n    transform: translateX(0);\r\n  }\r\n\r\n  // CHAT \r\n  &__chat {\r\n    &-container {\r\n      background-color: var(--clr-tertiary);\r\n      box-shadow: 5px 5px 5px 5px var(--clr-secondary);\r\n      display: flex;\r\n      flex-direction: column;\r\n      height: 100vh;\r\n    }\r\n    &-header {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 5px;\r\n      padding: 5px 10px 5px 5px;\r\n    }\r\n    &-area {\r\n      flex: 1;\r\n      overflow-y: auto;\r\n      padding: 16px;\r\n      display: flex;\r\n      flex-direction: column;\r\n      justify-content: space-between;\r\n      &__wrapper {\r\n        padding: 16px;\r\n      }\r\n      &__typing {\r\n        display: flex;\r\n        border-radius: 4px;\r\n        color: var(--clr-secondary);\r\n        width: 100%;\r\n        & .input--text {\r\n          width: 100%;\r\n          border-radius: var(--border-radius-default);\r\n          border-top-right-radius: 0%;\r\n          border-bottom-right-radius: 0%;\r\n        }\r\n        & .btn {\r\n          border-top-left-radius: 0%;\r\n          border-bottom-left-radius: 0%;\r\n          border-left: 2px solid var(--clr-tertiary);\r\n        }\r\n      }\r\n    }\r\n    &-messages {\r\n      overflow: auto;\r\n    }\r\n    &-send {\r\n      color: var(--clr-tertiary);\r\n      background-color: var(--clr-primary);\r\n      border-radius: 8px;\r\n      border: none;\r\n      width: 32px;\r\n      height: 32px;\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      & svg {\r\n        width: 20px;\r\n        height: 20px;\r\n      }\r\n    }\r\n  }\r\n}\r\n// ======\r\n.video {\r\n  &__grid {\r\n    width: 100%;\r\n    height: 100%; \r\n    overflow: auto;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    position: relative;\r\n  }\r\n  &__input {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    padding: 0 0 10px 0;\r\n    gap: 15px;\r\n    font-size: 20px;\r\n    // margin: 15px 0 0 0;\r\n  }\r\n}\r\n// ======\r\n@media screen and (max-width: 1000px) {\r\n  .room__side {\r\n    position: absolute;\r\n    width: 100%;\r\n  }\r\n}\r\n</style>","import script from \"./RoomView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./RoomView.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./RoomView.vue?vue&type=style&index=0&id=4cb6aee3&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","'use strict';\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\n\nvar $TypeError = TypeError;\n\nmodule.exports = function (it, Prototype) {\n  if (isPrototypeOf(Prototype, it)) return it;\n  throw new $TypeError('Incorrect invocation');\n};\n","'use strict';\nmodule.exports = {\n  IndexSizeError: { s: 'INDEX_SIZE_ERR', c: 1, m: 1 },\n  DOMStringSizeError: { s: 'DOMSTRING_SIZE_ERR', c: 2, m: 0 },\n  HierarchyRequestError: { s: 'HIERARCHY_REQUEST_ERR', c: 3, m: 1 },\n  WrongDocumentError: { s: 'WRONG_DOCUMENT_ERR', c: 4, m: 1 },\n  InvalidCharacterError: { s: 'INVALID_CHARACTER_ERR', c: 5, m: 1 },\n  NoDataAllowedError: { s: 'NO_DATA_ALLOWED_ERR', c: 6, m: 0 },\n  NoModificationAllowedError: { s: 'NO_MODIFICATION_ALLOWED_ERR', c: 7, m: 1 },\n  NotFoundError: { s: 'NOT_FOUND_ERR', c: 8, m: 1 },\n  NotSupportedError: { s: 'NOT_SUPPORTED_ERR', c: 9, m: 1 },\n  InUseAttributeError: { s: 'INUSE_ATTRIBUTE_ERR', c: 10, m: 1 },\n  InvalidStateError: { s: 'INVALID_STATE_ERR', c: 11, m: 1 },\n  SyntaxError: { s: 'SYNTAX_ERR', c: 12, m: 1 },\n  InvalidModificationError: { s: 'INVALID_MODIFICATION_ERR', c: 13, m: 1 },\n  NamespaceError: { s: 'NAMESPACE_ERR', c: 14, m: 1 },\n  InvalidAccessError: { s: 'INVALID_ACCESS_ERR', c: 15, m: 1 },\n  ValidationError: { s: 'VALIDATION_ERR', c: 16, m: 0 },\n  TypeMismatchError: { s: 'TYPE_MISMATCH_ERR', c: 17, m: 1 },\n  SecurityError: { s: 'SECURITY_ERR', c: 18, m: 1 },\n  NetworkError: { s: 'NETWORK_ERR', c: 19, m: 1 },\n  AbortError: { s: 'ABORT_ERR', c: 20, m: 1 },\n  URLMismatchError: { s: 'URL_MISMATCH_ERR', c: 21, m: 1 },\n  QuotaExceededError: { s: 'QUOTA_EXCEEDED_ERR', c: 22, m: 1 },\n  TimeoutError: { s: 'TIMEOUT_ERR', c: 23, m: 1 },\n  InvalidNodeTypeError: { s: 'INVALID_NODE_TYPE_ERR', c: 24, m: 1 },\n  DataCloneError: { s: 'DATA_CLONE_ERR', c: 25, m: 1 }\n};\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\n\nvar $Error = Error;\nvar replace = uncurryThis(''.replace);\n\nvar TEST = (function (arg) { return String(new $Error(arg).stack); })('zxcasd');\n// eslint-disable-next-line redos/no-vulnerable -- safe\nvar V8_OR_CHAKRA_STACK_ENTRY = /\\n\\s*at [^:]*:[^\\n]*/;\nvar IS_V8_OR_CHAKRA_STACK = V8_OR_CHAKRA_STACK_ENTRY.test(TEST);\n\nmodule.exports = function (stack, dropEntries) {\n  if (IS_V8_OR_CHAKRA_STACK && typeof stack == 'string' && !$Error.prepareStackTrace) {\n    while (dropEntries--) stack = replace(stack, V8_OR_CHAKRA_STACK_ENTRY, '');\n  } return stack;\n};\n","'use strict';\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\n\n// makes subclassing work correct for wrapped built-ins\nmodule.exports = function ($this, dummy, Wrapper) {\n  var NewTarget, NewTargetPrototype;\n  if (\n    // it can work only with native `setPrototypeOf`\n    setPrototypeOf &&\n    // we haven't completely correct pre-ES6 way for getting `new.target`, so use this\n    isCallable(NewTarget = dummy.constructor) &&\n    NewTarget !== Wrapper &&\n    isObject(NewTargetPrototype = NewTarget.prototype) &&\n    NewTargetPrototype !== Wrapper.prototype\n  ) setPrototypeOf($this, NewTargetPrototype);\n  return $this;\n};\n","'use strict';\nvar toString = require('../internals/to-string');\n\nmodule.exports = function (argument, $default) {\n  return argument === undefined ? arguments.length < 2 ? '' : $default : toString(argument);\n};\n","'use strict';\nvar classof = require('../internals/classof');\n\nvar $String = String;\n\nmodule.exports = function (argument) {\n  if (classof(argument) === 'Symbol') throw new TypeError('Cannot convert a Symbol value to a string');\n  return $String(argument);\n};\n","'use strict';\nvar $TypeError = TypeError;\n\nmodule.exports = function (passed, required) {\n  if (passed < required) throw new $TypeError('Not enough arguments');\n  return passed;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar getBuiltIn = require('../internals/get-built-in');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar defineProperty = require('../internals/object-define-property').f;\nvar hasOwn = require('../internals/has-own-property');\nvar anInstance = require('../internals/an-instance');\nvar inheritIfRequired = require('../internals/inherit-if-required');\nvar normalizeStringArgument = require('../internals/normalize-string-argument');\nvar DOMExceptionConstants = require('../internals/dom-exception-constants');\nvar clearErrorStack = require('../internals/error-stack-clear');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar IS_PURE = require('../internals/is-pure');\n\nvar DOM_EXCEPTION = 'DOMException';\nvar Error = getBuiltIn('Error');\nvar NativeDOMException = getBuiltIn(DOM_EXCEPTION);\n\nvar $DOMException = function DOMException() {\n  anInstance(this, DOMExceptionPrototype);\n  var argumentsLength = arguments.length;\n  var message = normalizeStringArgument(argumentsLength < 1 ? undefined : arguments[0]);\n  var name = normalizeStringArgument(argumentsLength < 2 ? undefined : arguments[1], 'Error');\n  var that = new NativeDOMException(message, name);\n  var error = new Error(message);\n  error.name = DOM_EXCEPTION;\n  defineProperty(that, 'stack', createPropertyDescriptor(1, clearErrorStack(error.stack, 1)));\n  inheritIfRequired(that, this, $DOMException);\n  return that;\n};\n\nvar DOMExceptionPrototype = $DOMException.prototype = NativeDOMException.prototype;\n\nvar ERROR_HAS_STACK = 'stack' in new Error(DOM_EXCEPTION);\nvar DOM_EXCEPTION_HAS_STACK = 'stack' in new NativeDOMException(1, 2);\n\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar descriptor = NativeDOMException && DESCRIPTORS && Object.getOwnPropertyDescriptor(global, DOM_EXCEPTION);\n\n// Bun ~ 0.1.1 DOMException have incorrect descriptor and we can't redefine it\n// https://github.com/Jarred-Sumner/bun/issues/399\nvar BUGGY_DESCRIPTOR = !!descriptor && !(descriptor.writable && descriptor.configurable);\n\nvar FORCED_CONSTRUCTOR = ERROR_HAS_STACK && !BUGGY_DESCRIPTOR && !DOM_EXCEPTION_HAS_STACK;\n\n// `DOMException` constructor patch for `.stack` where it's required\n// https://webidl.spec.whatwg.org/#es-DOMException-specialness\n$({ global: true, constructor: true, forced: IS_PURE || FORCED_CONSTRUCTOR }, { // TODO: fix export logic\n  DOMException: FORCED_CONSTRUCTOR ? $DOMException : NativeDOMException\n});\n\nvar PolyfilledDOMException = getBuiltIn(DOM_EXCEPTION);\nvar PolyfilledDOMExceptionPrototype = PolyfilledDOMException.prototype;\n\nif (PolyfilledDOMExceptionPrototype.constructor !== PolyfilledDOMException) {\n  if (!IS_PURE) {\n    defineProperty(PolyfilledDOMExceptionPrototype, 'constructor', createPropertyDescriptor(1, PolyfilledDOMException));\n  }\n\n  for (var key in DOMExceptionConstants) if (hasOwn(DOMExceptionConstants, key)) {\n    var constant = DOMExceptionConstants[key];\n    var constantName = constant.s;\n    if (!hasOwn(PolyfilledDOMException, constantName)) {\n      defineProperty(PolyfilledDOMException, constantName, createPropertyDescriptor(6, constant.c));\n    }\n  }\n}\n","'use strict';\nvar defineBuiltIn = require('../internals/define-built-in');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toString = require('../internals/to-string');\nvar validateArgumentsLength = require('../internals/validate-arguments-length');\n\nvar $URLSearchParams = URLSearchParams;\nvar URLSearchParamsPrototype = $URLSearchParams.prototype;\nvar append = uncurryThis(URLSearchParamsPrototype.append);\nvar $delete = uncurryThis(URLSearchParamsPrototype['delete']);\nvar forEach = uncurryThis(URLSearchParamsPrototype.forEach);\nvar push = uncurryThis([].push);\nvar params = new $URLSearchParams('a=1&a=2&b=3');\n\nparams['delete']('a', 1);\n// `undefined` case is a Chromium 117 bug\n// https://bugs.chromium.org/p/v8/issues/detail?id=14222\nparams['delete']('b', undefined);\n\nif (params + '' !== 'a=2') {\n  defineBuiltIn(URLSearchParamsPrototype, 'delete', function (name /* , value */) {\n    var length = arguments.length;\n    var $value = length < 2 ? undefined : arguments[1];\n    if (length && $value === undefined) return $delete(this, name);\n    var entries = [];\n    forEach(this, function (v, k) { // also validates `this`\n      push(entries, { key: k, value: v });\n    });\n    validateArgumentsLength(length, 1);\n    var key = toString(name);\n    var value = toString($value);\n    var index = 0;\n    var dindex = 0;\n    var found = false;\n    var entriesLength = entries.length;\n    var entry;\n    while (index < entriesLength) {\n      entry = entries[index++];\n      if (found || entry.key === key) {\n        found = true;\n        $delete(this, entry.key);\n      } else dindex++;\n    }\n    while (dindex < entriesLength) {\n      entry = entries[dindex++];\n      if (!(entry.key === key && entry.value === value)) append(this, entry.key, entry.value);\n    }\n  }, { enumerable: true, unsafe: true });\n}\n","'use strict';\nvar defineBuiltIn = require('../internals/define-built-in');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toString = require('../internals/to-string');\nvar validateArgumentsLength = require('../internals/validate-arguments-length');\n\nvar $URLSearchParams = URLSearchParams;\nvar URLSearchParamsPrototype = $URLSearchParams.prototype;\nvar getAll = uncurryThis(URLSearchParamsPrototype.getAll);\nvar $has = uncurryThis(URLSearchParamsPrototype.has);\nvar params = new $URLSearchParams('a=1');\n\n// `undefined` case is a Chromium 117 bug\n// https://bugs.chromium.org/p/v8/issues/detail?id=14222\nif (params.has('a', 2) || !params.has('a', undefined)) {\n  defineBuiltIn(URLSearchParamsPrototype, 'has', function has(name /* , value */) {\n    var length = arguments.length;\n    var $value = length < 2 ? undefined : arguments[1];\n    if (length && $value === undefined) return $has(this, name);\n    var values = getAll(this, name); // also validates `this`\n    validateArgumentsLength(length, 1);\n    var value = toString($value);\n    var index = 0;\n    while (index < values.length) {\n      if (values[index++] === value) return true;\n    } return false;\n  }, { enumerable: true, unsafe: true });\n}\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar defineBuiltInAccessor = require('../internals/define-built-in-accessor');\n\nvar URLSearchParamsPrototype = URLSearchParams.prototype;\nvar forEach = uncurryThis(URLSearchParamsPrototype.forEach);\n\n// `URLSearchParams.prototype.size` getter\n// https://github.com/whatwg/url/pull/734\nif (DESCRIPTORS && !('size' in URLSearchParamsPrototype)) {\n  defineBuiltInAccessor(URLSearchParamsPrototype, 'size', {\n    get: function size() {\n      var count = 0;\n      forEach(this, function () { count++; });\n      return count;\n    },\n    configurable: true,\n    enumerable: true\n  });\n}\n"],"names":["require","SDPUtils","Math","random","toString","substring","localCName","generateIdentifier","splitLines","blob","trim","split","map","line","splitSections","parts","part","index","getDescription","sections","getMediaSections","shift","matchPrefix","prefix","filter","indexOf","parseCandidate","candidate","foundation","component","protocol","toLowerCase","priority","parseInt","ip","address","port","type","i","length","relatedAddress","relatedPort","tcpType","ufrag","usernameFragment","undefined","writeCandidate","sdp","push","toUpperCase","join","parseIceOptions","parseRtpMap","parsed","payloadType","name","clockRate","channels","numChannels","writeRtpMap","codec","pt","preferredPayloadType","parseExtmap","id","direction","uri","attributes","slice","writeExtmap","headerExtension","preferredId","parseFmtp","kv","j","writeFmtp","parameters","Object","keys","params","forEach","param","parseRtcpFb","parameter","writeRtcpFb","lines","rtcpFeedback","fb","parseSsrcMedia","sp","ssrc","colon","attribute","value","parseSsrcGroup","semantics","ssrcs","getMid","mediaSection","mid","parseFingerprint","algorithm","getDtlsParameters","sessionpart","role","fingerprints","writeDtlsParameters","setupType","fp","parseCryptoLine","tag","cryptoSuite","keyParams","sessionParams","writeCryptoLine","writeCryptoKeyParams","parseCryptoKeyParams","keyMethod","keySalt","lifeTime","mkiValue","mkiLength","getCryptoParameters","getIceParameters","pwd","password","writeIceParameters","iceLite","parseRtpParameters","description","codecs","headerExtensions","fecMechanisms","rtcp","mline","profile","rtpmapline","fmtps","wildcardRtcpFb","duplicate","find","existingFeedback","writeRtpDescription","kind","caps","maxptime","extension","parseRtpEncodingParameters","encodingParameters","hasRed","hasUlpfec","primarySsrc","secondarySsrc","flows","apt","encParam","codecPayloadType","rtx","JSON","parse","stringify","fec","mechanism","bandwidth","maxBitrate","parseRtcpParameters","rtcpParameters","remoteSsrc","obj","cname","rsize","reducedSize","compound","mux","writeRtcpParameters","parseMsid","spec","stream","track","planB","msidParts","parseSctpDescription","parseMLine","maxSizeLine","maxMessageSize","isNaN","sctpPort","fmt","sctpMapLines","writeSctpDescription","media","sctp","output","generateSessionId","substr","writeSessionBoilerplate","sessId","sessVer","sessUser","sessionId","version","user","getDirection","getKind","isRejected","parseOLine","username","sessionVersion","netType","addressType","isValidSDP","charAt","module","exports","getRandomValues","randomUUID","crypto","bind","rnds8","Uint8Array","rng","Error","byteToHex","unsafeStringify","arr","offset","v4","options","buf","native","rnds","emit","__emit","isVisible","ref","myTimeout","hide","clearTimeout","show","setTimeout","onMounted","onUnmounted","__exports__","onLoadedMetadata","video","target","play","onActive","classList","toggle","$e8379818650e2442$export$93654d4f2d6cd524","constructor","encoder","TextEncoder","this","_pieces","_parts","append_buffer","data","flush","append","toArrayBuffer","buffer","$e8379818650e2442$var$concatArrayBuffers","bufs","size","byteLength","result","view","byteOffset","set","$0cfd7828ad59115f$export$417857010dc9287f","unpacker","$0cfd7828ad59115f$var$Unpacker","unpack","$0cfd7828ad59115f$export$2a703dbb0cb35339","packer","$0cfd7828ad59115f$export$b9ec4b114aa40074","res","pack","Promise","then","getBuffer","dataBuffer","dataView","unpack_uint8","unpack_raw","unpack_string","unpack_array","unpack_map","unpack_float","unpack_double","unpack_uint16","unpack_uint32","unpack_uint64","unpack_int8","unpack_int16","unpack_int32","unpack_int64","byte","bytes","read","uint16","uint32","uint64","uint8","c","code","str","String","fromCodePoint","objects","Array","key","sign","exp","fraction","h32","l32","hfrac","frac","subarray","_bufferBuilder","pack_string","floor","pack_integer","pack_double","pack_array","ArrayBuffer","pack_bin","v","Date","Blob","arrayBuffer","startsWith","pack_object","pack_uint8","pack_uint16","pack_uint32","encoded","_textEncoder","encode","ary","packNext","num","pack_int8","pack_int16","pack_int32","pack_int64","pack_uint64","log","LN2","frac0","frac1","b32","prop","hasOwnProperty","n","high","low","logDisabled_","deprecationWarnings_","extractVersion","uastring","expr","pos","match","wrapPeerConnectionEvent","window","eventNameToWrap","wrapper","RTCPeerConnection","proto","prototype","nativeAddEventListener","addEventListener","nativeEventName","cb","apply","arguments","wrappedCallback","e","modifiedEvent","handleEvent","_eventMap","Map","nativeRemoveEventListener","removeEventListener","has","unwrappedCb","get","delete","defineProperty","enumerable","configurable","disableLog","bool","disableWarnings","console","deprecated","oldMethod","newMethod","warn","detectBrowser","browser","navigator","userAgent","userAgentData","brands","chromium","brand","mozGetUserMedia","webkitGetUserMedia","isSecureContext","webkitRTCPeerConnection","supportsUnifiedPlan","RTCRtpTransceiver","isObject","val","call","compactObject","reduce","accumulator","isObj","isEmptyObject","assign","walkStats","stats","base","resultSet","endsWith","filterStats","outbound","streamStatsType","filteredResult","trackStats","trackIdentifier","trackStat","trackId","logging","utils","shimGetUserMedia","browserDetails","mediaDevices","constraintsToChrome_","mandatory","optional","cc","r","ideal","exact","min","max","oldname_","oc","mix","advanced","concat","shimConstraints_","constraints","func","audio","remap","a","b","face","facingMode","getSupportedFacingModeLies","getSupportedConstraints","matches","enumerateDevices","devices","d","dev","some","label","includes","deviceId","shimError_","PermissionDeniedError","PermissionDismissedError","InvalidStateError","DevicesNotFoundError","ConstraintNotSatisfiedError","TrackStartError","MediaDeviceFailedDueToShutdown","MediaDeviceKillSwitchOn","TabCaptureError","ScreenCaptureError","DeviceCaptureError","message","constraint","constraintName","getUserMedia_","onSuccess","onError","getUserMedia","origGetUserMedia","cs","getAudioTracks","getVideoTracks","getTracks","stop","DOMException","reject","shimMediaStream","MediaStream","webkitMediaStream","shimOnTrack","_ontrack","f","origSetRemoteDescription","setRemoteDescription","_ontrackpoly","te","receiver","getReceivers","event","Event","transceiver","streams","dispatchEvent","shimGetSendersWithDtmf","shimSenderWithDtmf","pc","dtmf","_dtmf","createDTMFSender","_pc","getSenders","_senders","origAddTrack","addTrack","sender","origRemoveTrack","removeTrack","idx","splice","origAddStream","addStream","origRemoveStream","removeStream","s","RTCRtpSender","origGetSenders","senders","shimSenderReceiverGetStats","RTCRtpReceiver","getStats","origGetReceivers","receivers","srcElement","origGetStats","MediaStreamTrack","err","shimAddTrackRemoveTrackWithNative","getLocalStreams","_shimmedLocalStreams","streamId","alreadyExists","existingSenders","newSenders","newSender","shimAddTrackRemoveTrack","origGetLocalStreams","nativeStreams","_reverseStreams","_streams","newStream","replaceInternalStreamId","internalId","externalStream","internalStream","replace","RegExp","RTCSessionDescription","replaceExternalStreamId","signalingState","t","oldStream","resolve","method","nativeMethod","methodObj","args","isLegacyCall","desc","origSetLocalDescription","setLocalDescription","origLocalDescription","getOwnPropertyDescriptor","isLocal","streamid","hasTrack","shimPeerConnection","RTCIceCandidate","fixNegotiationNeeded","getConfiguration","sdpSemantics","nativeGetUserMedia","getSettings","nativeGetSettings","applyConstraints","nativeApplyConstraints","shimGetDisplayMedia","preferredMediaSource","getDisplayMedia","mediaSource","RTCTrackEvent","mozRTCPeerConnection","modernStatsTypes","inboundrtp","outboundrtp","candidatepair","localcandidate","remotecandidate","nativeGetStats","selector","onSucc","onErr","stat","shimSenderGetStats","shimReceiverGetStats","shimRemoveStream","shimRTCDataChannel","DataChannel","RTCDataChannel","shimAddTransceiver","origAddTransceiver","addTransceiver","setParametersPromises","sendEncodings","shouldPerformCheck","encodingParam","ridRegex","test","rid","TypeError","parseFloat","scaleResolutionDownBy","RangeError","maxFramerate","getParameters","encodings","setParameters","catch","shimGetParameters","origGetParameters","shimCreateOffer","origCreateOffer","createOffer","all","finally","shimCreateAnswer","origCreateAnswer","createAnswer","shimLocalStreamsAPI","_localStreams","_addTrack","tracks","shimRemoteStreamsAPI","getRemoteStreams","_remoteStreams","_onaddstream","_onaddstreampoly","shimCallbacksAPI","addIceCandidate","successCallback","failureCallback","promise","withCallback","_getUserMedia","shimConstraints","errcb","shimRTCIceServerUrls","OrigPeerConnection","pcConfig","pcConstraints","iceServers","newIceServers","server","urls","url","generateCertificate","shimTrackEventTransceiver","shimCreateOfferLegacy","offerOptions","offerToReceiveAudio","audioTransceiver","getTransceivers","setDirection","offerToReceiveVideo","videoTransceiver","shimAudioContext","AudioContext","webkitAudioContext","shimRTCIceCandidate","NativeRTCIceCandidate","nativeCandidate","parsedCandidate","toJSON","sdpMid","sdpMLineIndex","writable","shimRTCIceCandidateRelayProtocol","relayProtocol","shimMaxMessageSize","_sctp","sctpInDescription","mLine","getRemoteFirefoxVersion","getCanSendMaxMessageSize","remoteIsFirefox","canSendMaxMessageSize","getMaxMessageSize","isFirefox","canSendMMS","remoteMMS","Number","POSITIVE_INFINITY","shimSendThrowTypeError","wrapDcSend","dc","origDataChannelSend","send","readyState","origCreateDataChannel","createDataChannel","dataChannel","channel","shimConnectionState","completed","checking","iceConnectionState","_onconnectionstatechange","origMethod","_connectionstatechangepoly","_lastConnectionState","connectionState","newEvent","removeExtmapAllowMixed","nativeSRD","shimAddIceCandidateNullOrEmpty","nativeAddIceCandidate","shimParameterlessSetLocalDescription","nativeSetLocalDescription","adapterFactory","shimChrome","shimFirefox","shimSafari","adapter","commonShim","chromeShim","browserShim","firefoxShim","safariShim","UINT32_MAX","setUint64","setUint32","setInt64","getInt64","getInt32","getUint32","getUint64","TEXT_ENCODING_AVAILABLE","process","_a","TextDecoder","utf8Count","strLength","charCodeAt","extra","utf8EncodeJs","outputOffset","sharedTextEncoder","TEXT_ENCODER_THRESHOLD","_b","utf8EncodeTEencode","utf8EncodeTEencodeInto","encodeInto","utf8EncodeTE","CHUNK_SIZE","utf8DecodeJs","inputOffset","end","units","byte1","byte2","byte3","byte4","unit","fromCharCode","sharedTextDecoder","TEXT_DECODER_THRESHOLD","_c","utf8DecodeTD","stringBytes","decode","ExtData","DecodeError","_super","_this","create","setPrototypeOf","__extends","EXT_TIMESTAMP","TIMESTAMP32_MAX_SEC","TIMESTAMP64_MAX_SEC","encodeTimeSpecToTimestamp","sec","nsec","rv","DataView","secHigh","secLow","encodeDateToTimeSpec","date","msec","getTime","nsecInSec","encodeTimestampExtension","object","timeSpec","decodeTimestampToTimeSpec","nsec30AndSecHigh2","secLow32","decodeTimestampExtension","timestampExtension","ExtensionCodec","builtInEncoders","builtInDecoders","encoders","decoders","register","tryToEncode","context","encodeExt","decodeExt","defaultCodec","ensureUint8Array","isView","from","createDataView","bufferView","DEFAULT_MAX_DEPTH","DEFAULT_INITIAL_BUFFER_SIZE","Encoder","extensionCodec","maxDepth","initialBufferSize","sortKeys","forceFloat32","ignoreUndefined","forceIntegerToFloat","reinitializeState","encodeSharedRef","doEncode","depth","encodeNil","encodeBoolean","encodeNumber","encodeString","encodeObject","ensureBufferSizeToWrite","sizeToWrite","requiredSize","resizeBuffer","newSize","newBuffer","newBytes","newView","writeU8","isSafeInteger","writeU16","writeU32","writeU64","writeI8","writeI16","writeI32","writeI64","writeF32","writeF64","writeStringHeader","maxHeaderSize","ext","encodeExtension","isArray","encodeArray","encodeBinary","encodeMap","writeU8a","_i","object_1","item","countWithoutUndefined","count","keys_1","sort","keys_2","setUint8","values","setInt8","setUint16","setInt16","setInt32","setFloat32","setFloat64","prettyByte","abs","padStart","DEFAULT_MAX_KEY_LENGTH","DEFAULT_MAX_LENGTH_PER_KEY","CachedKeyDecoder","maxKeyLength","maxLengthPerKey","hit","miss","caches","canBeCached","records","FIND_CHUNK","records_1","record","recordBytes","store","cachedValue","slicedCopyOfBytes","isValidMapKeyType","keyType","HEAD_BYTE_REQUIRED","EMPTY_VIEW","EMPTY_BYTES","DataViewIndexOutOfBoundsError","getInt8","MORE_DATA","sharedCachedKeyDecoder","Decoder","maxStrLength","maxBinLength","maxArrayLength","maxMapLength","maxExtLength","keyDecoder","totalPos","headByte","stack","setBuffer","appendBuffer","hasRemaining","remainingData","newData","createExtraByteError","posToShow","doDecodeSync","decodeMulti","sent","decodeAsync","decoded","stream_1","__asyncValues","stream_1_1","decodeArrayStream","decodeMultiAsync","decodeStream","isArrayHeaderRequired","arrayItemsLeft","stream_2","stream_2_1","readArraySize","complete","e_2","DECODE","readHeadByte","pushMapState","pushArrayState","decodeUtf8String","readF32","readF64","readU8","readU16","readU32","readU64","readI8","readI16","readI32","readI64","lookU8","lookU16","lookU32","decodeBinary","decodeExtension","state","array","position","pop","readCount","headerOffset","stateIsMapKey","headOffset","extType","getUint8","getUint16","getInt16","getFloat32","getFloat64","$fcbcc7538a6776d5$export$f1c5f4c9cb95390b","chunkedMTU","_dataCount","chunk","chunks","total","ceil","start","__peerData","$fcbcc7538a6776d5$export$52c89ebcdc4f53f2","$fb63e766cfafaab9$var$webRTCAdapter","$gCcbY$webrtcadapter","default","$fb63e766cfafaab9$export$25be9502477c137d","isWebRTCSupported","isBrowserSupported","getBrowser","getVersion","validBrowser","supportedBrowsers","minChromeVersion","minFirefoxVersion","isIOS","minSafariVersion","isUnifiedPlanSupported","tempPc","supported","close","platform","$9a84a32bf0bf36bb$export$f35f128fd59ea256","$0e5fd1585784c252$export$4e61f672936bec77","$4f4134156c446392$var$DEFAULT_CONFIG","credential","$4f4134156c446392$export$f8f26dd395d7e1bd","noop","blobToArrayBuffer","fr","FileReader","onload","evt","readAsArrayBuffer","binaryStringToArrayBuffer","binary","byteArray","isSecure","location","CLOUD_HOST","CLOUD_PORT","chunkedBrowsers","Chrome","chrome","defaultConfig","browserVersion","$gCcbY$pack","$gCcbY$unpack","supports","webRTC","audioVideo","binaryBlob","reliable","ordered","binaryType","validateId","randomToken","$4f4134156c446392$export$7debb50ef11d5e0b","$257947e92926277a$var$LOG_PREFIX","LogLevel","$257947e92926277a$export$243e62d78d3b544d","$257947e92926277a$var$Logger","logLevel","_logLevel","_print","error","setLogFunction","fn","rest","copy","$257947e92926277a$export$2e2bcd8739ae039","$c4dcfd1d1ea86647$var$has","$c4dcfd1d1ea86647$var$prefix","$c4dcfd1d1ea86647$var$Events","$c4dcfd1d1ea86647$var$EE","once","$c4dcfd1d1ea86647$var$addListener","emitter","listener","_events","_eventsCount","$c4dcfd1d1ea86647$var$clearEvent","$c4dcfd1d1ea86647$var$EventEmitter","__proto__","eventNames","events","names","getOwnPropertySymbols","listeners","handlers","l","ee","listenerCount","a1","a2","a3","a4","a5","len","removeListener","on","removeAllListeners","off","addListener","prefixed","EventEmitter","$c4dcfd1d1ea86647$exports","ConnectionType","$78455e22dea96b8c$export$3157d57b4135e3bc","PeerErrorType","$78455e22dea96b8c$export$9547aaa2e39030ff","BaseConnectionErrorType","$78455e22dea96b8c$export$7974935686149686","DataConnectionErrorType","$78455e22dea96b8c$export$49ae800c114df41d","SerializationType","$78455e22dea96b8c$export$89f507cf986a947","SocketEventType","$78455e22dea96b8c$export$3b5c4a4b6354f023","ServerMessageType","$78455e22dea96b8c$export$adb4a1754da6f10d","$f5f881ec4575f1fc$exports","$8f5bfa60836d261d$export$4798917dbf149b79","secure","host","path","pingInterval","super","_disconnected","_messagesQueue","wsProtocol","_baseUrl","token","_id","wsUrl","_socket","WebSocket","onmessage","Message","onclose","_cleanup","Disconnected","onopen","_sendQueuedMessages","_scheduleHeartbeat","_wsPingTimer","_sendHeartbeat","_wsOpen","Heartbeat","copiedQueue","$b82fb8fc0514bfc1$export$89e6bb5ad64bf4a","connection","startConnection","peerConnection","_startPeerConnection","Media","_stream","_addTracksToConnection","originator","dataConnection","config","_initializeDataChannel","_makeOffer","handleSDP","provider","_setupListeners","peerId","peer","connectionId","connectionType","onicecandidate","socket","Candidate","payload","dst","oniceconnectionstatechange","emitError","NegotiationFailed","ConnectionClosed","ondatachannel","getConnection","ontrack","mediaConnection","_addStreamToMediaConnection","cleanup","peerConnectionNotClosed","dataChannelNotClosed","offer","sdpTransform","metadata","Data","serialization","Offer","WebRTC","err_1","_makeAnswer","answer","Answer","self","handleCandidate","ice","$23779d1881157a18$export$6a678e589c8a4542","$23779d1881157a18$export$98871882f492de82","$5045192fc6d387ba$export$23a2a68283c24d80","open","_open","$5c1d08c7c57da9a3$export$4a84e95a2324ac29","localStream","_localStream","remoteStream","_remoteStream","ID_PREFIX","_negotiator","handleMessage","_payload","messages","_getMessages","_removeConnection","_$5c1d08c7c57da9a3$export$4a84e95a2324ac","$abf266641927cd89$export$2c4e825dc9120f87","_options","_buildRequest","URL","searchParams","now","fetch","href","referrerPolicy","retrieveId","response","status","text","pathError","listAllPeers","helpfulError","json","$6366c4ca161bc297$export$d365f7ad9d7df9c9","chunked","_send","NotOpenYet","_$6366c4ca161bc297$export$d365f7ad9d7df9c","MAX_BUFFERED_AMOUNT","$a229bedbcaa6ca23$export$ff7c9d4c11d94e8b","bufferSize","_bufferSize","_handleDataMessage","_bufferedSend","msg","_buffering","_trySend","_buffer","bufferedAmount","_tryBuffer","$9fcfddb3ae148f88$export$f0a5a64d5bb37108","_chunkedData","chunker","Binary","deserializedData","peerData","_handleChunk","chunkInfo","_send_blob","_sendChunks","blobPromise","blobs","$bbaee3f15f714663$export$6f88fe47d32c9c94","_chunked","None","$817f931e3f9096cf$export$48880ac635f47186","decoder","encodedData","MessageToBig","$416260bce337df90$export$ecd1fc136c422448","connections","plainConnections","k","_connections","destroyed","_destroyed","disconnected","userId","_serializers","raw","_lastServerId","_lostMessages","debug","DEFAULT_KEY","serializers","hostname","logFunction","_api","_createServerConnection","_initialize","_abort","ServerError","_delayedAbort","InvalidID","BrowserIncompatible","_handleMessage","SocketError","Network","disconnect","Close","SocketClosed","src","Open","IdTaken","UnavailableID","InvalidKey","Leave","_cleanupPeer","Expire","PeerUnavailable","_addConnection","_storeMessage","connect","destroy","currentId","reconnect","_","peers","_$416260bce337df90$export$ecd1fc136c","$dd0187d7f28e386f$export$2e2bcd8739ae039","useStore","WS","ws","socketIOClient","route","useRoute","router","useRouter","meID","uuidV4","peerID","Peer","inputEnabled","enabled","headphone","screenshare","room","query","roomID","sideActive","inputMessage","interval","input","audioEnabled","videos","alertMessage","visible","oldParticipants","createEmptyStream","audioContext","oscillator","createOscillator","createMediaStreamDestination","audioTrack","canvas","document","createElement","width","height","videoStream","captureStream","videoTrack","createdVideo","isMe","findUserVideos","videoEnabled","videoHeadphone","videoScreenShare","videoObject","emptyStream","removeVideo","videoElementBox","getElementById","childNodes","srcObject","remove","toggleAudio","toggleTracks","userIndex","userFindIndex","toggleVideo","toggleheadphone","videoToggleSound","toggleScreenShare","async","streamRes","audioTracks","combinedStream","connectionKey","replaceTrack","submitMessage","oldMessages","isVisibleAlertMessageHideFunc","isVisibleAlertMessageShowFunc","copyKeyRoom","clipboard","writeText","fl","querySelectorAll","muted","findIndex","getUsers","participants","userFindVideos","streamID","deviceInfo","peerStream","streamClass","isPrototypeOf","$TypeError","it","Prototype","IndexSizeError","m","DOMStringSizeError","HierarchyRequestError","WrongDocumentError","InvalidCharacterError","NoDataAllowedError","NoModificationAllowedError","NotFoundError","NotSupportedError","InUseAttributeError","SyntaxError","InvalidModificationError","NamespaceError","InvalidAccessError","ValidationError","TypeMismatchError","SecurityError","NetworkError","AbortError","URLMismatchError","QuotaExceededError","TimeoutError","InvalidNodeTypeError","DataCloneError","uncurryThis","$Error","TEST","arg","V8_OR_CHAKRA_STACK_ENTRY","IS_V8_OR_CHAKRA_STACK","dropEntries","prepareStackTrace","isCallable","$this","dummy","Wrapper","NewTarget","NewTargetPrototype","argument","$default","classof","$String","passed","required","$","global","getBuiltIn","createPropertyDescriptor","hasOwn","anInstance","inheritIfRequired","normalizeStringArgument","DOMExceptionConstants","clearErrorStack","DESCRIPTORS","IS_PURE","DOM_EXCEPTION","NativeDOMException","$DOMException","DOMExceptionPrototype","argumentsLength","that","ERROR_HAS_STACK","DOM_EXCEPTION_HAS_STACK","descriptor","BUGGY_DESCRIPTOR","FORCED_CONSTRUCTOR","forced","PolyfilledDOMException","PolyfilledDOMExceptionPrototype","constant","constantName","defineBuiltIn","validateArgumentsLength","$URLSearchParams","URLSearchParams","URLSearchParamsPrototype","$delete","$value","entries","entry","dindex","found","entriesLength","unsafe","getAll","$has","defineBuiltInAccessor"],"sourceRoot":""}